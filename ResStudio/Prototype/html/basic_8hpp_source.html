<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>DuctTeip: basic.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>basic.hpp</h1><a href="basic_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef __BASIC_HPP__</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define __BASIC_HPP__</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 
<a name="l00005"></a>00005 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include &lt;sys/time.h&gt;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &lt;assert.h&gt;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;sched.h&gt;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;errno.h&gt;</span>
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 
<a name="l00014"></a><a class="code" href="basic_8hpp.html#a0367d44d1df15e11c21b46b14f68c4c3">00014</a> <span class="preprocessor">#define registerAccess register_access</span>
<a name="l00015"></a><a class="code" href="basic_8hpp.html#a217b2a92112ef388123e82786ac5d243">00015</a> <span class="preprocessor"></span><span class="preprocessor">#define getAccess get_access</span>
<a name="l00016"></a><a class="code" href="basic_8hpp.html#a65a9642409f40304275931c775fa300e">00016</a> <span class="preprocessor"></span><span class="preprocessor">#define getHandle  get_handle</span>
<a name="l00017"></a><a class="code" href="basic_8hpp.html#a1b0f4154052a00231883049b4433f7de">00017</a> <span class="preprocessor"></span><span class="preprocessor">#define ThreadManager SuperGlue</span>
<a name="l00018"></a><a class="code" href="basic_8hpp.html#ad4903d64f3bce98bad0491b8caf3c0d7">00018</a> <span class="preprocessor"></span><span class="preprocessor">#define getTaskCount get_task_count</span>
<a name="l00019"></a>00019 <span class="preprocessor"></span>
<a name="l00020"></a><a class="code" href="basic_8hpp.html#ae27d3cc90f3f3af29d3cb7b3397f22cb">00020</a> <span class="preprocessor">#define MPI_WALL_TIME 1</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span>
<a name="l00022"></a>00022 <span class="preprocessor">#ifdef MPI_WALL_TIME</span>
<a name="l00023"></a>00023 <span class="preprocessor"></span><span class="preprocessor">#include &quot;mpi.h&quot;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#else</span>
<a name="l00025"></a>00025 <span class="preprocessor"></span><span class="preprocessor">#include &quot;platform/gettime.hpp&quot;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#endif</span>
<a name="l00027"></a>00027 <span class="preprocessor"></span>
<a name="l00028"></a>00028 
<a name="l00029"></a><a class="code" href="basic_8hpp.html#aef7dca3a35602ee0298470da533cf1d9">00029</a> <span class="preprocessor">#define DLB_DEBUG 0</span>
<a name="l00030"></a><a class="code" href="basic_8hpp.html#a9801023942be9301251f897b6e093441">00030</a> <span class="preprocessor"></span><span class="preprocessor">#define DLB_BUSY_TASKS 5</span>
<a name="l00031"></a><a class="code" href="basic_8hpp.html#a11f7af75a27dc15f9104f7bd2171a6e1">00031</a> <span class="preprocessor"></span><span class="preprocessor">#define DLB_MODE 1</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span>
<a name="l00033"></a><a class="code" href="basic_8hpp.html#ad72dbcf6d0153db1b8d8a58001feed83">00033</a> <span class="preprocessor">#define DEBUG 0</span>
<a name="l00034"></a>00034 <span class="preprocessor"></span>
<a name="l00035"></a><a class="code" href="basic_8hpp.html#ab5dc2b3c4719d3e883a94b6a71d10e73">00035</a> <span class="preprocessor">#define MAILBOX_THREAD  0 </span>
<a name="l00036"></a><a class="code" href="basic_8hpp.html#af61dc8dd41ad09d562f710fb9cfb1554">00036</a> <span class="preprocessor"></span><span class="preprocessor">#define TERMINATE_TREE  1</span>
<a name="l00037"></a>00037 <span class="preprocessor"></span>
<a name="l00038"></a>00038 <span class="comment">//#define THREAD_INFO(a) printf(&quot;%s , %d\n&quot;,__FILE__,__LINE__);threadInfo(a)</span>
<a name="l00039"></a><a class="code" href="basic_8hpp.html#a19960f4c85cfe7a2ec217658fec6bea7">00039</a> <span class="preprocessor">#define THREAD_INFO(a)</span>
<a name="l00040"></a>00040 <span class="preprocessor"></span>
<a name="l00041"></a><a class="code" href="basic_8hpp.html#a048d50b21a1bbec6cb19610c35c5b03e">00041</a> <span class="preprocessor">#define DUMP_FLAG DEBUG</span>
<a name="l00042"></a><a class="code" href="basic_8hpp.html#ab21f8ef3ba992efc1eda405bccdde69a">00042</a> <span class="preprocessor"></span><span class="preprocessor">#define EXPORT_FLAG 0</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span>
<a name="l00044"></a><a class="code" href="basic_8hpp.html#ad82dc13bc2f2cdd35dc8602b6a40b01e">00044</a> <span class="preprocessor">#define INSERT_TASK_FLAG  DEBUG</span>
<a name="l00045"></a><a class="code" href="basic_8hpp.html#aad3edae54a52ba521da45c5877db0510">00045</a> <span class="preprocessor"></span><span class="preprocessor">#define SKIP_TASK_FLAG    DEBUG</span>
<a name="l00046"></a><a class="code" href="basic_8hpp.html#a7baa2df2dc59e23e2d8872cc759d2999">00046</a> <span class="preprocessor"></span><span class="preprocessor">#define DATA_UPGRADE_FLAG DEBUG</span>
<a name="l00047"></a><a class="code" href="basic_8hpp.html#aae36dea985537c9145d0ba9173a0b7a8">00047</a> <span class="preprocessor"></span><span class="preprocessor">#define KERNEL_FLAG       0</span>
<a name="l00048"></a><a class="code" href="basic_8hpp.html#a277b41b0e99d2ef09f6f8a7945941105">00048</a> <span class="preprocessor"></span><span class="preprocessor">#define TERMINATE_FLAG    0</span>
<a name="l00049"></a><a class="code" href="basic_8hpp.html#afbf7b6f2cf74043880e291a37f918d4a">00049</a> <span class="preprocessor"></span><span class="preprocessor">#define IRECV             0</span>
<a name="l00050"></a><a class="code" href="basic_8hpp.html#aa29abba7f38dd5b150e49b163fa80522">00050</a> <span class="preprocessor"></span><span class="preprocessor">#define OVERSUBSCRIBED    0</span>
<a name="l00051"></a><a class="code" href="basic_8hpp.html#ae3687aa4be7179bad53c75a1484ee9bf">00051</a> <span class="preprocessor"></span><span class="preprocessor">#define POSTPRINT         1</span>
<a name="l00052"></a>00052 <span class="preprocessor"></span>
<a name="l00053"></a><a class="code" href="basic_8hpp.html#a2fda5de92a55c8d89f4a033486c705da">00053</a> <span class="preprocessor">#define TRACE_LOCATION printf(&quot;%s , %d\n&quot;,__FILE__,__LINE__);</span>
<a name="l00054"></a>00054 <span class="preprocessor"></span>               <span class="comment">//#define  TRACE_LOCATION</span>
<a name="l00055"></a>00055 <span class="comment">//#define TRACE_ALLOCATION(a) printf(&quot;alloc mem %s,%d, %ld\n&quot;,__FILE__,__LINE__,a)</span>
<a name="l00056"></a><a class="code" href="basic_8hpp.html#a1df23165ea51ad95535d43b13413892c">00056</a> <span class="preprocessor">#define TRACE_ALLOCATION(a) </span>
<a name="l00057"></a>00057 <span class="preprocessor"></span><span class="comment">//#define TRACE(a) TRACE_LOCATION;printf(a);</span>
<a name="l00058"></a><a class="code" href="basic_8hpp.html#af433b05d8a466d0640f88d491e2b3339">00058</a> <span class="preprocessor">#define TRACE(a)</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span>
<a name="l00060"></a>00060 
<a name="l00061"></a><a class="code" href="basic_8hpp.html#a0c8186d9b9b7880309c27230bbb5e69d">00061</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="basic_8hpp.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>;
<a name="l00062"></a>00062 <span class="keyword">using namespace </span>std;
<a name="l00063"></a>00063 
<a name="l00064"></a><a class="code" href="struct_buffer.html">00064</a> <span class="keyword">struct </span><a class="code" href="struct_buffer.html">Buffer</a>{
<a name="l00065"></a><a class="code" href="struct_buffer.html#a06797e587eada327990612630ab3552b">00065</a>   <a class="code" href="basic_8hpp.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *<a class="code" href="struct_buffer.html#a06797e587eada327990612630ab3552b">address</a>;
<a name="l00066"></a><a class="code" href="struct_buffer.html#ab73cc798639521aed06c3159faa40449">00066</a>   <span class="keywordtype">int</span> <a class="code" href="struct_buffer.html#ab73cc798639521aed06c3159faa40449">size</a>;
<a name="l00067"></a>00067 };
<a name="l00068"></a><a class="code" href="struct_message_buffer.html">00068</a> <span class="keyword">struct </span><a class="code" href="struct_message_buffer.html">MessageBuffer</a>{
<a name="l00069"></a><a class="code" href="struct_message_buffer.html#a312b0b881f953e7297e09babf07ad310">00069</a>   <span class="keywordtype">int</span> <a class="code" href="struct_message_buffer.html#a312b0b881f953e7297e09babf07ad310">size</a>;
<a name="l00070"></a><a class="code" href="struct_message_buffer.html#a8980cf66ff82d8e41272c71b7eed95cf">00070</a>   <a class="code" href="struct_buffer.html">Buffer</a> <a class="code" href="struct_message_buffer.html#a8980cf66ff82d8e41272c71b7eed95cf">header</a>,<a class="code" href="struct_message_buffer.html#aacb71926287db561ee1be822b3c22c29">content</a>;
<a name="l00071"></a><a class="code" href="struct_message_buffer.html#a3904730ac874f087e0d523ec5583a786">00071</a>   <a class="code" href="basic_8hpp.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *<a class="code" href="struct_message_buffer.html#a3904730ac874f087e0d523ec5583a786">address</a>;
<a name="l00072"></a><a class="code" href="struct_message_buffer.html#a1879023de683ba2b29f94281d6ecd2a8">00072</a>   <a class="code" href="struct_message_buffer.html#a1879023de683ba2b29f94281d6ecd2a8">MessageBuffer</a>(<span class="keywordtype">int</span> header_size,<span class="keywordtype">int</span> content_size){
<a name="l00073"></a>00073             <a class="code" href="struct_message_buffer.html#a312b0b881f953e7297e09babf07ad310">size</a> = content_size + header_size;
<a name="l00074"></a>00074      <a class="code" href="struct_message_buffer.html#a8980cf66ff82d8e41272c71b7eed95cf">header</a>.<a class="code" href="struct_buffer.html#ab73cc798639521aed06c3159faa40449">size</a> =  header_size ;
<a name="l00075"></a>00075     <a class="code" href="struct_message_buffer.html#aacb71926287db561ee1be822b3c22c29">content</a>.<a class="code" href="struct_buffer.html#ab73cc798639521aed06c3159faa40449">size</a> = content_size ;
<a name="l00076"></a>00076 
<a name="l00077"></a>00077             <a class="code" href="struct_message_buffer.html#a3904730ac874f087e0d523ec5583a786">address</a> = <span class="keyword">new</span> <a class="code" href="basic_8hpp.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>[<a class="code" href="struct_message_buffer.html#a312b0b881f953e7297e09babf07ad310">size</a>];
<a name="l00078"></a>00078         <a class="code" href="basic_8hpp.html#a1df23165ea51ad95535d43b13413892c">TRACE_ALLOCATION</a>(<a class="code" href="struct_message_buffer.html#a312b0b881f953e7297e09babf07ad310">size</a>);
<a name="l00079"></a>00079      <a class="code" href="struct_message_buffer.html#a8980cf66ff82d8e41272c71b7eed95cf">header</a>.<a class="code" href="struct_buffer.html#a06797e587eada327990612630ab3552b">address</a> = <a class="code" href="struct_message_buffer.html#a3904730ac874f087e0d523ec5583a786">address</a>;
<a name="l00080"></a>00080     <a class="code" href="struct_message_buffer.html#aacb71926287db561ee1be822b3c22c29">content</a>.<a class="code" href="struct_buffer.html#a06797e587eada327990612630ab3552b">address</a> = <a class="code" href="struct_message_buffer.html#a3904730ac874f087e0d523ec5583a786">address</a> + header_size;
<a name="l00081"></a>00081 
<a name="l00082"></a>00082   }
<a name="l00083"></a><a class="code" href="struct_message_buffer.html#a9b75bc9b932dd5ac39c35b35b4f18a80">00083</a>   <a class="code" href="struct_message_buffer.html#a9b75bc9b932dd5ac39c35b35b4f18a80">~MessageBuffer</a>(){
<a name="l00084"></a>00084     <span class="keyword">delete</span>[] <a class="code" href="struct_message_buffer.html#a3904730ac874f087e0d523ec5583a786">address</a>;
<a name="l00085"></a>00085   }
<a name="l00086"></a><a class="code" href="struct_message_buffer.html#a23d67ca3db34d5fefab3215b90433dec">00086</a>   <span class="keywordtype">void</span> <a class="code" href="struct_message_buffer.html#a23d67ca3db34d5fefab3215b90433dec">setAddress</a>(<a class="code" href="basic_8hpp.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *new_address){
<a name="l00087"></a>00087     <span class="keyword">delete</span>[] <a class="code" href="struct_message_buffer.html#a3904730ac874f087e0d523ec5583a786">address</a>;
<a name="l00088"></a>00088             <a class="code" href="struct_message_buffer.html#a3904730ac874f087e0d523ec5583a786">address</a> = new_address;
<a name="l00089"></a>00089      <a class="code" href="struct_message_buffer.html#a8980cf66ff82d8e41272c71b7eed95cf">header</a>.<a class="code" href="struct_buffer.html#a06797e587eada327990612630ab3552b">address</a> = <a class="code" href="struct_message_buffer.html#a3904730ac874f087e0d523ec5583a786">address</a>;
<a name="l00090"></a>00090     <a class="code" href="struct_message_buffer.html#aacb71926287db561ee1be822b3c22c29">content</a>.<a class="code" href="struct_buffer.html#a06797e587eada327990612630ab3552b">address</a> = <a class="code" href="struct_message_buffer.html#a3904730ac874f087e0d523ec5583a786">address</a> + <a class="code" href="struct_message_buffer.html#a8980cf66ff82d8e41272c71b7eed95cf">header</a>.<a class="code" href="struct_buffer.html#ab73cc798639521aed06c3159faa40449">size</a>;
<a name="l00091"></a>00091   }
<a name="l00092"></a>00092 };
<a name="l00093"></a>00093 
<a name="l00094"></a>00094 
<a name="l00095"></a>00095 
<a name="l00096"></a>00096 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; 
<a name="l00097"></a><a class="code" href="basic_8hpp.html#a8eedabc3fdeef0b7973412cf6a30e7d1">00097</a> <span class="keywordtype">void</span> <a class="code" href="basic_8hpp.html#a8eedabc3fdeef0b7973412cf6a30e7d1">copy</a>(<a class="code" href="basic_8hpp.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> * b,<span class="keywordtype">int</span> &amp;o,T a){
<a name="l00098"></a>00098   memcpy(b+o,(<span class="keywordtype">char</span> *)&amp;a,<span class="keyword">sizeof</span>(a));
<a name="l00099"></a>00099   o +=  <span class="keyword">sizeof</span>(a);
<a name="l00100"></a>00100 }
<a name="l00101"></a>00101 <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; 
<a name="l00102"></a><a class="code" href="basic_8hpp.html#ac5bb447a4865adcf6a1c33a657d820c2">00102</a> <span class="keywordtype">void</span> <a class="code" href="basic_8hpp.html#ac5bb447a4865adcf6a1c33a657d820c2">paste</a>(<a class="code" href="basic_8hpp.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> * b,<span class="keywordtype">int</span> &amp;o,T *a){
<a name="l00103"></a>00103   memcpy((<span class="keywordtype">char</span> *)a,b+o,<span class="keyword">sizeof</span>(T));
<a name="l00104"></a>00104   o +=  <span class="keyword">sizeof</span>(T);
<a name="l00105"></a>00105 }
<a name="l00106"></a>00106 
<a name="l00107"></a><a class="code" href="basic_8hpp.html#a18b7a861548515d01c332e31c026dfa2">00107</a> <span class="keywordtype">void</span> <a class="code" href="basic_8hpp.html#a18b7a861548515d01c332e31c026dfa2">flushBuffer</a>(<a class="code" href="basic_8hpp.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *buffer,<span class="keywordtype">int</span> length){
<a name="l00108"></a>00108   printf(<span class="stringliteral">&quot;flush buffer:%p \n&quot;</span>,buffer);
<a name="l00109"></a>00109   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0;i&lt;length ;i++){
<a name="l00110"></a>00110     printf (<span class="stringliteral">&quot;%2.2X &quot;</span>,buffer[i]);
<a name="l00111"></a>00111     <span class="keywordflow">if</span> ( (i&gt;=20) &amp;&amp; (i % 20) == 0 ) printf(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00112"></a>00112   }
<a name="l00113"></a>00113   printf(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00114"></a>00114 }
<a name="l00115"></a>00115 
<a name="l00116"></a><a class="code" href="basic_8hpp.html#ab26fafcd40c96c4594ce3a0544e91362">00116</a> <span class="preprocessor">#define TIME_SCALE_TO_MICRO_SECONDS 1000</span>
<a name="l00117"></a><a class="code" href="basic_8hpp.html#a76071f67641c6300a180881de6df1e92">00117</a> <span class="preprocessor"></span><span class="preprocessor">#define MICRO_SECONDS 1000000</span>
<a name="l00118"></a><a class="code" href="basic_8hpp.html#a285e82f4cc9527d1a40a4676bc753c98">00118</a> <span class="preprocessor"></span><span class="preprocessor">#define MILI_SECONDS 1000</span>
<a name="l00119"></a><a class="code" href="basic_8hpp.html#a648194302b12659edb03111b84350269">00119</a> <span class="preprocessor"></span><span class="preprocessor">#define TIME_SCALE_TO_MILI_SECONDS 1000000</span>
<a name="l00120"></a><a class="code" href="basic_8hpp.html#a52a537f81e21614f69f23b47b1ae93e1">00120</a> <span class="preprocessor"></span><span class="preprocessor">#define TIME_SCALE_TO_SECONDS 1000000000</span>
<a name="l00121"></a>00121 <span class="preprocessor"></span>
<a name="l00122"></a>00122 
<a name="l00123"></a><a class="code" href="basic_8hpp.html#ab6fdc9dc4abc71f4bdf430a00f9661c8">00123</a> <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="basic_8hpp.html#ab6fdc9dc4abc71f4bdf430a00f9661c8">ClockTimeUnit</a>;
<a name="l00124"></a>00124 <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="basic_8hpp.html#ab6fdc9dc4abc71f4bdf430a00f9661c8">ClockTimeUnit</a> getClockTime(<span class="keywordtype">int</span> unit) {
<a name="l00125"></a>00125   timeval tv;
<a name="l00126"></a>00126   gettimeofday(&amp;tv, 0);
<a name="l00127"></a>00127   <span class="keywordflow">if</span> ( unit == <a class="code" href="basic_8hpp.html#a285e82f4cc9527d1a40a4676bc753c98">MILI_SECONDS</a>)
<a name="l00128"></a>00128     <span class="keywordflow">return</span> (tv.tv_sec*(<a class="code" href="basic_8hpp.html#ab6fdc9dc4abc71f4bdf430a00f9661c8">ClockTimeUnit</a>)unit+tv.tv_usec/unit);
<a name="l00129"></a>00129   <span class="keywordflow">return</span> (tv.tv_sec*(<a class="code" href="basic_8hpp.html#ab6fdc9dc4abc71f4bdf430a00f9661c8">ClockTimeUnit</a>)unit+tv.tv_usec);
<a name="l00130"></a>00130 }
<a name="l00131"></a>00131 <span class="preprocessor">#ifdef MPI_WALL_TIME</span>
<a name="l00132"></a><a class="code" href="basic_8hpp.html#ac0ec6c8e4757751eaaa618bbf62ab6c9">00132</a> <span class="preprocessor"></span><span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="basic_8hpp.html#ac0ec6c8e4757751eaaa618bbf62ab6c9">TimeUnit</a>;
<a name="l00133"></a>00133 <span class="preprocessor">#pragma message(&quot;getTime()=MPI WTIME&quot;)</span>
<a name="l00134"></a>00134 <span class="preprocessor"></span><span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="basic_8hpp.html#ac0ec6c8e4757751eaaa618bbf62ab6c9">TimeUnit</a> getTime(){
<a name="l00135"></a>00135   <span class="keywordflow">return</span> (<a class="code" href="basic_8hpp.html#ac0ec6c8e4757751eaaa618bbf62ab6c9">TimeUnit</a>)(MPI_Wtime()*1000000000);  
<a name="l00136"></a>00136 }
<a name="l00137"></a>00137 <span class="preprocessor">#else</span>
<a name="l00138"></a>00138 <span class="preprocessor"></span><span class="keyword">typedef</span> <a class="code" href="basic_8hpp.html#ac0ec6c8e4757751eaaa618bbf62ab6c9">Time::TimeUnit</a>  <a class="code" href="basic_8hpp.html#ac0ec6c8e4757751eaaa618bbf62ab6c9">TimeUnit</a>;
<a name="l00139"></a>00139 <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="basic_8hpp.html#ac0ec6c8e4757751eaaa618bbf62ab6c9">TimeUnit</a> getTime(){
<a name="l00140"></a>00140   <span class="keywordflow">return</span> Time::getTime();
<a name="l00141"></a>00141 }
<a name="l00142"></a>00142 <span class="preprocessor">#endif</span>
<a name="l00143"></a>00143 <span class="preprocessor"></span>
<a name="l00144"></a>00144 
<a name="l00145"></a><a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38c">00145</a> <span class="keyword">enum</span> <a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38c">verbs_</a> {
<a name="l00146"></a><a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38caafda38ad053b1ef9030108a0cd0d766e">00146</a>   <a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38caafda38ad053b1ef9030108a0cd0d766e">V_RCVD</a>,
<a name="l00147"></a><a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38cad2ef3847b90a11c0364ab53a7b9340ca">00147</a>   <a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38cad2ef3847b90a11c0364ab53a7b9340ca">V_SEND</a>,
<a name="l00148"></a><a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38cae9a77c709480beb61c96f869c244a6ce">00148</a>   <a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38cae9a77c709480beb61c96f869c244a6ce">V_TERMINATED</a>,
<a name="l00149"></a><a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38caf4411899835bd5acb84f32f102f451df">00149</a>   <a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38caf4411899835bd5acb84f32f102f451df">V_ADDED</a>,
<a name="l00150"></a><a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38ca67839e83e1c3b43e8b5be36d94727879">00150</a>   <a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38ca67839e83e1c3b43e8b5be36d94727879">V_CHECK_DEP</a>,
<a name="l00151"></a><a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38cabde31f4818f0f63e301e592d17a4b85f">00151</a>   <a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38cabde31f4818f0f63e301e592d17a4b85f">V_DUMP</a>,
<a name="l00152"></a><a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38ca2857dddc246195b5d5dbb5d4ec3c5c4c">00152</a>   <a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38ca2857dddc246195b5d5dbb5d4ec3c5c4c">V_CHECK_RDY</a>,
<a name="l00153"></a><a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38cad8c450d36052d1ae275541e9c95e13e8">00153</a>   <a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38cad8c450d36052d1ae275541e9c95e13e8">V_REMOVE</a>
<a name="l00154"></a>00154 } ;
<a name="l00155"></a>00155 
<a name="l00156"></a><a class="code" href="basic_8hpp.html#aef10afb905e0aff5fe0b92add673b857">00156</a> <span class="keyword">enum</span> <a class="code" href="basic_8hpp.html#aef10afb905e0aff5fe0b92add673b857">objects_</a>{
<a name="l00157"></a><a class="code" href="basic_8hpp.html#aef10afb905e0aff5fe0b92add673b857a7a62e0296edd4ecd1c1a3a3985f15f40">00157</a>   <a class="code" href="basic_8hpp.html#aef10afb905e0aff5fe0b92add673b857a7a62e0296edd4ecd1c1a3a3985f15f40">O_TASK</a>,
<a name="l00158"></a><a class="code" href="basic_8hpp.html#aef10afb905e0aff5fe0b92add673b857afd892a112036bd6279437db864f36c93">00158</a>   <a class="code" href="basic_8hpp.html#aef10afb905e0aff5fe0b92add673b857afd892a112036bd6279437db864f36c93">O_DATA</a>,
<a name="l00159"></a><a class="code" href="basic_8hpp.html#aef10afb905e0aff5fe0b92add673b857a3d1be207f6ce6e1463990de4ab0c2efa">00159</a>   <a class="code" href="basic_8hpp.html#aef10afb905e0aff5fe0b92add673b857a3d1be207f6ce6e1463990de4ab0c2efa">O_LSNR</a>,
<a name="l00160"></a><a class="code" href="basic_8hpp.html#aef10afb905e0aff5fe0b92add673b857ab4fee0ff64b97b560a6231e46b3a5ea8">00160</a>   <a class="code" href="basic_8hpp.html#aef10afb905e0aff5fe0b92add673b857ab4fee0ff64b97b560a6231e46b3a5ea8">O_PROG</a>
<a name="l00161"></a>00161 };
<a name="l00162"></a>00162 
<a name="l00163"></a><a class="code" href="basic_8hpp.html#a9b5bd9037cedbed2d6580464a8b69b57">00163</a> <span class="keywordtype">string</span> <a class="code" href="basic_8hpp.html#a9b5bd9037cedbed2d6580464a8b69b57">verb_str</a>(<span class="keywordtype">int</span> verb){
<a name="l00164"></a>00164   <span class="keywordflow">switch</span>(verb){
<a name="l00165"></a>00165   <span class="keywordflow">case</span> <a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38cad2ef3847b90a11c0364ab53a7b9340ca">V_SEND</a>:
<a name="l00166"></a>00166     <span class="keywordflow">return</span> <span class="stringliteral">&quot;send&quot;</span>;
<a name="l00167"></a>00167   <span class="keywordflow">case</span> <a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38caafda38ad053b1ef9030108a0cd0d766e">V_RCVD</a>:
<a name="l00168"></a>00168     <span class="keywordflow">return</span> <span class="stringliteral">&quot;received&quot;</span>;
<a name="l00169"></a>00169   <span class="keywordflow">case</span> <a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38cae9a77c709480beb61c96f869c244a6ce">V_TERMINATED</a>:
<a name="l00170"></a>00170     <span class="keywordflow">return</span> <span class="stringliteral">&quot;terminated&quot;</span>;
<a name="l00171"></a>00171   <span class="keywordflow">case</span> <a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38caf4411899835bd5acb84f32f102f451df">V_ADDED</a>:
<a name="l00172"></a>00172     <span class="keywordflow">return</span> <span class="stringliteral">&quot;added&quot;</span>;
<a name="l00173"></a>00173   <span class="keywordflow">case</span> <a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38ca67839e83e1c3b43e8b5be36d94727879">V_CHECK_DEP</a>:
<a name="l00174"></a>00174     <span class="keywordflow">return</span> <span class="stringliteral">&quot;check_dep&quot;</span>;
<a name="l00175"></a>00175   <span class="keywordflow">case</span> <a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38cabde31f4818f0f63e301e592d17a4b85f">V_DUMP</a>:
<a name="l00176"></a>00176     <span class="keywordflow">return</span> <span class="stringliteral">&quot;dump&quot;</span>;
<a name="l00177"></a>00177   <span class="keywordflow">case</span> <a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38ca2857dddc246195b5d5dbb5d4ec3c5c4c">V_CHECK_RDY</a>:
<a name="l00178"></a>00178     <span class="keywordflow">return</span> <span class="stringliteral">&quot;check_ready&quot;</span>;
<a name="l00179"></a>00179   <span class="keywordflow">case</span> <a class="code" href="basic_8hpp.html#aabffbfd6bcb49dce5baff9711d83f38cad8c450d36052d1ae275541e9c95e13e8">V_REMOVE</a>:
<a name="l00180"></a>00180     <span class="keywordflow">return</span> <span class="stringliteral">&quot;remove&quot;</span>;
<a name="l00181"></a>00181   <span class="keywordflow">default</span>:
<a name="l00182"></a>00182     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Not Defined&quot;</span>;
<a name="l00183"></a>00183   }
<a name="l00184"></a>00184 }
<a name="l00185"></a>00185 
<a name="l00186"></a><a class="code" href="basic_8hpp.html#abdf0005814bbc8dfc4409ad689eca09b">00186</a> <span class="keywordtype">string</span> <a class="code" href="basic_8hpp.html#abdf0005814bbc8dfc4409ad689eca09b">obj_str</a>(<span class="keywordtype">int</span> obj ) {
<a name="l00187"></a>00187   <span class="keywordflow">switch</span>(obj){
<a name="l00188"></a>00188   <span class="keywordflow">case</span> <a class="code" href="basic_8hpp.html#aef10afb905e0aff5fe0b92add673b857a7a62e0296edd4ecd1c1a3a3985f15f40">O_TASK</a>:
<a name="l00189"></a>00189     <span class="keywordflow">return</span> <span class="stringliteral">&quot;task&quot;</span>;
<a name="l00190"></a>00190   <span class="keywordflow">case</span> <a class="code" href="basic_8hpp.html#aef10afb905e0aff5fe0b92add673b857afd892a112036bd6279437db864f36c93">O_DATA</a>:
<a name="l00191"></a>00191     <span class="keywordflow">return</span> <span class="stringliteral">&quot;data&quot;</span>;
<a name="l00192"></a>00192   <span class="keywordflow">case</span> <a class="code" href="basic_8hpp.html#aef10afb905e0aff5fe0b92add673b857a3d1be207f6ce6e1463990de4ab0c2efa">O_LSNR</a>:
<a name="l00193"></a>00193     <span class="keywordflow">return</span> <span class="stringliteral">&quot;listener&quot;</span>;
<a name="l00194"></a>00194   <span class="keywordflow">case</span> <a class="code" href="basic_8hpp.html#aef10afb905e0aff5fe0b92add673b857ab4fee0ff64b97b560a6231e46b3a5ea8">O_PROG</a>:
<a name="l00195"></a>00195     <span class="keywordflow">return</span> <span class="stringliteral">&quot;program&quot;</span>;
<a name="l00196"></a>00196     
<a name="l00197"></a>00197   }
<a name="l00198"></a>00198   <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00199"></a>00199 }
<a name="l00200"></a>00200 
<a name="l00201"></a>00201 
<a name="l00202"></a><a class="code" href="basic_8hpp.html#a6b45a613e8da00bd1d1156704401851b">00202</a> <span class="keywordtype">void</span> <a class="code" href="basic_8hpp.html#a6b45a613e8da00bd1d1156704401851b">threadInfo</a>(<span class="keywordtype">int</span> arg){
<a name="l00203"></a>00203   sched_param sp;
<a name="l00204"></a>00204   <span class="keywordtype">int</span> r;
<a name="l00205"></a>00205   <span class="keywordflow">if</span> ( arg == 1 ) {
<a name="l00206"></a>00206     sp.sched_priority=1;
<a name="l00207"></a>00207     r=pthread_setschedparam(pthread_self(),SCHED_FIFO,&amp;sp);
<a name="l00208"></a>00208   }
<a name="l00209"></a>00209   <span class="keywordtype">int</span> schd;
<a name="l00210"></a>00210   <span class="keywordtype">int</span> r2=pthread_getschedparam (pthread_self(),&amp;schd,&amp;sp);
<a name="l00211"></a>00211   <span class="comment">//  sched_getparam(0,&amp;sp);</span>
<a name="l00212"></a>00212   <span class="keywordflow">if</span>(0){
<a name="l00213"></a>00213     printf(<span class="stringliteral">&quot;ret-vals:%d,%d schedule policy:%d, sch-priority:%d\n&quot;</span>,r,r2,schd,sp);  
<a name="l00214"></a>00214     printf(<span class="stringliteral">&quot;fifo:%d,other:%d,batch:%d,rr:%d,idle:%d\n&quot;</span>,SCHED_FIFO,SCHED_OTHER,SCHED_BATCH,SCHED_RR,SCHED_IDLE);
<a name="l00215"></a>00215     printf(<span class="stringliteral">&quot;esrch:%d,einval:%d,eperm:%d\n&quot;</span>,ESRCH,EINVAL,EPERM);
<a name="l00216"></a>00216   }
<a name="l00217"></a>00217 }
<a name="l00218"></a><a class="code" href="basic_8hpp.html#a5aacb623a2435186031070cf829281f9">00218</a> <span class="keywordtype">void</span> <a class="code" href="basic_8hpp.html#a5aacb623a2435186031070cf829281f9">nanoSleep</a>(<span class="keywordtype">int</span> n=1){
<a name="l00219"></a>00219   <span class="comment">//return;</span>
<a name="l00220"></a>00220   timespec ts;
<a name="l00221"></a>00221   ts.tv_sec=0;
<a name="l00222"></a>00222   ts.tv_nsec=n*1000;
<a name="l00223"></a>00223 
<a name="l00224"></a>00224   clock_nanosleep(CLOCK_PROCESS_CPUTIME_ID,0,&amp;ts,NULL);
<a name="l00225"></a>00225 }
<a name="l00226"></a>00226 
<a name="l00227"></a><a class="code" href="basic_8hpp.html#a01d4c8834420566804f361060f144094">00227</a> <span class="preprocessor">#define PRINT_IF(a) if(a) printf</span>
<a name="l00228"></a>00228 <span class="preprocessor"></span>
<a name="l00229"></a>00229 <span class="preprocessor"># if EXPORT_FLAG != 0</span>
<a name="l00230"></a>00230 <span class="preprocessor"></span><span class="preprocessor">#  define export(a,b) export_( a,b,__FILE__,__LINE__)</span>
<a name="l00231"></a>00231 <span class="preprocessor"></span><span class="preprocessor">#  define export_end(a) export_end_(a,__FILE__,__LINE__)</span>
<a name="l00232"></a>00232 <span class="preprocessor"></span><span class="preprocessor">#  define export_prefix printf(&quot;\nfile:%-12.12s,line:%4.4d,time:%ld,thread-id:%ld&quot;,file.c_str(),line,(long)getTime(),pthread_self())</span>
<a name="l00233"></a>00233 <span class="preprocessor"></span>
<a name="l00234"></a>00234     <span class="keywordtype">void</span> export_(<span class="keywordtype">int</span> verb, <span class="keywordtype">int</span> <span class="keywordtype">object</span>,<span class="keywordtype">string</span> file,<span class="keywordtype">int</span> line)
<a name="l00235"></a>00235     {
<a name="l00236"></a>00236       <a class="code" href="basic_8hpp.html#ae7d478d79105d2851aa864453b3a2f5f">export_prefix</a>;
<a name="l00237"></a>00237       printf(<span class="stringliteral">&quot; ,verb:%s,obj:%s,&quot;</span>,<a class="code" href="basic_8hpp.html#a9b5bd9037cedbed2d6580464a8b69b57">verb_str</a>(verb).c_str(),<a class="code" href="basic_8hpp.html#abdf0005814bbc8dfc4409ad689eca09b">obj_str</a>(<span class="keywordtype">object</span>).c_str());
<a name="l00238"></a>00238     }
<a name="l00239"></a>00239     <span class="keywordtype">void</span> export_end_(<span class="keywordtype">int</span> verb,<span class="keywordtype">string</span> file,<span class="keywordtype">int</span>  line)
<a name="l00240"></a>00240     {
<a name="l00241"></a>00241       <a class="code" href="basic_8hpp.html#ae7d478d79105d2851aa864453b3a2f5f">export_prefix</a>;
<a name="l00242"></a>00242       printf(<span class="stringliteral">&quot;,/verb:%s,\n&quot;</span>,<a class="code" href="basic_8hpp.html#a9b5bd9037cedbed2d6580464a8b69b57">verb_str</a>(verb).c_str());      
<a name="l00243"></a>00243     }
<a name="l00244"></a>00244 <span class="preprocessor">#  define export_int(a)    printf ( &quot;,%s:%d,&quot; ,#a,a)</span>
<a name="l00245"></a>00245 <span class="preprocessor"></span><span class="preprocessor">#  define export_long(a)   printf ( &quot;,%s:%ld,&quot;,#a,a)</span>
<a name="l00246"></a>00246 <span class="preprocessor"></span><span class="preprocessor">#  define export_time(a)   printf ( &quot;,%s:%Ld,&quot;,#a,a)</span>
<a name="l00247"></a>00247 <span class="preprocessor"></span><span class="preprocessor">#  define export_str(a)    printf ( &quot;,%s:%s,&quot; ,#a,a)</span>
<a name="l00248"></a>00248 <span class="preprocessor"></span><span class="preprocessor">#  define export_info(f,v) printf ( f,v)</span>
<a name="l00249"></a>00249 <span class="preprocessor"></span><span class="preprocessor"># else // undefine all export macros </span>
<a name="l00250"></a><a class="code" href="basic_8hpp.html#ab29f706a970bc382dbde0d9464940698">00250</a> <span class="preprocessor"></span><span class="preprocessor">#  define export(a,b) </span>
<a name="l00251"></a><a class="code" href="basic_8hpp.html#a85b365d6bc3898a026f9fe50a64228a3">00251</a> <span class="preprocessor"></span><span class="preprocessor">#  define export_end(a) </span>
<a name="l00252"></a><a class="code" href="basic_8hpp.html#ae7d478d79105d2851aa864453b3a2f5f">00252</a> <span class="preprocessor"></span><span class="preprocessor">#  define export_prefix </span>
<a name="l00253"></a><a class="code" href="basic_8hpp.html#ae266b91094f4fb53c44119797911b963">00253</a> <span class="preprocessor"></span><span class="preprocessor">#  define export_int(a)    </span>
<a name="l00254"></a><a class="code" href="basic_8hpp.html#a53287f390b1f05b230be6843e580dada">00254</a> <span class="preprocessor"></span><span class="preprocessor">#  define export_long(a)   </span>
<a name="l00255"></a><a class="code" href="basic_8hpp.html#a875bebd78d00a53343d2e2714c85e13a">00255</a> <span class="preprocessor"></span><span class="preprocessor">#  define export_time(a) </span>
<a name="l00256"></a><a class="code" href="basic_8hpp.html#a677d796ca48e5242d8b12a7a4fe3c3d6">00256</a> <span class="preprocessor"></span><span class="preprocessor">#  define export_str(a)    </span>
<a name="l00257"></a><a class="code" href="basic_8hpp.html#a746bfb061513dc778345d613cdebee13">00257</a> <span class="preprocessor"></span><span class="preprocessor">#  define export_info(f,v) </span>
<a name="l00258"></a>00258 <span class="preprocessor"></span><span class="preprocessor"># endif // EXPORT_FLAG</span>
<a name="l00259"></a>00259 <span class="preprocessor"></span>
<a name="l00260"></a>00260 <span class="preprocessor">#endif //__BASIC_HPP__</span>
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 11 Dec 2014 for DuctTeip by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>

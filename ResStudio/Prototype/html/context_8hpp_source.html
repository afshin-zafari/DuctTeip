<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>DuctTeip: context.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>context.hpp</h1><a href="context_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00002"></a>00002 <span class="preprocessor">#ifndef __CONTEXT_HPP__</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span><span class="preprocessor">#define __CONTEXT_HPP__</span>
<a name="l00004"></a>00004 <span class="preprocessor"></span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &lt;string&gt;</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include &lt;cstdio&gt;</span>
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &lt;list&gt;</span>
<a name="l00010"></a>00010 
<a name="l00011"></a>00011 <span class="preprocessor">#include &quot;<a class="code" href="config_8hpp.html">config.hpp</a>&quot;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;<a class="code" href="procgrid_8hpp.html">procgrid.hpp</a>&quot;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;<a class="code" href="hostpolicy_8hpp.html">hostpolicy.hpp</a>&quot;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &quot;<a class="code" href="data_8hpp.html">data.hpp</a>&quot;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &quot;<a class="code" href="glb__context_8hpp.html">glb_context.hpp</a>&quot;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &quot;<a class="code" href="engine_8hpp.html">engine.hpp</a>&quot;</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="keyword">using namespace </span>std;
<a name="l00019"></a>00019 
<a name="l00020"></a><a class="code" href="context_8hpp.html#ab985ed6582dc01a65dcca73fdd238f6b">00020</a> <a class="code" href="class_global_context.html">GlobalContext</a> <a class="code" href="context_8hpp.html#ab985ed6582dc01a65dcca73fdd238f6b">glbCtx</a>;
<a name="l00021"></a><a class="code" href="glb__context_8hpp.html#a821b880716b43e9c71b142880c2a5f4b">00021</a> <a class="code" href="classengine.html">engine</a> <a class="code" href="context_8hpp.html#a821b880716b43e9c71b142880c2a5f4b">dtEngine</a>;
<a name="l00022"></a>00022 
<a name="l00023"></a><a class="code" href="context_8hpp.html#aad880fc4455c253781e8968f2239d56f">00023</a> <span class="keywordtype">int</span> <a class="code" href="context_8hpp.html#a94bbc6e3d7712df24be96e5e83d0aaf8">me</a>,<a class="code" href="context_8hpp.html#aad880fc4455c253781e8968f2239d56f">version</a>,<a class="code" href="context_8hpp.html#a3fc7ce4e53beaaf18198c05f97845d4b">simulation</a>;
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 <span class="keyword">class </span><a class="code" href="class_i_context.html">IContext</a>;
<a name="l00026"></a>00026 <span class="keyword">class </span><a class="code" href="class_i_data.html">IData</a>;
<a name="l00027"></a>00027 <span class="comment">/*===============================  Context Class =======================================*/</span>
<a name="l00028"></a><a class="code" href="class_i_context.html">00028</a> <span class="keyword">class </span><a class="code" href="class_i_context.html">IContext</a>
<a name="l00029"></a>00029 {
<a name="l00030"></a>00030 <span class="keyword">protected</span>:
<a name="l00031"></a><a class="code" href="class_i_context.html#ae92fa26bc80aa6759c7410c2f933c68b">00031</a>   <span class="keywordtype">string</span>           <a class="code" href="class_i_context.html#ae92fa26bc80aa6759c7410c2f933c68b">name</a>;
<a name="l00032"></a><a class="code" href="class_i_context.html#aa97a20f038e5c3053c94f1a70779a0f1">00032</a>   <a class="code" href="class_i_context.html">IContext</a>        *<a class="code" href="class_i_context.html#aa97a20f038e5c3053c94f1a70779a0f1">parent</a>;
<a name="l00033"></a><a class="code" href="class_i_context.html#a4b81890185d165540acdeb1e012264be">00033</a>   list&lt;IContext*&gt;  <a class="code" href="class_i_context.html#a4b81890185d165540acdeb1e012264be">children</a>;
<a name="l00034"></a><a class="code" href="class_i_context.html#a7a37d0f4ea08c03624d14ae2860f077f">00034</a>   list&lt;IData*&gt;     <a class="code" href="class_i_context.html#a7284704610c7ea7cca699c8116feee0c">inputData</a>,
<a name="l00035"></a>00035     <a class="code" href="class_i_context.html#a7a37d0f4ea08c03624d14ae2860f077f">outputData</a>,
<a name="l00036"></a>00036     <a class="code" href="class_i_context.html#a398973dc27b31e89a4b4ab0f701dfee5">in_outData</a>;
<a name="l00037"></a><a class="code" href="class_i_context.html#a1155fe76cd858044298e22b7b83ab326">00037</a>   <a class="code" href="class_process_grid.html">ProcessGrid</a>     *<a class="code" href="class_i_context.html#a1155fe76cd858044298e22b7b83ab326">PG</a>;
<a name="l00038"></a><a class="code" href="class_i_context.html#a9eb34b3b3544c4186cce3296d444a9ac">00038</a>   <a class="code" href="glb__context_8hpp.html#a5d74defbecaf11c4dbb0a4ce308e1c34">ContextHandle</a>   *<a class="code" href="class_i_context.html#a9eb34b3b3544c4186cce3296d444a9ac">my_context_handle</a>;
<a name="l00039"></a><a class="code" href="class_i_context.html#a8dcedbb370532b4cfd613fd1dae366c1">00039</a>   <a class="code" href="class_config.html">Config</a> *<a class="code" href="class_i_context.html#a8dcedbb370532b4cfd613fd1dae366c1">cfg</a>;
<a name="l00040"></a>00040 <span class="keyword">public</span>:
<a name="l00041"></a><a class="code" href="class_i_context.html#a46c1edfdc2c9ff7eb8f274f10d98949f">00041</a>   <a class="code" href="class_i_context.html#a46c1edfdc2c9ff7eb8f274f10d98949f">IContext</a>(<span class="keywordtype">string</span> _name){
<a name="l00042"></a>00042     <a class="code" href="class_i_context.html#ae92fa26bc80aa6759c7410c2f933c68b">name</a>=_name;
<a name="l00043"></a>00043     <a class="code" href="class_i_context.html#aa97a20f038e5c3053c94f1a70779a0f1">parent</a> =NULL;
<a name="l00044"></a>00044     <a class="code" href="class_i_context.html#ae51caa1b552828bab3e5317c0efad541">setContextHandle</a> ( glbCtx.<a class="code" href="class_global_context.html#a933e43be2a62ca16e4ffa34ce5cadb5c">createContextHandle</a>() ) ;
<a name="l00045"></a>00045     glbCtx.<a class="code" href="class_global_context.html#ab518683a44cc92eb1c1a38a77f29f82d">addContext</a>( <span class="keyword">this</span> ) ;
<a name="l00046"></a>00046   }
<a name="l00047"></a><a class="code" href="class_i_context.html#a7a18ec7377bb445433ab130fa3259a6a">00047</a>   <a class="code" href="class_i_context.html#a7a18ec7377bb445433ab130fa3259a6a">~IContext</a>(){
<a name="l00048"></a>00048     list&lt;IData*&gt;::iterator it ;
<a name="l00049"></a>00049     list&lt;IContext*&gt;::iterator ctx_it ;
<a name="l00050"></a>00050     <span class="keywordflow">for</span> ( ctx_it =<a class="code" href="class_i_context.html#a4b81890185d165540acdeb1e012264be">children</a>.begin(); ctx_it != <a class="code" href="class_i_context.html#a4b81890185d165540acdeb1e012264be">children</a>.end(); ++ ctx_it ){
<a name="l00051"></a>00051       <span class="keyword">delete</span> (*ctx_it);
<a name="l00052"></a>00052     }
<a name="l00053"></a>00053     <a class="code" href="class_i_context.html#a7284704610c7ea7cca699c8116feee0c">inputData</a>.clear();
<a name="l00054"></a>00054     <a class="code" href="class_i_context.html#a7a37d0f4ea08c03624d14ae2860f077f">outputData</a>.clear();
<a name="l00055"></a>00055     <a class="code" href="class_i_context.html#a4b81890185d165540acdeb1e012264be">children</a>.clear();
<a name="l00056"></a>00056   }
<a name="l00057"></a>00057   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_i_context.html#a7e432ff03dfc96f39e8343b28f17fb74">runKernels</a>(<a class="code" href="class_i_ductteip_task.html">IDuctteipTask</a> *task) = 0 ; 
<a name="l00058"></a>00058   <span class="keyword">virtual</span> <span class="keywordtype">string</span> <a class="code" href="class_i_context.html#a8f811884fc095b04c6f6f7df5be5b51d">getTaskName</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) =0;
<a name="l00059"></a>00059 
<a name="l00060"></a><a class="code" href="class_i_context.html#a607d8609c589bfa7937b5a8313c61d04">00060</a>   <span class="keywordtype">string</span> <a class="code" href="class_i_context.html#a607d8609c589bfa7937b5a8313c61d04">getName</a>()    {<span class="keywordflow">return</span> <a class="code" href="class_i_context.html#ae92fa26bc80aa6759c7410c2f933c68b">name</a>;}
<a name="l00061"></a><a class="code" href="class_i_context.html#a6a8cf9340093917ffb41f8d812c26884">00061</a>   <span class="keywordtype">string</span> <a class="code" href="class_i_context.html#a6a8cf9340093917ffb41f8d812c26884">getFullName</a>(){<span class="keywordflow">return</span> <a class="code" href="class_i_context.html#a607d8609c589bfa7937b5a8313c61d04">getName</a>();}
<a name="l00062"></a><a class="code" href="class_i_context.html#aa590239dd58b3946bfd9fc3d6725eef8">00062</a>   <span class="keywordtype">void</span>   <a class="code" href="class_i_context.html#aa590239dd58b3946bfd9fc3d6725eef8">print_name</a>       ( <span class="keyword">const</span> <span class="keywordtype">char</span> *s=<span class="stringliteral">&quot;&quot;</span>) {cout &lt;&lt; s &lt;&lt; <a class="code" href="class_i_context.html#ae92fa26bc80aa6759c7410c2f933c68b">name</a> &lt;&lt; endl;}
<a name="l00063"></a><a class="code" href="class_i_context.html#ae51caa1b552828bab3e5317c0efad541">00063</a>   <span class="keywordtype">void</span>   <a class="code" href="class_i_context.html#ae51caa1b552828bab3e5317c0efad541">setContextHandle</a> ( <a class="code" href="glb__context_8hpp.html#a5d74defbecaf11c4dbb0a4ce308e1c34">ContextHandle</a> *c) {<a class="code" href="class_i_context.html#a9eb34b3b3544c4186cce3296d444a9ac">my_context_handle</a> = c;}
<a name="l00064"></a><a class="code" href="class_i_context.html#a63664480f4eede6b3a5ab572dd454160">00064</a>   <a class="code" href="glb__context_8hpp.html#a5d74defbecaf11c4dbb0a4ce308e1c34">ContextHandle</a> *<a class="code" href="class_i_context.html#a63664480f4eede6b3a5ab572dd454160">getContextHandle</a> ()                  { <span class="keywordflow">return</span> <a class="code" href="class_i_context.html#a9eb34b3b3544c4186cce3296d444a9ac">my_context_handle</a>;}
<a name="l00065"></a>00065 
<a name="l00066"></a><a class="code" href="class_i_context.html#a63b80af186cfc16907b72e8fdb3a7f11">00066</a>   <a class="code" href="class_i_data.html">IData</a> *<a class="code" href="class_i_context.html#a63b80af186cfc16907b72e8fdb3a7f11">getDataFromList</a>(list&lt;IData* &gt; dlist,<span class="keywordtype">int</span> index){
<a name="l00067"></a>00067     list&lt;IData *&gt;:: iterator it;
<a name="l00068"></a>00068     <span class="keywordflow">if</span> ( index &gt;= dlist.size() ) 
<a name="l00069"></a>00069       <span class="keywordflow">return</span> NULL;
<a name="l00070"></a>00070     it=dlist.begin();
<a name="l00071"></a>00071     advance(it,index);
<a name="l00072"></a>00072     <span class="keywordflow">return</span> (*it);
<a name="l00073"></a>00073   }
<a name="l00074"></a><a class="code" href="class_i_context.html#adc30ba64c308b29d60494a0d3ce26852">00074</a>   <a class="code" href="class_i_data.html">IData</a> *<a class="code" href="class_i_context.html#adc30ba64c308b29d60494a0d3ce26852">getOutputData</a>  (<span class="keywordtype">int</span> index=0){    
<a name="l00075"></a>00075     <span class="keywordflow">return</span> <a class="code" href="class_i_context.html#a63b80af186cfc16907b72e8fdb3a7f11">getDataFromList</a> ( <a class="code" href="class_i_context.html#a7a37d0f4ea08c03624d14ae2860f077f">outputData</a> , index);
<a name="l00076"></a>00076   }
<a name="l00077"></a><a class="code" href="class_i_context.html#a9e625b1922446c14cf63f712521788b4">00077</a>   <a class="code" href="class_i_data.html">IData</a> *<a class="code" href="class_i_context.html#a9e625b1922446c14cf63f712521788b4">getInputData</a>   (<span class="keywordtype">int</span> index=0){    
<a name="l00078"></a>00078     <span class="keywordflow">return</span> <a class="code" href="class_i_context.html#a63b80af186cfc16907b72e8fdb3a7f11">getDataFromList</a> ( <a class="code" href="class_i_context.html#a7284704610c7ea7cca699c8116feee0c">inputData</a> , index);
<a name="l00079"></a>00079   }
<a name="l00080"></a><a class="code" href="class_i_context.html#ab62e24ee67cb0f7355a0671afd0cbe10">00080</a>   <a class="code" href="class_i_data.html">IData</a> *<a class="code" href="class_i_context.html#ab62e24ee67cb0f7355a0671afd0cbe10">getInOutData</a>   (<span class="keywordtype">int</span> index=0){    
<a name="l00081"></a>00081     <span class="keywordflow">return</span> <a class="code" href="class_i_context.html#a63b80af186cfc16907b72e8fdb3a7f11">getDataFromList</a> ( <a class="code" href="class_i_context.html#a398973dc27b31e89a4b4ab0f701dfee5">in_outData</a> , index);
<a name="l00082"></a>00082   }
<a name="l00083"></a>00083   
<a name="l00084"></a>00084   
<a name="l00085"></a><a class="code" href="class_i_context.html#a9e05e14cdde2f0b5a0ed3349815cb974">00085</a>   <a class="code" href="class_i_data.html">IData</a> *<a class="code" href="class_i_context.html#a9e05e14cdde2f0b5a0ed3349815cb974">getDataByHandle</a>(list&lt;IData *&gt; dlist,<a class="code" href="struct_data_handle.html">DataHandle</a> *dh){
<a name="l00086"></a>00086     list&lt;IData*&gt; :: iterator it;
<a name="l00087"></a>00087     <a class="code" href="class_i_data.html">IData</a>* data;
<a name="l00088"></a>00088     <span class="keywordflow">for</span> (it = dlist.begin(); it != dlist.end();++it) {
<a name="l00089"></a>00089       data = (*it)-&gt;<a class="code" href="class_i_data.html#a78a571407788130ebe382f51c3774605">getDataByHandle</a>(dh);
<a name="l00090"></a>00090       <span class="keywordflow">if</span> ( data ) 
<a name="l00091"></a>00091     <span class="keywordflow">if</span> ( data -&gt;<a class="code" href="class_i_context.html#a607d8609c589bfa7937b5a8313c61d04">getName</a>().size() != 0 ) 
<a name="l00092"></a>00092       <span class="keywordflow">return</span> data;
<a name="l00093"></a>00093     }
<a name="l00094"></a>00094     <span class="keywordflow">return</span> NULL;
<a name="l00095"></a>00095   }
<a name="l00096"></a><a class="code" href="class_i_context.html#aebeefdc5ccb54aeb883e79665ddf2513">00096</a>   <a class="code" href="class_i_data.html">IData</a> *<a class="code" href="class_i_context.html#aebeefdc5ccb54aeb883e79665ddf2513">getDataByHandle</a>(<a class="code" href="struct_data_handle.html">DataHandle</a> *dh ) {
<a name="l00097"></a>00097     <a class="code" href="class_i_data.html">IData</a> *data=NULL;
<a name="l00098"></a>00098     data = <a class="code" href="class_i_context.html#a9e05e14cdde2f0b5a0ed3349815cb974">getDataByHandle</a> ( <a class="code" href="class_i_context.html#a7284704610c7ea7cca699c8116feee0c">inputData</a>,dh);
<a name="l00099"></a>00099     <span class="keywordflow">if</span> ( data ) 
<a name="l00100"></a>00100       <span class="keywordflow">if</span> ( data -&gt;<a class="code" href="class_i_context.html#a607d8609c589bfa7937b5a8313c61d04">getName</a>().size() != 0 ) 
<a name="l00101"></a>00101     <span class="keywordflow">return</span> data;
<a name="l00102"></a>00102     data = <a class="code" href="class_i_context.html#a9e05e14cdde2f0b5a0ed3349815cb974">getDataByHandle</a> ( <a class="code" href="class_i_context.html#a7a37d0f4ea08c03624d14ae2860f077f">outputData</a>,dh);
<a name="l00103"></a>00103     <span class="keywordflow">if</span> ( data ) 
<a name="l00104"></a>00104       <span class="keywordflow">if</span> ( data -&gt;<a class="code" href="class_i_context.html#a607d8609c589bfa7937b5a8313c61d04">getName</a>().size() != 0 ) 
<a name="l00105"></a>00105     <span class="keywordflow">return</span> data;
<a name="l00106"></a>00106     data = <a class="code" href="class_i_context.html#a9e05e14cdde2f0b5a0ed3349815cb974">getDataByHandle</a> ( <a class="code" href="class_i_context.html#a398973dc27b31e89a4b4ab0f701dfee5">in_outData</a>,dh);
<a name="l00107"></a>00107     <span class="keywordflow">if</span> ( data ) 
<a name="l00108"></a>00108       <span class="keywordflow">if</span> ( data -&gt;<a class="code" href="class_i_context.html#a607d8609c589bfa7937b5a8313c61d04">getName</a>().size() != 0 ) 
<a name="l00109"></a>00109     <span class="keywordflow">return</span> data;
<a name="l00110"></a>00110     <span class="keywordflow">return</span> data;
<a name="l00111"></a>00111   }
<a name="l00112"></a>00112 
<a name="l00113"></a><a class="code" href="class_i_context.html#ae51615a53a707370e7aec0fe9fbf9c28">00113</a>   <span class="keywordtype">void</span> <a class="code" href="class_i_context.html#ae51615a53a707370e7aec0fe9fbf9c28">setParent</a> ( <a class="code" href="class_i_context.html">IContext</a> *_p ) {
<a name="l00114"></a>00114     <a class="code" href="class_i_context.html#aa97a20f038e5c3053c94f1a70779a0f1">parent</a> = _p;
<a name="l00115"></a>00115     <a class="code" href="class_i_context.html#aa97a20f038e5c3053c94f1a70779a0f1">parent</a>-&gt;<a class="code" href="class_i_context.html#a4b81890185d165540acdeb1e012264be">children</a>.push_back(<span class="keyword">this</span>);
<a name="l00116"></a>00116   }
<a name="l00117"></a><a class="code" href="class_i_context.html#a67fac0019748ff482ce820affb8603e2">00117</a>   <span class="keywordtype">void</span> <a class="code" href="class_i_context.html#a67fac0019748ff482ce820affb8603e2">traverse</a>(){
<a name="l00118"></a>00118     <span class="keywordflow">if</span> ( <a class="code" href="class_i_context.html#aa97a20f038e5c3053c94f1a70779a0f1">parent</a> != NULL )
<a name="l00119"></a>00119       <a class="code" href="class_i_context.html#aa97a20f038e5c3053c94f1a70779a0f1">parent</a>-&gt;<a class="code" href="class_i_context.html#aa590239dd58b3946bfd9fc3d6725eef8">print_name</a>(<span class="stringliteral">&quot;-&quot;</span>);
<a name="l00120"></a>00120     <span class="keywordflow">else</span>
<a name="l00121"></a>00121       cout &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; endl;
<a name="l00122"></a>00122     <a class="code" href="class_i_context.html#aa590239dd58b3946bfd9fc3d6725eef8">print_name</a>(<span class="stringliteral">&quot;--&quot;</span>);
<a name="l00123"></a>00123     <span class="keywordflow">for</span> (list&lt;IContext *&gt;::iterator it=<a class="code" href="class_i_context.html#a4b81890185d165540acdeb1e012264be">children</a>.begin();it !=<a class="code" href="class_i_context.html#a4b81890185d165540acdeb1e012264be">children</a>.end();it++)
<a name="l00124"></a>00124       (*it)-&gt;print_name(<span class="stringliteral">&quot;---&quot;</span>);
<a name="l00125"></a>00125   }
<a name="l00126"></a><a class="code" href="class_i_context.html#abd000624cf8693096672e84231136980">00126</a>   <span class="keywordtype">void</span> <a class="code" href="class_i_context.html#abd000624cf8693096672e84231136980">addInputData</a>(<a class="code" href="class_i_data.html">IData</a> *_d){
<a name="l00127"></a>00127     <a class="code" href="class_i_context.html#a7284704610c7ea7cca699c8116feee0c">inputData</a>.push_back(_d);
<a name="l00128"></a>00128   }
<a name="l00129"></a><a class="code" href="class_i_context.html#ad6edf24b50c7ef64bb01dbdd12c88e57">00129</a>   <span class="keywordtype">void</span> <a class="code" href="class_i_context.html#ad6edf24b50c7ef64bb01dbdd12c88e57">addOutputData</a>(<a class="code" href="class_i_data.html">IData</a> *_d){
<a name="l00130"></a>00130     <a class="code" href="class_i_context.html#a7a37d0f4ea08c03624d14ae2860f077f">outputData</a>.push_back(_d);
<a name="l00131"></a>00131   }
<a name="l00132"></a><a class="code" href="class_i_context.html#a6e2967c610f62b1e3d1411982efeead6">00132</a>   <span class="keywordtype">void</span> <a class="code" href="class_i_context.html#a6e2967c610f62b1e3d1411982efeead6">addInOutData</a>(<a class="code" href="class_i_data.html">IData</a> *_d){
<a name="l00133"></a>00133     <a class="code" href="class_i_context.html#a398973dc27b31e89a4b4ab0f701dfee5">in_outData</a>.push_back(_d);
<a name="l00134"></a>00134   }
<a name="l00135"></a><a class="code" href="class_i_context.html#aa6dd00242c03b780fa3b2394288b00ad">00135</a>   <span class="keywordtype">void</span> <a class="code" href="class_i_context.html#aa6dd00242c03b780fa3b2394288b00ad">resetVersions</a>(){
<a name="l00136"></a>00136     list&lt;IData*&gt;::iterator it ;
<a name="l00137"></a>00137     list&lt;IContext*&gt;::iterator ctx_it ;
<a name="l00138"></a>00138     <span class="keywordflow">for</span> ( it =<a class="code" href="class_i_context.html#a7284704610c7ea7cca699c8116feee0c">inputData</a>.begin(); it != <a class="code" href="class_i_context.html#a7284704610c7ea7cca699c8116feee0c">inputData</a>.end(); ++ it ){
<a name="l00139"></a>00139       (*it)-&gt;resetVersion();
<a name="l00140"></a>00140     }
<a name="l00141"></a>00141     <span class="comment">/*</span>
<a name="l00142"></a>00142 <span class="comment">      for ( it =outputData.begin(); it != outputData.end(); ++ it ){</span>
<a name="l00143"></a>00143 <span class="comment">      (*it)-&gt;resetVersion();</span>
<a name="l00144"></a>00144 <span class="comment">      }</span>
<a name="l00145"></a>00145 <span class="comment">    */</span>
<a name="l00146"></a>00146     <span class="keywordflow">for</span> ( ctx_it =<a class="code" href="class_i_context.html#a4b81890185d165540acdeb1e012264be">children</a>.begin(); ctx_it != <a class="code" href="class_i_context.html#a4b81890185d165540acdeb1e012264be">children</a>.end(); ++ ctx_it ){
<a name="l00147"></a>00147       (*ctx_it)-&gt;resetVersions();
<a name="l00148"></a>00148 
<a name="l00149"></a>00149     }
<a name="l00150"></a>00150   }
<a name="l00151"></a><a class="code" href="class_i_context.html#a7f31c062cbdd616553a6c46a4422a1cb">00151</a>   <span class="keywordtype">void</span> <a class="code" href="class_i_context.html#a7f31c062cbdd616553a6c46a4422a1cb">dumpDataVersions</a>(<a class="code" href="class_context_header.html">ContextHeader</a> *hdr=NULL){
<a name="l00152"></a>00152     list&lt;IData*&gt;::iterator it ;
<a name="l00153"></a>00153     <span class="keywordflow">if</span> ( hdr == NULL ) {
<a name="l00154"></a>00154       glbCtx.<a class="code" href="class_global_context.html#a016ede40f469516e58cdc0a720d77bd7">dumpLevels</a>();
<a name="l00155"></a>00155       <span class="keywordflow">for</span> ( it =<a class="code" href="class_i_context.html#a7284704610c7ea7cca699c8116feee0c">inputData</a>.begin(); it != <a class="code" href="class_i_context.html#a7284704610c7ea7cca699c8116feee0c">inputData</a>.end(); ++ it ){
<a name="l00156"></a>00156     (*it)-&gt;dumpVersion();
<a name="l00157"></a>00157       }
<a name="l00158"></a>00158     }
<a name="l00159"></a>00159     <span class="keywordflow">else</span> {
<a name="l00160"></a>00160       list &lt;DataRange *&gt; dr = hdr-&gt;getWriteRange();
<a name="l00161"></a>00161       list&lt;DataRange*&gt;::iterator  it = dr.begin();
<a name="l00162"></a>00162       <span class="keywordflow">for</span> ( ; it != dr.end() ;++it ){
<a name="l00163"></a>00163     <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> r = (*it)-&gt;row_from; r &lt;=(*it)-&gt;row_to; r++){
<a name="l00164"></a>00164       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> c = (*it)-&gt;col_from; c &lt;=(*it)-&gt;col_to; c++){
<a name="l00165"></a>00165         <a class="code" href="class_i_data.html">IData</a> &amp;d=*((*it)-&gt;d);
<a name="l00166"></a>00166         d(r,c)-&gt;<a class="code" href="class_i_data.html#a63c73bb8fa3a68e744b1fcad38508f0c">dumpVersion</a>();
<a name="l00167"></a>00167       }
<a name="l00168"></a>00168     }
<a name="l00169"></a>00169       }
<a name="l00170"></a>00170       dr = hdr-&gt;getReadRange();
<a name="l00171"></a>00171 
<a name="l00172"></a>00172       <span class="keywordflow">for</span> (it = dr.begin() ; it != dr.end() ;++it ){
<a name="l00173"></a>00173     <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> r = (*it)-&gt;row_from; r &lt;=(*it)-&gt;row_to; r++){
<a name="l00174"></a>00174       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> c = (*it)-&gt;col_from; c &lt;=(*it)-&gt;col_to; c++){
<a name="l00175"></a>00175         <a class="code" href="class_i_data.html">IData</a> &amp;d=*((*it)-&gt;d);
<a name="l00176"></a>00176         d(r,c)-&gt;<a class="code" href="class_i_data.html#a63c73bb8fa3a68e744b1fcad38508f0c">dumpVersion</a>();
<a name="l00177"></a>00177       }
<a name="l00178"></a>00178     }
<a name="l00179"></a>00179       }
<a name="l00180"></a>00180     }
<a name="l00181"></a>00181 
<a name="l00182"></a>00182   }
<a name="l00183"></a><a class="code" href="class_i_context.html#a4448138448c7a2a17ed1cfc3896ac3cf">00183</a>   <span class="keywordtype">void</span> <a class="code" href="class_i_context.html#a4448138448c7a2a17ed1cfc3896ac3cf">testHandles</a>(list&lt;IData*&gt; dlist){
<a name="l00184"></a>00184     list&lt;IData*&gt;::iterator it ;
<a name="l00185"></a>00185     <span class="keywordflow">for</span> (it = dlist.begin(); it != dlist.end(); ++it) {
<a name="l00186"></a>00186       (*it)-&gt;testHandles();
<a name="l00187"></a>00187     }
<a name="l00188"></a>00188   }
<a name="l00189"></a><a class="code" href="class_i_context.html#adff746ec169ed33998d86aa306ee3d93">00189</a>   <span class="keywordtype">void</span> <a class="code" href="class_i_context.html#adff746ec169ed33998d86aa306ee3d93">testHandles</a>(){
<a name="l00190"></a>00190     <a class="code" href="class_i_context.html">IContext</a> * c = glbCtx.<a class="code" href="class_global_context.html#abed42c65852eb40358a222c34108c65a">getContextByHandle</a>(*<a class="code" href="class_i_context.html#a9eb34b3b3544c4186cce3296d444a9ac">my_context_handle</a>);
<a name="l00191"></a>00191     printf(<span class="stringliteral">&quot;Context:%s - Handle:%ld &lt;--&gt; %s,%ld\n&quot;</span>,<a class="code" href="class_i_context.html#ae92fa26bc80aa6759c7410c2f933c68b">name</a>.c_str(),*<a class="code" href="class_i_context.html#a9eb34b3b3544c4186cce3296d444a9ac">my_context_handle</a>,c-&gt;<a class="code" href="class_i_context.html#a607d8609c589bfa7937b5a8313c61d04">getName</a>().c_str(),*c-&gt;<a class="code" href="class_i_context.html#a63664480f4eede6b3a5ab572dd454160">getContextHandle</a>());
<a name="l00192"></a>00192     printf(<span class="stringliteral">&quot;InputData Handles \n&quot;</span>);
<a name="l00193"></a>00193     <a class="code" href="class_i_context.html#adff746ec169ed33998d86aa306ee3d93">testHandles</a>( <a class="code" href="class_i_context.html#a7284704610c7ea7cca699c8116feee0c">inputData</a>);
<a name="l00194"></a>00194     printf(<span class="stringliteral">&quot;Output Data Handles \n&quot;</span>);
<a name="l00195"></a>00195     <a class="code" href="class_i_context.html#adff746ec169ed33998d86aa306ee3d93">testHandles</a>(<a class="code" href="class_i_context.html#a7a37d0f4ea08c03624d14ae2860f077f">outputData</a>);
<a name="l00196"></a>00196     printf(<span class="stringliteral">&quot;In/Out Data  Handles \n&quot;</span>);
<a name="l00197"></a>00197     <a class="code" href="class_i_context.html#adff746ec169ed33998d86aa306ee3d93">testHandles</a>(<a class="code" href="class_i_context.html#a398973dc27b31e89a4b4ab0f701dfee5">in_outData</a>);
<a name="l00198"></a>00198   }
<a name="l00199"></a>00199 
<a name="l00200"></a><a class="code" href="class_i_context.html#a2ef87189437c74906f961a523602b6c3">00200</a>   <a class="code" href="struct_data_handle.html">DataHandle</a> * <a class="code" href="class_i_context.html#a2ef87189437c74906f961a523602b6c3">createDataHandle</a> ( ) {
<a name="l00201"></a>00201     <a class="code" href="struct_data_handle.html">DataHandle</a> *d =glbCtx.<a class="code" href="class_global_context.html#aa3979e9a5f856d90384ebafb5ca9bf04">createDataHandle</a> () ;
<a name="l00202"></a>00202     d-&gt;<a class="code" href="struct_data_handle.html#a85a5c067d1fa51712432b28feefe7d2f">context_handle</a> = *<a class="code" href="class_i_context.html#a9eb34b3b3544c4186cce3296d444a9ac">my_context_handle</a> ; 
<a name="l00203"></a>00203     printf(<span class="stringliteral">&quot;@data se dh:%ld\n&quot;</span>,d-&gt;<a class="code" href="struct_data_handle.html#a8ef23cf8adc3b32ae4977de4537c673c">data_handle</a>);
<a name="l00204"></a>00204     <span class="keywordflow">return</span> d;
<a name="l00205"></a>00205   }
<a name="l00206"></a>00206  
<a name="l00207"></a>00207 };
<a name="l00208"></a>00208 <span class="comment">/*===================================================================================*/</span>
<a name="l00209"></a><a class="code" href="class_context.html">00209</a> <span class="keyword">class </span><a class="code" href="class_context.html">Context</a>: <span class="keyword">public</span> <a class="code" href="class_i_context.html">IContext</a>
<a name="l00210"></a>00210 {
<a name="l00211"></a>00211 <span class="keyword">public</span> :
<a name="l00212"></a><a class="code" href="class_context.html#a33e268526c03979a4db8bdabcce2fbf6">00212</a>   <a class="code" href="class_context.html#a5dd483a8c3183056682ebaa945acdc6d">Context</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *s ) :
<a name="l00213"></a>00213     <a class="code" href="class_i_context.html">IContext</a>(static_cast&lt;string&gt;(s))
<a name="l00214"></a>00214   {
<a name="l00215"></a>00215   }
<a name="l00216"></a><a class="code" href="class_context.html#a5dd483a8c3183056682ebaa945acdc6d">00216</a>   <a class="code" href="class_context.html#a5dd483a8c3183056682ebaa945acdc6d">Context</a> (<span class="keywordtype">void</span>):<a class="code" href="class_i_context.html">IContext</a>(<span class="stringliteral">&quot;&quot;</span>) {
<a name="l00217"></a>00217     <a class="code" href="class_i_context.html#ae92fa26bc80aa6759c7410c2f933c68b">name</a>=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00218"></a>00218   }
<a name="l00219"></a>00219 };
<a name="l00220"></a>00220 <span class="comment">/*===================================================================================*/</span>
<a name="l00221"></a><a class="code" href="class_i_data.html#a6249481688df51d60d6e6dbf68fb69f2">00221</a> <span class="keywordtype">void</span> <a class="code" href="class_i_data.html#a6249481688df51d60d6e6dbf68fb69f2">IData::prepareMemory</a>(){
<a name="l00222"></a>00222     
<a name="l00223"></a>00223   <span class="comment">//      allocateMemory();</span>
<a name="l00224"></a>00224       <a class="code" href="class_i_data.html#a97916f47cd9feed0aad32c066172536f">dtPartition</a>=<span class="keyword">new</span> <a class="code" href="class_partition.html">Partition&lt;double&gt;</a>(2);
<a name="l00225"></a>00225       <a class="code" href="class_partition.html">Partition&lt;double&gt;</a> *p = <a class="code" href="class_i_data.html#a97916f47cd9feed0aad32c066172536f">dtPartition</a>;
<a name="l00226"></a>00226       p-&gt;<a class="code" href="class_partition.html#a8ca97963e7769bec5e7c59f9e4660427">setBaseMemory</a>(<a class="code" href="class_i_data.html#a513a1ad05e427af81ca7c34291826efb">getContentAddress</a>() ,  <a class="code" href="class_i_data.html#a32479396ae443e9e80f6517fd1e20f35">getContentSize</a>());
<a name="l00227"></a>00227       <span class="keywordflow">if</span>(1)
<a name="l00228"></a>00228     printf(<span class="stringliteral">&quot;####%s, PrepareData cntntAdr:%ld sz:%d\n&quot;</span>,<a class="code" href="class_i_data.html#a87b7baa5c42fd4c2b36875141030880d">getName</a>().c_str(),
<a name="l00229"></a>00229            <a class="code" href="class_i_data.html#a513a1ad05e427af81ca7c34291826efb">getContentAddress</a>(),<a class="code" href="class_i_data.html#a32479396ae443e9e80f6517fd1e20f35">getContentSize</a>());
<a name="l00230"></a>00230       p-&gt;<a class="code" href="class_partition.html#a5ca98c67580ef12ca1b2376638fb9714">partitionRectangle</a>(<a class="code" href="class_i_data.html#aff1391e4b21d315fe742aca22bfa5aed">local_m</a>,<a class="code" href="class_i_data.html#a521517b4c122b1260851e3cec3f8e83f">local_n</a>,<a class="code" href="class_i_data.html#a3158c94ab8af22d09004ff24c3db8205">local_mb</a>,<a class="code" href="class_i_data.html#a918da97f18b81ef440a65c7cde8f3438">local_nb</a>); 
<a name="l00231"></a>00231 
<a name="l00232"></a>00232 }
<a name="l00233"></a><a class="code" href="class_i_data.html#a9924a4023a9fedf223a74abfd96c72a0">00233</a> <span class="keywordtype">void</span> <a class="code" href="class_i_data.html#a9924a4023a9fedf223a74abfd96c72a0">IData::setPartition</a>(<span class="keywordtype">int</span> _mb, <span class="keywordtype">int</span> _nb){
<a name="l00234"></a>00234     
<a name="l00235"></a>00235   <a class="code" href="class_i_data.html#a170ac177a6048467713780cd3605e88e">Nb</a> = _nb;
<a name="l00236"></a>00236   <a class="code" href="class_i_data.html#a68696027e7617a3480fd0ae0a70df7fc">Mb</a> = _mb;
<a name="l00237"></a>00237   <span class="keywordtype">int</span> i_ex=0,j_ex=0;
<a name="l00238"></a>00238   <a class="code" href="class_i_data.html#abbfc199f238d3fe16d66bbfc18e74ad4">partial</a> = <span class="keyword">false</span>;
<a name="l00239"></a>00239   <span class="keywordflow">if</span> (0) {
<a name="l00240"></a>00240     <span class="keywordflow">if</span> (<a class="code" href="class_i_data.html#ae61dc22b2bb9c233eb93d891af16d220">N</a> % <a class="code" href="class_i_data.html#a170ac177a6048467713780cd3605e88e">Nb</a> !=0){
<a name="l00241"></a>00241       <a class="code" href="class_i_data.html#abbfc199f238d3fe16d66bbfc18e74ad4">partial</a>=<span class="keyword">true</span>;
<a name="l00242"></a>00242       j_ex=1;
<a name="l00243"></a>00243     }
<a name="l00244"></a>00244     <span class="keywordflow">if</span> (<a class="code" href="class_i_data.html#aebf70e773a06212897c33d7512f9d344">M</a> % <a class="code" href="class_i_data.html#a68696027e7617a3480fd0ae0a70df7fc">Mb</a> !=0){
<a name="l00245"></a>00245       <a class="code" href="class_i_data.html#abbfc199f238d3fe16d66bbfc18e74ad4">partial</a>=<span class="keyword">true</span>;
<a name="l00246"></a>00246       i_ex=1;
<a name="l00247"></a>00247     }
<a name="l00248"></a>00248   }
<a name="l00249"></a>00249   <a class="code" href="class_i_data.html#a952b0193f67329eccb52f4f6552a8b38">dataView</a>=<span class="keyword">new</span> vector&lt;vector&lt;IData*&gt; &gt;  (<a class="code" href="class_i_data.html#a68696027e7617a3480fd0ae0a70df7fc">Mb</a>+i_ex, vector&lt;IData*&gt;(<a class="code" href="class_i_data.html#a170ac177a6048467713780cd3605e88e">Nb</a>+j_ex)  );
<a name="l00250"></a>00250   <span class="keywordtype">char</span> s[100];
<a name="l00251"></a>00251   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0;i&lt;(<a class="code" href="class_i_data.html#a68696027e7617a3480fd0ae0a70df7fc">Mb</a>+i_ex);i++)
<a name="l00252"></a>00252     <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> j=0;j&lt;(<a class="code" href="class_i_data.html#a170ac177a6048467713780cd3605e88e">Nb</a>+j_ex);j++){
<a name="l00253"></a>00253       <a class="code" href="dt__log_8hpp.html#a4bc22876b48aa071c2b7a841f6d99a65">addLogEventStart</a>(<span class="stringliteral">&quot;DataPartitioned&quot;</span>,<a class="code" href="class_ductteip_log.html#a2d4f772da028bd358802f7cbe58c981ba2a10b7553029408b3c628bd2f847d44e">DuctteipLog::DataPartitioned</a>);
<a name="l00254"></a>00254       sprintf(s,<span class="stringliteral">&quot;%s_%2.2d_%2.2d&quot;</span>,  <a class="code" href="class_i_data.html#a66ed7cf77dc3382dfd6fcd81dc18e8df">name</a>.c_str() , i ,j);
<a name="l00255"></a>00255       <span class="keywordflow">if</span> ( <a class="code" href="class_i_data.html#a170ac177a6048467713780cd3605e88e">Nb</a> == 1) sprintf(s,<span class="stringliteral">&quot;%s_%2.2d&quot;</span>,  <a class="code" href="class_i_data.html#a66ed7cf77dc3382dfd6fcd81dc18e8df">name</a>.c_str() , i );
<a name="l00256"></a>00256       <span class="keywordflow">if</span> ( <a class="code" href="class_i_data.html#a68696027e7617a3480fd0ae0a70df7fc">Mb</a> == 1) sprintf(s,<span class="stringliteral">&quot;%s_%2.2d&quot;</span>,  <a class="code" href="class_i_data.html#a66ed7cf77dc3382dfd6fcd81dc18e8df">name</a>.c_str() , j );
<a name="l00257"></a>00257       (*dataView)[i][j] = <span class="keyword">new</span> <a class="code" href="class_i_data.html#a75fd2d8c81d6a34679ebc3222d8339a2">IData</a> (static_cast&lt;string&gt;(s),<a class="code" href="class_i_data.html#aebf70e773a06212897c33d7512f9d344">M</a>/<a class="code" href="class_i_data.html#a68696027e7617a3480fd0ae0a70df7fc">Mb</a>,<a class="code" href="class_i_data.html#ae61dc22b2bb9c233eb93d891af16d220">N</a>/<a class="code" href="class_i_data.html#a170ac177a6048467713780cd3605e88e">Nb</a>,<a class="code" href="class_i_data.html#a5ecc5b90d72d8b3d8a4a1af9de9fb71c">parent_context</a>);
<a name="l00258"></a>00258       <a class="code" href="class_i_data.html">IData</a> *newPart = (*dataView)[i][j];
<a name="l00259"></a>00259       newPart-&gt;<a class="code" href="class_i_data.html#a79e707470ffc0e3cb3b7a64a2ed3c6d3">blk</a>.<a class="code" href="class_coordinate.html#a0c9dfb8c2c3a73068bd02603ef7b3a33">bx</a> = j;
<a name="l00260"></a>00260       newPart-&gt;<a class="code" href="class_i_data.html#a79e707470ffc0e3cb3b7a64a2ed3c6d3">blk</a>.<a class="code" href="class_coordinate.html#a8e844a4d3fe7c4c960152801e9e08472">by</a> = i;
<a name="l00261"></a>00261       newPart-&gt;<a class="code" href="class_i_data.html#a4815f73848733b3ff225821b3d7431ea">parent_data</a> = this ;
<a name="l00262"></a>00262       newPart-&gt;<a class="code" href="class_i_data.html#a4c5003567bfc7b0e63f10b693858fa5c">hpData</a> = <a class="code" href="class_i_data.html#a4c5003567bfc7b0e63f10b693858fa5c">hpData</a> ;
<a name="l00263"></a>00263       newPart-&gt;<a class="code" href="class_i_data.html#a170ac177a6048467713780cd3605e88e">Nb</a> = 0 ;
<a name="l00264"></a>00264       newPart-&gt;<a class="code" href="class_i_data.html#a68696027e7617a3480fd0ae0a70df7fc">Mb</a> = 0 ;
<a name="l00265"></a>00265       newPart-&gt;<a class="code" href="class_i_data.html#ae61dc22b2bb9c233eb93d891af16d220">N</a>  = <a class="code" href="class_i_data.html#ae61dc22b2bb9c233eb93d891af16d220">N</a> ;
<a name="l00266"></a>00266       newPart-&gt;<a class="code" href="class_i_data.html#aebf70e773a06212897c33d7512f9d344">M</a>  = <a class="code" href="class_i_data.html#aebf70e773a06212897c33d7512f9d344">M</a> ;
<a name="l00267"></a>00267       newPart-&gt;<a class="code" href="class_i_data.html#a918da97f18b81ef440a65c7cde8f3438">local_nb</a>  = <a class="code" href="class_i_data.html#a918da97f18b81ef440a65c7cde8f3438">local_nb</a> ;
<a name="l00268"></a>00268       newPart-&gt;<a class="code" href="class_i_data.html#a3158c94ab8af22d09004ff24c3db8205">local_mb</a>  = <a class="code" href="class_i_data.html#a3158c94ab8af22d09004ff24c3db8205">local_mb</a> ;
<a name="l00269"></a>00269       newPart-&gt;<a class="code" href="class_i_data.html#a521517b4c122b1260851e3cec3f8e83f">local_n</a> = <a class="code" href="class_i_data.html#ae61dc22b2bb9c233eb93d891af16d220">N</a> / <a class="code" href="class_i_data.html#a170ac177a6048467713780cd3605e88e">Nb</a>   ;
<a name="l00270"></a>00270       newPart-&gt;<a class="code" href="class_i_data.html#aff1391e4b21d315fe742aca22bfa5aed">local_m</a> = <a class="code" href="class_i_data.html#aebf70e773a06212897c33d7512f9d344">M</a> / <a class="code" href="class_i_data.html#a68696027e7617a3480fd0ae0a70df7fc">Mb</a>   ;
<a name="l00271"></a>00271       <span class="keywordflow">if</span> ( newPart-&gt;<a class="code" href="class_i_data.html#ae7dd611bb647deae870c56208e58db08">getHost</a>() == <a class="code" href="context_8hpp.html#a94bbc6e3d7712df24be96e5e83d0aaf8">me</a> ) {
<a name="l00272"></a>00272     newPart-&gt;<a class="code" href="class_i_data.html#aa3f5c7ae906943db0780856ba3d53a33">allocateMemory</a>();
<a name="l00273"></a>00273     newPart-&gt;<a class="code" href="class_i_data.html#a97916f47cd9feed0aad32c066172536f">dtPartition</a>=<span class="keyword">new</span> <a class="code" href="class_partition.html">Partition&lt;double&gt;</a>(2);
<a name="l00274"></a>00274     <a class="code" href="class_partition.html">Partition&lt;double&gt;</a> *p = newPart-&gt;<a class="code" href="class_i_data.html#a97916f47cd9feed0aad32c066172536f">dtPartition</a>;
<a name="l00275"></a>00275     p-&gt;<a class="code" href="class_partition.html#a8ca97963e7769bec5e7c59f9e4660427">setBaseMemory</a>(newPart-&gt;<a class="code" href="class_i_data.html#a513a1ad05e427af81ca7c34291826efb">getContentAddress</a>() ,  newPart-&gt;<a class="code" href="class_i_data.html#a32479396ae443e9e80f6517fd1e20f35">getContentSize</a>());
<a name="l00276"></a>00276     <span class="keywordflow">if</span>(0)
<a name="l00277"></a>00277       printf(<span class="stringliteral">&quot;AllocData for %s=%p sz:%d,N=%d,M=%d\n&quot;</span>,s,newPart-&gt;<a class="code" href="class_i_data.html#a513a1ad05e427af81ca7c34291826efb">getContentAddress</a>(),newPart-&gt;<a class="code" href="class_i_data.html#a32479396ae443e9e80f6517fd1e20f35">getContentSize</a>(),<a class="code" href="class_i_data.html#ae61dc22b2bb9c233eb93d891af16d220">N</a>,<a class="code" href="class_i_data.html#aebf70e773a06212897c33d7512f9d344">M</a>);
<a name="l00278"></a>00278     <span class="keywordflow">if</span> (<a class="code" href="class_i_data.html#abbfc199f238d3fe16d66bbfc18e74ad4">partial</a>){
<a name="l00279"></a>00279       <span class="keywordflow">if</span>(i == <a class="code" href="class_i_data.html#a68696027e7617a3480fd0ae0a70df7fc">Mb</a> &amp;&amp; j == <a class="code" href="class_i_data.html#a170ac177a6048467713780cd3605e88e">Nb</a>){
<a name="l00280"></a>00280           printf(<span class="stringliteral">&quot;Data %s, has %d,%d elems.\n&quot;</span>,s,<a class="code" href="class_i_data.html#aebf70e773a06212897c33d7512f9d344">M</a>%<a class="code" href="class_i_data.html#a68696027e7617a3480fd0ae0a70df7fc">Mb</a>,<a class="code" href="class_i_data.html#ae61dc22b2bb9c233eb93d891af16d220">N</a>%<a class="code" href="class_i_data.html#a170ac177a6048467713780cd3605e88e">Nb</a>);
<a name="l00281"></a>00281           p-&gt;<a class="code" href="class_partition.html#a5ca98c67580ef12ca1b2376638fb9714">partitionRectangle</a>(<a class="code" href="class_i_data.html#aebf70e773a06212897c33d7512f9d344">M</a> % Mb, <a class="code" href="class_i_data.html#ae61dc22b2bb9c233eb93d891af16d220">N</a>%Nb,1,1);
<a name="l00282"></a>00282       }
<a name="l00283"></a>00283       <span class="keywordflow">else</span>{
<a name="l00284"></a>00284         <span class="keywordflow">if</span>(i == <a class="code" href="class_i_data.html#a68696027e7617a3480fd0ae0a70df7fc">Mb</a> ){
<a name="l00285"></a>00285           printf(<span class="stringliteral">&quot;Data %s, has %d,%d elems.\n&quot;</span>,s,<a class="code" href="class_i_data.html#aebf70e773a06212897c33d7512f9d344">M</a>%<a class="code" href="class_i_data.html#a68696027e7617a3480fd0ae0a70df7fc">Mb</a>,newPart-&gt;<a class="code" href="class_i_data.html#a521517b4c122b1260851e3cec3f8e83f">local_n</a>);
<a name="l00286"></a>00286           p-&gt;<a class="code" href="class_partition.html#a5ca98c67580ef12ca1b2376638fb9714">partitionRectangle</a>(<a class="code" href="class_i_data.html#aebf70e773a06212897c33d7512f9d344">M</a> % Mb, newPart-&gt;<a class="code" href="class_i_data.html#a521517b4c122b1260851e3cec3f8e83f">local_n</a>,1,1);
<a name="l00287"></a>00287         }
<a name="l00288"></a>00288         <span class="keywordflow">if</span> ( j== <a class="code" href="class_i_data.html#a170ac177a6048467713780cd3605e88e">Nb</a>){
<a name="l00289"></a>00289           printf(<span class="stringliteral">&quot;Data %s, has %d,%d elems.\n&quot;</span>,s,newPart-&gt;<a class="code" href="class_i_data.html#a521517b4c122b1260851e3cec3f8e83f">local_n</a>,<a class="code" href="class_i_data.html#ae61dc22b2bb9c233eb93d891af16d220">N</a>%<a class="code" href="class_i_data.html#a170ac177a6048467713780cd3605e88e">Nb</a>);
<a name="l00290"></a>00290           p-&gt;<a class="code" href="class_partition.html#a5ca98c67580ef12ca1b2376638fb9714">partitionRectangle</a>(newPart-&gt;<a class="code" href="class_i_data.html#aff1391e4b21d315fe742aca22bfa5aed">local_m</a>, <a class="code" href="class_i_data.html#ae61dc22b2bb9c233eb93d891af16d220">N</a> % Nb,1,1);
<a name="l00291"></a>00291         }
<a name="l00292"></a>00292       }
<a name="l00293"></a>00293     }
<a name="l00294"></a>00294     <span class="keywordflow">else</span>
<a name="l00295"></a>00295       p-&gt;<a class="code" href="class_partition.html#a5ca98c67580ef12ca1b2376638fb9714">partitionRectangle</a>(newPart-&gt;<a class="code" href="class_i_data.html#aff1391e4b21d315fe742aca22bfa5aed">local_m</a>,newPart-&gt;<a class="code" href="class_i_data.html#a521517b4c122b1260851e3cec3f8e83f">local_n</a>,
<a name="l00296"></a>00296                 <a class="code" href="class_i_data.html#a3158c94ab8af22d09004ff24c3db8205">local_mb</a>,<a class="code" href="class_i_data.html#a918da97f18b81ef440a65c7cde8f3438">local_nb</a>); 
<a name="l00297"></a>00297       }
<a name="l00298"></a>00298       <span class="keywordflow">else</span>{
<a name="l00299"></a>00299     newPart-&gt;<a class="code" href="class_i_data.html#af915b3633d8d539f6aa16aa0657cfc18">setRunTimeVersion</a>(<span class="stringliteral">&quot;-1&quot;</span>,-1);
<a name="l00300"></a>00300     newPart-&gt;<a class="code" href="class_i_data.html#ae8281ff366e454072b7b1f95034ac7b9">resetVersion</a>();
<a name="l00301"></a>00301       }
<a name="l00302"></a>00302       <a class="code" href="dt__log_8hpp.html#abc833f37fd95e0bec46f8203fb76eadb">addLogEventEnd</a>(<span class="stringliteral">&quot;DataPartitioned&quot;</span>,<a class="code" href="class_ductteip_log.html#a2d4f772da028bd358802f7cbe58c981ba2a10b7553029408b3c628bd2f847d44e">DuctteipLog::DataPartitioned</a>);
<a name="l00303"></a>00303 
<a name="l00304"></a>00304     }
<a name="l00305"></a>00305 }
<a name="l00306"></a>00306 <span class="comment">/*--------------------------------------------------------------*/</span>
<a name="l00307"></a><a class="code" href="class_i_data.html#a7f41e876d5c6c19e5b77ca480b3978b3">00307</a> <a class="code" href="class_i_data.html#a75fd2d8c81d6a34679ebc3222d8339a2">IData::IData</a>(<span class="keywordtype">string</span> _name,<span class="keywordtype">int</span> m, <span class="keywordtype">int</span> n,<a class="code" href="class_i_context.html">IContext</a> *ctx):    
<a name="l00308"></a>00308   <a class="code" href="chol__fact_8hpp.html#aee024c5945e8ca04515fea3513aeeaaa">M</a>(m),N(n), parent_context(ctx)
<a name="l00309"></a>00309 {
<a name="l00310"></a>00310   <a class="code" href="dt__log_8hpp.html#a2281e9cbd72942f0be829c845609e1c6">dt_log</a>.<a class="code" href="class_ductteip_log.html#a6d0afadbba975c706ef756a3ba23fe47">addEventStart</a> ( <span class="keyword">this</span>,<a class="code" href="class_ductteip_log.html#a2d4f772da028bd358802f7cbe58c981ba23d94f63d17369f641db2e0712b61d37">DuctteipLog::DataDefined</a>);
<a name="l00311"></a>00311   <a class="code" href="class_i_data.html#a66ed7cf77dc3382dfd6fcd81dc18e8df">name</a>=_name;
<a name="l00312"></a>00312   <a class="code" href="class_i_data.html#a6c41904f79abd83d922d00557a56d151">gt_read_version</a>.<a class="code" href="struct_data_version.html#a78dfae7089aaeffd22198af366968bb3">reset</a>();
<a name="l00313"></a>00313   <a class="code" href="class_i_data.html#a61d3d27cb7379fc3b1666a11b39dda2d">gt_write_version</a>.<a class="code" href="struct_data_version.html#a78dfae7089aaeffd22198af366968bb3">reset</a>();
<a name="l00314"></a>00314   <a class="code" href="class_i_data.html#a62fa408732cc79c91cc5af22ff52f5bd">rt_read_version</a>.<a class="code" href="struct_data_version.html#a78dfae7089aaeffd22198af366968bb3">reset</a>();
<a name="l00315"></a>00315   <a class="code" href="class_i_data.html#a633fad3f15a6898694a85dd74c94d89a">rt_write_version</a>.<a class="code" href="struct_data_version.html#a78dfae7089aaeffd22198af366968bb3">reset</a>();
<a name="l00316"></a>00316   <span class="keywordtype">string</span> s = glbCtx.<a class="code" href="class_global_context.html#a3f1200ddc2119935fac3b8b4ef5143d1">getLevelString</a>();
<a name="l00317"></a>00317   <a class="code" href="class_i_data.html#a62fa408732cc79c91cc5af22ff52f5bd">rt_read_version</a>.<a class="code" href="struct_data_version.html#a987f2c352ed0c65a7e9d83a1cabebb66">setContext</a>(s);
<a name="l00318"></a>00318   <a class="code" href="class_i_data.html#a633fad3f15a6898694a85dd74c94d89a">rt_write_version</a>.<a class="code" href="struct_data_version.html#a987f2c352ed0c65a7e9d83a1cabebb66">setContext</a>(s);
<a name="l00319"></a>00319   <a class="code" href="class_i_data.html#a68696027e7617a3480fd0ae0a70df7fc">Mb</a> = -1;<a class="code" href="class_i_data.html#a170ac177a6048467713780cd3605e88e">Nb</a>=-1;
<a name="l00320"></a>00320   <a class="code" href="class_i_data.html#a7e8587fe8eee5211a393f20752712bbc">setDataHandle</a>( ctx-&gt;<a class="code" href="class_i_context.html#a2ef87189437c74906f961a523602b6c3">createDataHandle</a>());
<a name="l00321"></a>00321   printf(<span class="stringliteral">&quot;@data se %s,dh:%ld\n&quot;</span>,<a class="code" href="class_i_data.html#a87b7baa5c42fd4c2b36875141030880d">getName</a>().c_str(),<a class="code" href="class_i_data.html#af0448989fa9d551acfb8ead2523a32e5">getDataHandleID</a>());
<a name="l00322"></a>00322   <a class="code" href="dt__log_8hpp.html#a2281e9cbd72942f0be829c845609e1c6">dt_log</a>.<a class="code" href="class_ductteip_log.html#a9a010d4387f7f74b848d5c36aaacd501">addEventEnd</a> ( <span class="keyword">this</span>,<a class="code" href="class_ductteip_log.html#a2d4f772da028bd358802f7cbe58c981ba23d94f63d17369f641db2e0712b61d37">DuctteipLog::DataDefined</a>);
<a name="l00323"></a>00323   <a class="code" href="class_i_data.html#a409bcb0fb45a8d4fadc214780ad15470">hM</a> = NULL;
<a name="l00324"></a>00324   <a class="code" href="class_i_data.html#a97916f47cd9feed0aad32c066172536f">dtPartition</a> = NULL;
<a name="l00325"></a>00325   <a class="code" href="class_i_data.html#aabd7b42672ec3479c2e6a77fac395789">data_memory</a>=NULL;
<a name="l00326"></a>00326 }
<a name="l00327"></a>00327 <span class="comment">/*--------------------------------------------------------------*/</span>
<a name="l00328"></a><a class="code" href="class_i_data.html#a11fc47fc59754a19a489c464be31330e">00328</a> <span class="keywordtype">bool</span> <a class="code" href="class_i_data.html#a11fc47fc59754a19a489c464be31330e">IData::isOwnedBy</a>(<span class="keywordtype">int</span> p) {
<a name="l00329"></a>00329   <a class="code" href="class_coordinate.html">Coordinate</a> c = <a class="code" href="class_i_data.html#a79e707470ffc0e3cb3b7a64a2ed3c6d3">blk</a>;  
<a name="l00330"></a>00330   <span class="keywordflow">if</span> (<a class="code" href="class_i_data.html#a4815f73848733b3ff225821b3d7431ea">parent_data</a>-&gt;<a class="code" href="class_i_data.html#a170ac177a6048467713780cd3605e88e">Nb</a> == 1 ||   <a class="code" href="class_i_data.html#a4815f73848733b3ff225821b3d7431ea">parent_data</a>-&gt;<a class="code" href="class_i_data.html#a68696027e7617a3480fd0ae0a70df7fc">Mb</a> == 1 ) {
<a name="l00331"></a>00331     <span class="keywordflow">if</span> ( <a class="code" href="class_i_data.html#a4815f73848733b3ff225821b3d7431ea">parent_data</a>-&gt;<a class="code" href="class_i_data.html#a170ac177a6048467713780cd3605e88e">Nb</a> ==1) 
<a name="l00332"></a>00332       c.<a class="code" href="class_coordinate.html#a0c9dfb8c2c3a73068bd02603ef7b3a33">bx</a> = c.<a class="code" href="class_coordinate.html#a8e844a4d3fe7c4c960152801e9e08472">by</a>;
<a name="l00333"></a>00333     <span class="keywordflow">return</span> ( <a class="code" href="class_i_data.html#a4c5003567bfc7b0e63f10b693858fa5c">hpData</a>-&gt;<a class="code" href="class_i_host_policy.html#ab759310a417532f33b513fbe1ac6aea8">getHost</a> ( c,1 ) == p );
<a name="l00334"></a>00334   }
<a name="l00335"></a>00335   <span class="keywordflow">else</span>{
<a name="l00336"></a>00336     <span class="keywordtype">bool</span> b = (<a class="code" href="class_i_data.html#a4c5003567bfc7b0e63f10b693858fa5c">hpData</a>-&gt;<a class="code" href="class_i_host_policy.html#ab759310a417532f33b513fbe1ac6aea8">getHost</a> ( <a class="code" href="class_i_data.html#a79e707470ffc0e3cb3b7a64a2ed3c6d3">blk</a> ) == p) ;
<a name="l00337"></a>00337     <span class="keywordflow">return</span> b;
<a name="l00338"></a>00338   }
<a name="l00339"></a>00339 }
<a name="l00340"></a>00340 <span class="comment">/*--------------------------------------------------------------*/</span>
<a name="l00341"></a><a class="code" href="class_i_data.html#ae7dd611bb647deae870c56208e58db08">00341</a> <span class="keywordtype">int</span> <a class="code" href="class_i_data.html#ae7dd611bb647deae870c56208e58db08">IData::getHost</a>(){
<a name="l00342"></a>00342   <a class="code" href="class_coordinate.html">Coordinate</a> c = <a class="code" href="class_i_data.html#a79e707470ffc0e3cb3b7a64a2ed3c6d3">blk</a>;  
<a name="l00343"></a>00343   <span class="keywordflow">if</span> (<a class="code" href="class_i_data.html#a4815f73848733b3ff225821b3d7431ea">parent_data</a>-&gt;<a class="code" href="class_i_data.html#a170ac177a6048467713780cd3605e88e">Nb</a> == 1 ||   <a class="code" href="class_i_data.html#a4815f73848733b3ff225821b3d7431ea">parent_data</a>-&gt;<a class="code" href="class_i_data.html#a68696027e7617a3480fd0ae0a70df7fc">Mb</a> == 1 ) {
<a name="l00344"></a>00344     <span class="keywordflow">if</span> ( <a class="code" href="class_i_data.html#a4815f73848733b3ff225821b3d7431ea">parent_data</a>-&gt;<a class="code" href="class_i_data.html#a170ac177a6048467713780cd3605e88e">Nb</a> ==1) 
<a name="l00345"></a>00345       c.<a class="code" href="class_coordinate.html#a0c9dfb8c2c3a73068bd02603ef7b3a33">bx</a> = c.<a class="code" href="class_coordinate.html#a8e844a4d3fe7c4c960152801e9e08472">by</a>;
<a name="l00346"></a>00346     <span class="keywordflow">return</span> ( <a class="code" href="class_i_data.html#a4c5003567bfc7b0e63f10b693858fa5c">hpData</a>-&gt;<a class="code" href="class_i_host_policy.html#ab759310a417532f33b513fbe1ac6aea8">getHost</a> ( c,1 )  );
<a name="l00347"></a>00347   }
<a name="l00348"></a>00348   <span class="keywordflow">else</span>
<a name="l00349"></a>00349     <span class="keywordflow">return</span> <a class="code" href="class_i_data.html#a4c5003567bfc7b0e63f10b693858fa5c">hpData</a>-&gt;<a class="code" href="class_i_host_policy.html#ab759310a417532f33b513fbe1ac6aea8">getHost</a>(<a class="code" href="class_i_data.html#a79e707470ffc0e3cb3b7a64a2ed3c6d3">blk</a>);
<a name="l00350"></a>00350 }
<a name="l00351"></a>00351 <span class="comment">/*--------------------------------------------------------------*/</span>
<a name="l00352"></a><a class="code" href="class_i_data.html#a8593d60d0456b7904241d3a722db3acc">00352</a> <span class="keywordtype">void</span>   <a class="code" href="class_i_data.html#a8593d60d0456b7904241d3a722db3acc">IData::incrementVersion</a> ( <a class="code" href="class_i_data.html#a771c62d4a9d89ea755b61734fb41e372">AccessType</a> a) {
<a name="l00353"></a>00353   <a class="code" href="class_i_data.html#a6c41904f79abd83d922d00557a56d151">gt_read_version</a>++;
<a name="l00354"></a>00354   <span class="keywordflow">if</span> ( a == <a class="code" href="class_i_data.html#a771c62d4a9d89ea755b61734fb41e372aed5606f3868a90a4b31155ebdf63ed82">WRITE</a> ) {
<a name="l00355"></a>00355     <a class="code" href="class_i_data.html#a61d3d27cb7379fc3b1666a11b39dda2d">gt_write_version</a> = <a class="code" href="class_i_data.html#a6c41904f79abd83d922d00557a56d151">gt_read_version</a>;
<a name="l00356"></a>00356   }
<a name="l00357"></a>00357 }
<a name="l00358"></a>00358 <span class="comment">/*--------------------------------------------------------------*/</span>
<a name="l00359"></a><a class="code" href="class_i_data.html#a78a571407788130ebe382f51c3774605">00359</a> <a class="code" href="class_i_data.html">IData</a> *<a class="code" href="class_i_data.html#a78a571407788130ebe382f51c3774605">IData::getDataByHandle</a>  (<a class="code" href="struct_data_handle.html">DataHandle</a> *in_dh ) {
<a name="l00360"></a>00360   <a class="code" href="glb__context_8hpp.html#a5d74defbecaf11c4dbb0a4ce308e1c34">ContextHandle</a> *ch = <a class="code" href="class_i_data.html#a5ecc5b90d72d8b3d8a4a1af9de9fb71c">parent_context</a>-&gt;<a class="code" href="class_i_context.html#a63664480f4eede6b3a5ab572dd454160">getContextHandle</a>();
<a name="l00361"></a>00361   <a class="code" href="class_i_data.html">IData</a> *not_found=NULL;
<a name="l00362"></a>00362   <span class="keywordflow">if</span> ( *ch != in_dh-&gt;<a class="code" href="struct_data_handle.html#a85a5c067d1fa51712432b28feefe7d2f">context_handle</a> ){ 
<a name="l00363"></a>00363     <span class="keywordflow">return</span> not_found;
<a name="l00364"></a>00364   }
<a name="l00365"></a>00365   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_i_data.html#a68696027e7617a3480fd0ae0a70df7fc">Mb</a>; i++) {
<a name="l00366"></a>00366     <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> j = 0; j&lt; <a class="code" href="class_i_data.html#a170ac177a6048467713780cd3605e88e">Nb</a>; j++){
<a name="l00367"></a>00367       <a class="code" href="struct_data_handle.html">DataHandle</a> *my_dh = (*dataView)[i][j]-&gt;<a class="code" href="class_i_data.html#a07c124c61dac722dded4c78d45be5cd2">getDataHandle</a>();
<a name="l00368"></a>00368       <span class="keywordflow">if</span> ( my_dh-&gt;<a class="code" href="struct_data_handle.html#a8ef23cf8adc3b32ae4977de4537c673c">data_handle</a> == in_dh-&gt;<a class="code" href="struct_data_handle.html#a8ef23cf8adc3b32ae4977de4537c673c">data_handle</a> ) {
<a name="l00369"></a>00369     <span class="keywordflow">return</span>  (*<a class="code" href="class_i_data.html#a952b0193f67329eccb52f4f6552a8b38">dataView</a>)[i][j];
<a name="l00370"></a>00370       }
<a name="l00371"></a>00371     }
<a name="l00372"></a>00372   }
<a name="l00373"></a>00373   <span class="keywordflow">return</span> not_found;
<a name="l00374"></a>00374 }
<a name="l00375"></a>00375 <span class="comment">/*--------------------------------------------------------------*/</span>
<a name="l00376"></a><a class="code" href="class_i_data.html#a75c651eb04ef64c699e24dfc0db2bfd4">00376</a> <span class="keywordtype">void</span>   <a class="code" href="class_i_data.html#a75c651eb04ef64c699e24dfc0db2bfd4">IData::testHandles</a>      (){
<a name="l00377"></a>00377   printf(<span class="stringliteral">&quot;Data:%s, Context:%ld Handle :%ld\n&quot;</span>,
<a name="l00378"></a>00378      <a class="code" href="class_i_data.html#a87b7baa5c42fd4c2b36875141030880d">getName</a>().c_str(),<a class="code" href="class_i_data.html#abd6a79717af4efae6236df2bf35f11a7">my_data_handle</a>-&gt;<a class="code" href="struct_data_handle.html#a85a5c067d1fa51712432b28feefe7d2f">context_handle</a>,<a class="code" href="class_i_data.html#abd6a79717af4efae6236df2bf35f11a7">my_data_handle</a>-&gt;<a class="code" href="struct_data_handle.html#a8ef23cf8adc3b32ae4977de4537c673c">data_handle</a>);
<a name="l00379"></a>00379   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="class_i_data.html#a68696027e7617a3480fd0ae0a70df7fc">Mb</a>;i++){
<a name="l00380"></a>00380     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;<a class="code" href="class_i_data.html#a170ac177a6048467713780cd3605e88e">Nb</a>;j++){
<a name="l00381"></a>00381       <a class="code" href="struct_data_handle.html">DataHandle</a> *dh = (*dataView)[i][j]-&gt;getDataHandle();
<a name="l00382"></a>00382       <a class="code" href="class_i_data.html">IData</a> *d = glbCtx.<a class="code" href="class_global_context.html#a82ec626cc456bb864bf2376e2bda621f">getDataByHandle</a>(dh);
<a name="l00383"></a>00383       <span class="keywordflow">if</span> ( d-&gt;<a class="code" href="class_i_data.html#a87b7baa5c42fd4c2b36875141030880d">getName</a>().size()!= 0 ) 
<a name="l00384"></a>00384     printf(<span class="stringliteral">&quot;%s-%ld,%ld  &lt;--&gt; %s,%ld\n&quot;</span>, 
<a name="l00385"></a>00385            (*<a class="code" href="class_i_data.html#a952b0193f67329eccb52f4f6552a8b38">dataView</a>)[i][j]-&gt;getName().c_str(),dh-&gt;<a class="code" href="struct_data_handle.html#a85a5c067d1fa51712432b28feefe7d2f">context_handle</a>,dh-&gt;<a class="code" href="struct_data_handle.html#a8ef23cf8adc3b32ae4977de4537c673c">data_handle</a>,
<a name="l00386"></a>00386            d-&gt;<a class="code" href="class_i_data.html#a87b7baa5c42fd4c2b36875141030880d">getName</a>().c_str(),d-&gt;<a class="code" href="class_i_data.html#a07c124c61dac722dded4c78d45be5cd2">getDataHandle</a>()-&gt;<a class="code" href="struct_data_handle.html#a8ef23cf8adc3b32ae4977de4537c673c">data_handle</a>);
<a name="l00387"></a>00387       <span class="keywordflow">else</span> 
<a name="l00388"></a>00388     printf(<span class="stringliteral">&quot;%s-%ld,%ld  &lt;--&gt; NULL  \n&quot;</span>, 
<a name="l00389"></a>00389            (*<a class="code" href="class_i_data.html#a952b0193f67329eccb52f4f6552a8b38">dataView</a>)[i][j]-&gt;<a class="code" href="class_i_data.html#a87b7baa5c42fd4c2b36875141030880d">getName</a>().c_str(),dh-&gt;<a class="code" href="struct_data_handle.html#a85a5c067d1fa51712432b28feefe7d2f">context_handle</a>,dh-&gt;<a class="code" href="struct_data_handle.html#a8ef23cf8adc3b32ae4977de4537c673c">data_handle</a>);
<a name="l00390"></a>00390     }
<a name="l00391"></a>00391   }
<a name="l00392"></a>00392 }
<a name="l00393"></a>00393 <span class="comment">/*===================================================================================*/</span>
<a name="l00394"></a><a class="code" href="class_global_context.html#abed42c65852eb40358a222c34108c65a">00394</a> <a class="code" href="class_i_context.html">IContext</a> *<a class="code" href="class_global_context.html#abed42c65852eb40358a222c34108c65a">GlobalContext::getContextByHandle</a>(<a class="code" href="glb__context_8hpp.html#a5d74defbecaf11c4dbb0a4ce308e1c34">ContextHandle</a> ch) {
<a name="l00395"></a>00395   list&lt;IContext *&gt; ::iterator it;
<a name="l00396"></a>00396   <span class="keywordflow">for</span> ( it= children.begin(); it != children.end();++it)
<a name="l00397"></a>00397     <span class="keywordflow">if</span> (*(*it)-&gt;getContextHandle() == ch) 
<a name="l00398"></a>00398       <span class="keywordflow">return</span> *it;
<a name="l00399"></a>00399   <span class="keywordflow">return</span> NULL;
<a name="l00400"></a>00400 }
<a name="l00401"></a>00401 <span class="comment">/*--------------------------------------------------------------*/</span>
<a name="l00402"></a><a class="code" href="class_global_context.html#a82ec626cc456bb864bf2376e2bda621f">00402</a> <a class="code" href="class_i_data.html">IData</a> *<a class="code" href="class_global_context.html#a82ec626cc456bb864bf2376e2bda621f">GlobalContext::getDataByHandle</a>(<a class="code" href="struct_data_handle.html">DataHandle</a> *d){
<a name="l00403"></a>00403   <a class="code" href="class_i_context.html">IContext</a> *ctx = <a class="code" href="class_global_context.html#abed42c65852eb40358a222c34108c65a">getContextByHandle</a>(d-&gt;<a class="code" href="struct_data_handle.html#a85a5c067d1fa51712432b28feefe7d2f">context_handle</a>);
<a name="l00404"></a>00404   <span class="keywordflow">return</span> ctx-&gt;<a class="code" href="class_i_context.html#a9e05e14cdde2f0b5a0ed3349815cb974">getDataByHandle</a>(d);
<a name="l00405"></a>00405 }
<a name="l00406"></a>00406 <span class="comment">/*--------------------------------------------------------------*/</span>
<a name="l00407"></a><a class="code" href="class_global_context.html#a9cf2bd9142e7592455d0542ee457f6ff">00407</a> <a class="code" href="struct_data_range.html">DataRange</a> *<a class="code" href="class_global_context.html#a9cf2bd9142e7592455d0542ee457f6ff">GlobalContext::getIndependentData</a>(<a class="code" href="class_i_context.html">IContext</a> *ctx,<span class="keywordtype">int</span> data_type){
<a name="l00408"></a>00408   <a class="code" href="class_i_data.html">IData</a> * data=NULL ;
<a name="l00409"></a>00409   <span class="keywordflow">if</span> ( data_type == <a class="code" href="class_global_context.html#af0e20c1e0fe7ae54a0770104388711adab853d0e0fa3a7be4b278689e37a5a9b2">InputData</a>)
<a name="l00410"></a>00410     data = ctx-&gt;<a class="code" href="class_i_context.html#a9e625b1922446c14cf63f712521788b4">getInputData</a>(); <span class="comment">// todo loop for all input data</span>
<a name="l00411"></a>00411   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (data_type == <a class="code" href="class_global_context.html#af0e20c1e0fe7ae54a0770104388711adae537fcf2b5764dcdd403687e2c8b8d2d">OutputData</a>)  
<a name="l00412"></a>00412     data = ctx-&gt;<a class="code" href="class_i_context.html#adc30ba64c308b29d60494a0d3ce26852">getOutputData</a>();<span class="comment">// todo loop for all output data</span>
<a name="l00413"></a>00413   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (data_type == <a class="code" href="class_global_context.html#af0e20c1e0fe7ae54a0770104388711adab77270bedb7ef8e06460664950d4d414">InOutData</a>)
<a name="l00414"></a>00414     data = ctx-&gt;<a class="code" href="class_i_context.html#ab62e24ee67cb0f7355a0671afd0cbe10">getInOutData</a>(); <span class="comment">// todo loop for all inout data</span>
<a name="l00415"></a>00415   <span class="keywordflow">if</span> ( !data ) 
<a name="l00416"></a>00416     <span class="keywordflow">return</span> NULL;
<a name="l00417"></a>00417   <a class="code" href="glb__context_8hpp.html#a5d74defbecaf11c4dbb0a4ce308e1c34">ContextHandle</a> dch = *data-&gt;<a class="code" href="class_i_data.html#af014d3691bd00c551cf4a36371ef80ec">getParent</a>()-&gt;<a class="code" href="class_i_context.html#a63664480f4eede6b3a5ab572dd454160">getContextHandle</a>();
<a name="l00418"></a>00418   <a class="code" href="glb__context_8hpp.html#a5d74defbecaf11c4dbb0a4ce308e1c34">ContextHandle</a> cch = *ctx-&gt;<a class="code" href="class_i_context.html#a63664480f4eede6b3a5ab572dd454160">getContextHandle</a>();
<a name="l00419"></a>00419   <span class="keywordflow">if</span> ( dch == cch ) 
<a name="l00420"></a>00420     <span class="keywordflow">return</span> data-&gt;<a class="code" href="class_i_data.html#aee2a0f1d0d749dc8a2380e4ae5e84c62">All</a>();
<a name="l00421"></a>00421   <span class="keywordflow">return</span> NULL;
<a name="l00422"></a>00422 }
<a name="l00423"></a>00423 
<a name="l00424"></a>00424 <span class="comment">/*--------------------------------------------------------------*/</span>
<a name="l00425"></a><a class="code" href="class_global_context.html#acc1cb373d80601e3a43f28db871aac10">00425</a> <span class="keywordtype">void</span> <a class="code" href="class_global_context.html#acc1cb373d80601e3a43f28db871aac10">GlobalContext::dumpStatistics</a>(<a class="code" href="class_config.html">Config</a> *_cfg){
<a name="l00426"></a>00426   <span class="keywordflow">if</span> ( <a class="code" href="context_8hpp.html#a94bbc6e3d7712df24be96e5e83d0aaf8">me</a> ==0)printf(<span class="stringliteral">&quot;#STAT:Node\tCtxIn\tCtxSkip\tT.Read\tT.Ins\tT.Prop.\tP.Size\tComm\tTotTask\tNb\tP\n&quot;</span>);
<a name="l00427"></a>00427   printf(<span class="stringliteral">&quot;#STAT:%2d\t%d\t%d\t%d\t%d\t%d\t%d\t%d\t%d\t%d\t%d\n&quot;</span>,
<a name="l00428"></a>00428      <a class="code" href="context_8hpp.html#a94bbc6e3d7712df24be96e5e83d0aaf8">me</a>,
<a name="l00429"></a>00429      counters[<a class="code" href="class_global_context.html#a5b47a178f9158cfca3d760cbe1a0a115a8adb31c6379a35150b91f4ae59856c1f">EnterContexts</a>],
<a name="l00430"></a>00430      counters[<a class="code" href="class_global_context.html#a5b47a178f9158cfca3d760cbe1a0a115a2a5f350feb0055da91f336f9e3288265">SkipContexts</a>],
<a name="l00431"></a>00431      counters[<a class="code" href="class_global_context.html#a5b47a178f9158cfca3d760cbe1a0a115ac0b6cd9e034ec35458daaf8f4da48df5">TaskRead</a>],
<a name="l00432"></a>00432      counters[<a class="code" href="class_global_context.html#a5b47a178f9158cfca3d760cbe1a0a115ac294a94038a694976dcbb30935c60eb4">TaskInsert</a>],
<a name="l00433"></a>00433      counters[<a class="code" href="class_global_context.html#a5b47a178f9158cfca3d760cbe1a0a115aecf7475ee9015f85457fe79ef93a529e">TaskPropagate</a>],
<a name="l00434"></a>00434      counters[<a class="code" href="class_global_context.html#a5b47a178f9158cfca3d760cbe1a0a115a2c3dcb9ea4474850f80d4b7c1fc43c6c">PropagateSize</a>],
<a name="l00435"></a>00435      counters[<a class="code" href="class_global_context.html#a5b47a178f9158cfca3d760cbe1a0a115af77be05d33c6713da530fb0f587bd01e">CommCost</a>],
<a name="l00436"></a>00436      TaskCount,
<a name="l00437"></a>00437      _cfg-&gt;getXBlocks(),
<a name="l00438"></a>00438      _cfg-&gt;getProcessors());
<a name="l00439"></a>00439 }
<a name="l00440"></a>00440 <span class="comment">/*--------------------------------------------------------------*/</span>
<a name="l00441"></a><a class="code" href="class_global_context.html#a7bf92109c22a9c883b6ca92143098019">00441</a> <span class="keywordtype">void</span> <a class="code" href="class_global_context.html#a7bf92109c22a9c883b6ca92143098019">GlobalContext::setConfiguration</a>(<a class="code" href="class_config.html">Config</a> *_cfg){
<a name="l00442"></a>00442   cfg=_cfg;
<a name="l00443"></a>00443   list &lt; PropagateInfo *&gt; lp;
<a name="l00444"></a>00444   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0 ; i &lt;cfg-&gt;getProcessors();i++)
<a name="l00445"></a>00445     nodesPropTasks.push_back(lp);
<a name="l00446"></a>00446 }
<a name="l00447"></a>00447 <span class="comment">/*--------------------------------------------------------------*/</span>
<a name="l00448"></a><a class="code" href="class_global_context.html#aeb21e846898eaf2a7ec28ded66cf4d17">00448</a> <span class="keywordtype">void</span> <a class="code" href="class_global_context.html#aeb21e846898eaf2a7ec28ded66cf4d17">GlobalContext::testHandles</a>(){
<a name="l00449"></a>00449   list&lt;IContext *&gt;::iterator it;
<a name="l00450"></a>00450   <span class="keywordflow">for</span>(it = children.begin();it != children.end(); ++it){
<a name="l00451"></a>00451     (*it)-&gt;testHandles();      
<a name="l00452"></a>00452   }
<a name="l00453"></a>00453 }
<a name="l00454"></a>00454 <span class="comment">/*===================================================================================*/</span>
<a name="l00455"></a><a class="code" href="struct_propagate_info.html#a87392639ebf09cbb6bb70edf7dc4c1aa">00455</a> <span class="keywordtype">void</span> <a class="code" href="struct_propagate_info.html#a87392639ebf09cbb6bb70edf7dc4c1aa">PropagateInfo::dump</a>(){
<a name="l00456"></a>00456   <a class="code" href="class_i_data.html">IData</a> *data  = glbCtx.<a class="code" href="class_global_context.html#a82ec626cc456bb864bf2376e2bda621f">getDataByHandle</a>(&amp;<a class="code" href="struct_propagate_info.html#abd2d16e1244a316b81e4ea55bf672078">data_handle</a>);
<a name="l00457"></a>00457   printf(<span class="stringliteral">&quot;prop: %s [%s%d] -&gt; [%s0]\n&quot;</span>,
<a name="l00458"></a>00458      data-&gt;<a class="code" href="class_i_data.html#a87b7baa5c42fd4c2b36875141030880d">getName</a>().c_str(),<a class="code" href="struct_propagate_info.html#a8d941df737a95b7eae658478422ff1c4">fromCtx</a>.c_str(),<a class="code" href="struct_propagate_info.html#a397493e2b12ee4f2922f4411dc2ee75a">fromVersion</a>,<a class="code" href="struct_propagate_info.html#ae9d0d464b1bbd144e2ba1a1ebd4e0382">toCtx</a>.c_str());
<a name="l00459"></a>00459 }
<a name="l00460"></a>00460 
<a name="l00461"></a>00461 <span class="comment">/*===================================================================================*/</span>
<a name="l00462"></a>00462 <span class="comment">/*----------------------------------------------------------------------*/</span>
<a name="l00463"></a>00463 <span class="comment">/*</span>
<a name="l00464"></a>00464 <span class="comment"> * At every level of contexts, processors are partitioned into sub-groups.</span>
<a name="l00465"></a>00465 <span class="comment"> * interval [offset + a,offset + b] :</span>
<a name="l00466"></a>00466 <span class="comment"> *   contains host id&apos;s of allowed group</span>
<a name="l00467"></a>00467 <span class="comment"> * s :</span>
<a name="l00468"></a>00468 <span class="comment"> *   size of each partition</span>
<a name="l00469"></a>00469 <span class="comment"> * p :</span>
<a name="l00470"></a>00470 <span class="comment"> *   index of allowed partition</span>
<a name="l00471"></a>00471 <span class="comment"> * groupCount[level]:</span>
<a name="l00472"></a>00472 <span class="comment"> *   number of partitions within the &apos;level&apos;</span>
<a name="l00473"></a>00473 <span class="comment"> */</span>
<a name="l00474"></a>00474 <span class="comment">/*----------------------------------------------------------------------*/</span>
<a name="l00475"></a><a class="code" href="class_context_host_policy.html#aa10ca0985dfed1351b9ef69fbe97f1f4">00475</a> <span class="keywordtype">bool</span> <a class="code" href="class_context_host_policy.html#ada4604e88c103b12a8d2a2a8c533dada">ContextHostPolicy::isAllowed</a>(<a class="code" href="class_i_context.html">IContext</a> *ctx,<a class="code" href="class_context_header.html">ContextHeader</a> *hdr){
<a name="l00476"></a>00476   <span class="keywordflow">if</span> (active_policy == <a class="code" href="class_context_host_policy.html#a8050b2efb974f28cbabe561cb04989a1a39048ccb3419ff4d10c0fb37662b0ce3">PROC_GROUP_CYCLIC</a>){
<a name="l00477"></a>00477     <span class="keywordflow">if</span> (groupCounter  != <a class="code" href="glb__context_8hpp.html#aa52be5d15d2fc877379023060f38f4fb">DONT_CARE_COUNTER</a> ) {
<a name="l00478"></a>00478       <span class="keywordtype">int</span> lower,upper;
<a name="l00479"></a>00479       <a class="code" href="class_context_host_policy.html#aff4f859ac0102e7ad268f17aff1b0259">getHostRange</a>(&amp;lower,&amp;upper);
<a name="l00480"></a>00480       <span class="keywordtype">int</span> group_size = upper - lower +1;
<a name="l00481"></a>00481       <span class="keywordtype">int</span> level = glbCtx.<a class="code" href="class_global_context.html#a1142264190522f36cd19e2f3cd3d5d51">getDepth</a>();
<a name="l00482"></a>00482       <span class="keywordtype">bool</span> b = ((groupCounter % group_size ) + lower ) == <a class="code" href="context_8hpp.html#a94bbc6e3d7712df24be96e5e83d0aaf8">me</a>;
<a name="l00483"></a>00483       <span class="comment">//if(b) printf(&quot;lv=%d,[%d %d],  gc=%d,gs=%d,allowed?%d\n&quot;,level,lower,upper,groupCounter,group_size,b);</span>
<a name="l00484"></a>00484       <span class="keywordflow">return</span> b;
<a name="l00485"></a>00485     }
<a name="l00486"></a>00486     <span class="keywordtype">int</span> a = 0 ;
<a name="l00487"></a>00487     <span class="keywordtype">int</span> b = <a class="code" href="class_i_host_policy.html#a8e93dcd6f13d6ad65da75ddf2837174f">PG</a>-&gt;<a class="code" href="class_process_grid.html#aba5b11a3a2274d287d46785b8752ac73">getProcessorCount</a>()-1;
<a name="l00488"></a>00488     <span class="keywordtype">int</span> offset = 0 ;
<a name="l00489"></a>00489     <span class="keywordtype">int</span> s;
<a name="l00490"></a>00490     <span class="keywordtype">int</span> p;
<a name="l00491"></a>00491     <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> level=0; level&lt;glbCtx.<a class="code" href="class_global_context.html#a1142264190522f36cd19e2f3cd3d5d51">getDepth</a>();level++){
<a name="l00492"></a>00492       s = (b - a +1 )  / groupCount[level];
<a name="l00493"></a>00493       p = glbCtx.<a class="code" href="class_global_context.html#a6e83bae803b2a595b2679b6b34bd572f">getLevelID</a>(level) % groupCount[level];
<a name="l00494"></a>00494       a = p * s;
<a name="l00495"></a>00495       b = (p+1) *s -1 ;
<a name="l00496"></a>00496       <span class="keywordflow">if</span> (<a class="code" href="context_8hpp.html#a94bbc6e3d7712df24be96e5e83d0aaf8">me</a> &lt; (offset + a) || <a class="code" href="context_8hpp.html#a94bbc6e3d7712df24be96e5e83d0aaf8">me</a> &gt; (offset+b) )  {
<a name="l00497"></a>00497     <span class="comment">//printf(&quot;ContextHostPolicy: %d is NOT in [%d,%d]\n&quot;,me,offset+a,offset+b);</span>
<a name="l00498"></a>00498     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00499"></a>00499       }
<a name="l00500"></a>00500       offset  += a;
<a name="l00501"></a>00501     }
<a name="l00502"></a>00502     <span class="keywordflow">if</span> (<a class="code" href="context_8hpp.html#a94bbc6e3d7712df24be96e5e83d0aaf8">me</a> &gt;= (offset) &amp;&amp; <a class="code" href="context_8hpp.html#a94bbc6e3d7712df24be96e5e83d0aaf8">me</a> &lt;= (offset-a+b) ) {
<a name="l00503"></a>00503       <span class="comment">//printf(&quot;ContextHostPolicy: %d IS in [%d,%d]\n&quot;,me,offset+a,offset+b);</span>
<a name="l00504"></a>00504       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00505"></a>00505     }
<a name="l00506"></a>00506     <span class="comment">//printf(&quot;ContextHostPolicy: %d is NOT in [%d,%d]\n&quot;,me,offset+a,offset+b);</span>
<a name="l00507"></a>00507   }
<a name="l00508"></a>00508   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00509"></a>00509 }
<a name="l00510"></a>00510 <span class="comment">/*--------------------------------------------------------------*/</span>
<a name="l00511"></a><a class="code" href="class_context_host_policy.html#aff4f859ac0102e7ad268f17aff1b0259">00511</a> <span class="keywordtype">void</span> <a class="code" href="class_context_host_policy.html#aff4f859ac0102e7ad268f17aff1b0259">ContextHostPolicy::getHostRange</a>(<span class="keywordtype">int</span> *lower, <span class="keywordtype">int</span> *upper){
<a name="l00512"></a>00512   <span class="keywordflow">if</span> (active_policy == <a class="code" href="class_context_host_policy.html#a8050b2efb974f28cbabe561cb04989a1a39048ccb3419ff4d10c0fb37662b0ce3">PROC_GROUP_CYCLIC</a>){
<a name="l00513"></a>00513     <span class="keywordtype">int</span> a = 0 ;
<a name="l00514"></a>00514     <span class="keywordtype">int</span> b = <a class="code" href="class_i_host_policy.html#a8e93dcd6f13d6ad65da75ddf2837174f">PG</a>-&gt;<a class="code" href="class_process_grid.html#aba5b11a3a2274d287d46785b8752ac73">getProcessorCount</a>()-1;
<a name="l00515"></a>00515     <span class="keywordtype">int</span> offset = 0 ;
<a name="l00516"></a>00516     <span class="keywordtype">int</span> s;
<a name="l00517"></a>00517     <span class="keywordtype">int</span> p;
<a name="l00518"></a>00518     <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> level=0; level&lt;glbCtx.<a class="code" href="class_global_context.html#a1142264190522f36cd19e2f3cd3d5d51">getDepth</a>();level++){
<a name="l00519"></a>00519       s = (b - a +1 )  / groupCount[level];
<a name="l00520"></a>00520       p = glbCtx.<a class="code" href="class_global_context.html#a6e83bae803b2a595b2679b6b34bd572f">getLevelID</a>(level) % groupCount[level];
<a name="l00521"></a>00521       a = p * s;
<a name="l00522"></a>00522       b = (p+1) *s -1 ;
<a name="l00523"></a>00523       offset  += a;
<a name="l00524"></a>00524     }
<a name="l00525"></a>00525     *lower = offset;
<a name="l00526"></a>00526     *upper = offset -a + b;
<a name="l00527"></a>00527   }
<a name="l00528"></a>00528 }
<a name="l00529"></a>00529 <span class="comment">/*===================================================================================*/</span>
<a name="l00530"></a><a class="code" href="class_task_read_policy.html#a10db4c46db394c083c73589cb998e5c3">00530</a> <span class="keywordtype">bool</span> <a class="code" href="class_task_read_policy.html#a10db4c46db394c083c73589cb998e5c3">TaskReadPolicy::isAllowed</a>(<a class="code" href="class_i_context.html">IContext</a> *c,<a class="code" href="class_context_header.html">ContextHeader</a> *hdr){
<a name="l00531"></a>00531   <span class="keywordflow">if</span> ( active_policy == <a class="code" href="class_task_read_policy.html#a173796d600a0db7f1a29bdc4a35be2bfa5d75cca618e06eb1359898ceafa315d8">ALL_GROUP_MEMBERS</a> ) {
<a name="l00532"></a>00532     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00533"></a>00533   }
<a name="l00534"></a>00534   <span class="keywordflow">if</span> ( active_policy == <a class="code" href="class_task_read_policy.html#a173796d600a0db7f1a29bdc4a35be2bfa06c6c9be41e59beb7b52e74f898ec0c1">ALL_READ_ALL</a> ) {
<a name="l00535"></a>00535     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00536"></a>00536   }
<a name="l00537"></a>00537   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00538"></a>00538 }
<a name="l00539"></a>00539 <span class="comment">/*===================================================================================*/</span>
<a name="l00540"></a><a class="code" href="class_task_add_policy.html#a80261d7262611c29d2b483e4e73cc204">00540</a> <span class="keywordtype">bool</span> <a class="code" href="class_task_add_policy.html#a80261d7262611c29d2b483e4e73cc204">TaskAddPolicy::isAllowed</a>(<a class="code" href="class_i_context.html">IContext</a> *c,<a class="code" href="class_context_header.html">ContextHeader</a> *hdr){
<a name="l00541"></a>00541   <span class="keywordtype">int</span> gc = glbCtx.<a class="code" href="class_global_context.html#adee851ed3b5bc641f500fca07ba72498">getContextHostPolicy</a>()-&gt;<a class="code" href="class_context_host_policy.html#a4281d32782181a79b2000f28fbb1b771">getGroupCounter</a>();
<a name="l00542"></a>00542   <span class="keywordflow">if</span> ( gc  == <a class="code" href="glb__context_8hpp.html#aa52be5d15d2fc877379023060f38f4fb">DONT_CARE_COUNTER</a> &amp;&amp; (active_policy != <a class="code" href="class_task_add_policy.html#afd8e033ef8b047a0df5c558cae84283ea0a442bc9b7d6e86b1e0d42ea2b5b2c4f">WRITE_DATA_OWNER</a>)  )
<a name="l00543"></a>00543     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00544"></a>00544   <span class="keywordflow">if</span> ( active_policy  == <a class="code" href="class_task_add_policy.html#afd8e033ef8b047a0df5c558cae84283ea7e73cbb6ef4a7caa7d911cbaefc1f58c">ROOT_ONLY</a> ) {
<a name="l00545"></a>00545     <span class="keywordflow">return</span> ( <a class="code" href="context_8hpp.html#a94bbc6e3d7712df24be96e5e83d0aaf8">me</a> == 0 ) ;
<a name="l00546"></a>00546   }
<a name="l00547"></a>00547   <span class="keywordflow">if</span> ( active_policy ==<a class="code" href="class_task_add_policy.html#afd8e033ef8b047a0df5c558cae84283eac49d7d0717a05341dbd7aff1a5157718">NOT_OWNER_CYCLIC</a> || active_policy == <a class="code" href="class_task_add_policy.html#afd8e033ef8b047a0df5c558cae84283ea0a442bc9b7d6e86b1e0d42ea2b5b2c4f">WRITE_DATA_OWNER</a>) {
<a name="l00548"></a>00548     <span class="keywordtype">int</span> r,c;
<a name="l00549"></a>00549     <a class="code" href="class_i_data.html">IData</a> *<a class="code" href="chol__fact_8hpp.html#a42b2ebd385e21f96a9663ad9f6c5e481">A</a>;
<a name="l00550"></a>00550     list&lt;DataRange *&gt; dr = hdr-&gt;<a class="code" href="class_context_header.html#a7fcb0018a060e3be48a54570a9ec5723">getWriteRange</a>();
<a name="l00551"></a>00551     list&lt;DataRange *&gt;::iterator it;
<a name="l00552"></a>00552     <span class="comment">//printf(&quot;TaskAddPolicy: isAllowed(%d)?\n&quot;,me);</span>
<a name="l00553"></a>00553     <span class="keywordflow">for</span> ( it = dr.begin(); it != dr.end(); ++it ) {
<a name="l00554"></a>00554       <span class="keywordflow">for</span> (  r=(*it)-&gt;row_from; r&lt;= (*it)-&gt;row_to;r++){
<a name="l00555"></a>00555     <span class="keywordflow">for</span> (  c=(*it)-&gt;col_from; c&lt;= (*it)-&gt;col_to;c++){
<a name="l00556"></a>00556       A=(*it)-&gt;d;
<a name="l00557"></a>00557       <span class="comment">//printf(&quot;A(%d,%d), %s\n&quot;,r,c,(*A)(r,c)-&gt;getName().c_str());</span>
<a name="l00558"></a>00558       <span class="keywordflow">if</span> ( (*A)(r,c)-&gt;isOwnedBy(<a class="code" href="context_8hpp.html#a94bbc6e3d7712df24be96e5e83d0aaf8">me</a>) ) {
<a name="l00559"></a>00559         <span class="comment">//printf(&quot;Yes\n&quot;);</span>
<a name="l00560"></a>00560         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00561"></a>00561       }
<a name="l00562"></a>00562     }
<a name="l00563"></a>00563       }
<a name="l00564"></a>00564     }
<a name="l00565"></a>00565     <span class="comment">//printf(&quot;No\n&quot;);</span>
<a name="l00566"></a>00566     <span class="keywordflow">if</span> (active_policy == <a class="code" href="class_task_add_policy.html#afd8e033ef8b047a0df5c558cae84283ea0a442bc9b7d6e86b1e0d42ea2b5b2c4f">WRITE_DATA_OWNER</a>) 
<a name="l00567"></a>00567       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00568"></a>00568     it = dr.begin();
<a name="l00569"></a>00569     r=(*it)-&gt;row_from;
<a name="l00570"></a>00570     c=(*it)-&gt;col_from;
<a name="l00571"></a>00571     A=(*it)-&gt;d;
<a name="l00572"></a>00572     <span class="keywordtype">int</span> owner = (*A)(r,c)-&gt;<a class="code" href="class_task_add_policy.html#af4a2055c79d1605f4099bdec7f4429f2">getHost</a> () ;
<a name="l00573"></a>00573 
<a name="l00574"></a>00574     <a class="code" href="class_context_host_policy.html">ContextHostPolicy</a> *chp = <span class="keyword">static_cast&lt;</span><a class="code" href="class_context_host_policy.html">ContextHostPolicy</a> *<span class="keyword">&gt;</span>(glbCtx.<a class="code" href="class_global_context.html#adee851ed3b5bc641f500fca07ba72498">getContextHostPolicy</a>());
<a name="l00575"></a>00575     <span class="keywordtype">int</span> lower,upper;
<a name="l00576"></a>00576     chp-&gt;<a class="code" href="class_context_host_policy.html#aff4f859ac0102e7ad268f17aff1b0259">getHostRange</a>(&amp;lower,&amp;upper);
<a name="l00577"></a>00577     <span class="keywordflow">if</span> ( owner &gt;= lower &amp;&amp; owner &lt;= upper &amp;&amp; owner != <a class="code" href="context_8hpp.html#a94bbc6e3d7712df24be96e5e83d0aaf8">me</a>)
<a name="l00578"></a>00578       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00579"></a>00579     <span class="keywordtype">int</span> group_size = upper - lower + 1;
<a name="l00580"></a>00580     <span class="keywordtype">bool</span> b = ((not_owner_count % group_size ) + lower ) == <a class="code" href="context_8hpp.html#a94bbc6e3d7712df24be96e5e83d0aaf8">me</a>;
<a name="l00581"></a>00581     <span class="comment">//    printf(&quot;Not Owner, [%d %d] g-size=%d, me=%d,nocnt=%d,allowed=%d\n&quot;,</span>
<a name="l00582"></a>00582     <span class="comment">//    lower,upper,group_size,me,not_owner_count, b);</span>
<a name="l00583"></a>00583     not_owner_count++;
<a name="l00584"></a>00584     <span class="keywordflow">return</span> b;
<a name="l00585"></a>00585   }
<a name="l00586"></a>00586   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00587"></a>00587 }
<a name="l00588"></a>00588 <span class="comment">/*===================================================================================*/</span>
<a name="l00589"></a><a class="code" href="class_task_propagate_policy.html#af5be0fe1cf14a044035d62b5b40c2093">00589</a> <span class="keywordtype">bool</span> <a class="code" href="class_task_propagate_policy.html#af5be0fe1cf14a044035d62b5b40c2093">TaskPropagatePolicy::isAllowed</a>(<a class="code" href="class_context_host_policy.html">ContextHostPolicy</a> *hpContext,<span class="keywordtype">int</span> <a class="code" href="context_8hpp.html#a94bbc6e3d7712df24be96e5e83d0aaf8">me</a>){
<a name="l00590"></a>00590   <span class="keywordtype">int</span> lower,upper;
<a name="l00591"></a>00591   hpContext-&gt;<a class="code" href="class_context_host_policy.html#aff4f859ac0102e7ad268f17aff1b0259">getHostRange</a>(&amp;lower,&amp;upper);
<a name="l00592"></a>00592   <span class="keywordflow">if</span> (active_policy == <a class="code" href="class_task_propagate_policy.html#a6c683eb92ff5d4fb9ea0b083732c13fda2d48d7fee629a2535833a384ae1a30ad">GROUP_LEADER</a> )
<a name="l00593"></a>00593     <span class="keywordflow">return</span> ( me == lower);
<a name="l00594"></a>00594   <span class="keywordflow">if</span> (active_policy == <a class="code" href="class_task_propagate_policy.html#a6c683eb92ff5d4fb9ea0b083732c13fda59cd907f4d363e9b2cb3f2b96baad3e9">ALL_CYCLIC</a>) {
<a name="l00595"></a>00595     <span class="keywordtype">int</span> group_size = upper - lower + 1;
<a name="l00596"></a>00596     <span class="keywordtype">bool</span> b = ((propagate_count % group_size ) + lower ) == me;
<a name="l00597"></a>00597     <span class="comment">//printf(&quot;taskprop policy : pcnt:%d grp:%d lower:%d me:%d is_allowed:%d\n&quot;,propagate_count ,group_size  ,lower , me,b);</span>
<a name="l00598"></a>00598     propagate_count++;
<a name="l00599"></a>00599     <span class="keywordflow">return</span> b;
<a name="l00600"></a>00600   }
<a name="l00601"></a>00601   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00602"></a>00602 }
<a name="l00603"></a>00603 <span class="comment">/*===================================================================================*/</span>
<a name="l00604"></a><a class="code" href="context_8hpp.html#acc758e315b7ee2179a56281208faef24">00604</a> <span class="keywordtype">bool</span> <a class="code" href="context_8hpp.html#acc758e315b7ee2179a56281208faef24">begin_context</a>(<a class="code" href="class_i_context.html">IContext</a> * curCtx,<a class="code" href="struct_data_range.html">DataRange</a> *r1,<a class="code" href="struct_data_range.html">DataRange</a> *r2,<a class="code" href="struct_data_range.html">DataRange</a> *w,<span class="keywordtype">int</span> counter,<span class="keywordtype">int</span> from,<span class="keywordtype">int</span> to){
<a name="l00605"></a>00605   <span class="keywordflow">if</span> (glbCtx.<a class="code" href="class_global_context.html#ac14dc301fa7de1207472da6f515a2f1f">canAllEnter</a>()){
<a name="l00606"></a>00606     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00607"></a>00607   }
<a name="l00608"></a>00608   <span class="keyword">static</span> <span class="keywordtype">int</span> count=0;
<a name="l00609"></a>00609   <a class="code" href="class_context_header.html">ContextHeader</a> *Summary = glbCtx.<a class="code" href="class_global_context.html#acede5d21ec0546c5a97ee5752960183a">getHeader</a>();
<a name="l00610"></a>00610   Summary-&gt;<a class="code" href="class_context_header.html#a06591e7f14d53be75366e52e991792f7">clear</a>();
<a name="l00611"></a>00611   Summary-&gt;<a class="code" href="class_context_header.html#af5cb224ae44fa1719f62e24b92725b95">addDataRange</a>(<a class="code" href="class_i_data.html#a771c62d4a9d89ea755b61734fb41e372ab0001574263456e6fbf9b4355353484c">IData::READ</a>,r1);
<a name="l00612"></a>00612   <span class="keywordflow">if</span> ( r2 != NULL )
<a name="l00613"></a>00613     Summary-&gt;<a class="code" href="class_context_header.html#af5cb224ae44fa1719f62e24b92725b95">addDataRange</a>(<a class="code" href="class_i_data.html#a771c62d4a9d89ea755b61734fb41e372ab0001574263456e6fbf9b4355353484c">IData::READ</a>,r2);
<a name="l00614"></a>00614   Summary-&gt;<a class="code" href="class_context_header.html#af5cb224ae44fa1719f62e24b92725b95">addDataRange</a>(<a class="code" href="class_i_data.html#a771c62d4a9d89ea755b61734fb41e372aed5606f3868a90a4b31155ebdf63ed82">IData::WRITE</a>,w);
<a name="l00615"></a>00615   printf(<span class="stringliteral">&quot;@BeginContext \n&quot;</span>);
<a name="l00616"></a>00616   printf(<span class="stringliteral">&quot;@change Context(beg) from:%8.8s* %d\n&quot;</span>,glbCtx.<a class="code" href="class_global_context.html#a3f1200ddc2119935fac3b8b4ef5143d1">getLevelString</a>().c_str(),count++);
<a name="l00617"></a>00617   glbCtx.<a class="code" href="class_global_context.html#adee851ed3b5bc641f500fca07ba72498">getContextHostPolicy</a>()-&gt;<a class="code" href="class_context_host_policy.html#a7705f176010456efe3dfed9cbb351e2b">setGroupCounter</a>(counter);
<a name="l00618"></a>00618   <span class="comment">//glbCtx.sendPropagateTasks();</span>
<a name="l00619"></a>00619   <span class="comment">// glbCtx.createPropagateTasks();</span>
<a name="l00620"></a>00620   glbCtx.<a class="code" href="class_global_context.html#acdb15ae187d6c84b42851ddb94191eec">downLevel</a>();
<a name="l00621"></a>00621   glbCtx.<a class="code" href="class_global_context.html#a9d7b59f27bc2226614fe2a65f6c3d5d1">beginContext</a>();
<a name="l00622"></a>00622   glbCtx.<a class="code" href="class_global_context.html#ab7a7663698431c03044fb91223a8b0df">sendPropagateTasks</a>();
<a name="l00623"></a>00623   glbCtx.<a class="code" href="class_global_context.html#aa903129142d1e7420aa521b89e77789b">resetVersiosOfHeaderData</a>();
<a name="l00624"></a>00624   printf(<span class="stringliteral">&quot;@change Context(beg) to  :%8.8s* %d\n&quot;</span>,glbCtx.<a class="code" href="class_global_context.html#a3f1200ddc2119935fac3b8b4ef5143d1">getLevelString</a>().c_str(),count);
<a name="l00625"></a>00625   <span class="keywordtype">bool</span> b=glbCtx.<a class="code" href="class_global_context.html#adee851ed3b5bc641f500fca07ba72498">getContextHostPolicy</a>()-&gt;<a class="code" href="class_context_host_policy.html#ada4604e88c103b12a8d2a2a8c533dada">isAllowed</a>(curCtx,Summary);
<a name="l00626"></a>00626   <span class="keywordflow">if</span> (b){
<a name="l00627"></a>00627     glbCtx.<a class="code" href="class_global_context.html#a9348325efe41d1edae48c4313d07dc1a">incrementCounter</a>(<a class="code" href="class_global_context.html#a5b47a178f9158cfca3d760cbe1a0a115a8adb31c6379a35150b91f4ae59856c1f">GlobalContext::EnterContexts</a>);
<a name="l00628"></a>00628   }
<a name="l00629"></a>00629   <span class="keywordflow">else</span>{
<a name="l00630"></a>00630     <span class="comment">//curCtx-&gt;dumpDataVersions(Summary);</span>
<a name="l00631"></a>00631     glbCtx.<a class="code" href="class_global_context.html#a9348325efe41d1edae48c4313d07dc1a">incrementCounter</a>(<a class="code" href="class_global_context.html#a5b47a178f9158cfca3d760cbe1a0a115a2a5f350feb0055da91f336f9e3288265">GlobalContext::SkipContexts</a>);
<a name="l00632"></a>00632   }
<a name="l00633"></a>00633   <span class="keywordflow">return</span> b;
<a name="l00634"></a>00634 }
<a name="l00635"></a>00635 <span class="comment">/*--------------------------------------------------------------*/</span>
<a name="l00636"></a><a class="code" href="context_8hpp.html#ad3e9e7fab429e3247c4c4a1c633d7920">00636</a> <span class="keywordtype">void</span> <a class="code" href="context_8hpp.html#ad3e9e7fab429e3247c4c4a1c633d7920">end_context</a>(<a class="code" href="class_i_context.html">IContext</a> * curCtx){
<a name="l00637"></a>00637   <span class="keyword">static</span> <span class="keywordtype">int</span> count=0;
<a name="l00638"></a>00638   <span class="keywordflow">if</span> (glbCtx.<a class="code" href="class_global_context.html#ac14dc301fa7de1207472da6f515a2f1f">canAllEnter</a>()){
<a name="l00639"></a>00639     return ;
<a name="l00640"></a>00640   }
<a name="l00641"></a>00641   printf(<span class="stringliteral">&quot;@EndContext \n&quot;</span>);
<a name="l00642"></a>00642   printf(<span class="stringliteral">&quot;@change Context(end) from:%8.8s* %d\n&quot;</span>,glbCtx.<a class="code" href="class_global_context.html#a3f1200ddc2119935fac3b8b4ef5143d1">getLevelString</a>().c_str(),count++);
<a name="l00643"></a>00643   glbCtx.<a class="code" href="class_global_context.html#a0f3857165a2d4571d6ae82b86c6becbe">createPropagateTasks</a>();
<a name="l00644"></a>00644   glbCtx.<a class="code" href="class_global_context.html#a2afcc7411f13bee3be175887de0d5365">upLevel</a>();
<a name="l00645"></a>00645   <span class="comment">//glbCtx.sendPropagateTasks();</span>
<a name="l00646"></a>00646   <span class="comment">//glbCtx.resetVersiosOfHeaderData();</span>
<a name="l00647"></a>00647   printf(<span class="stringliteral">&quot;@change Context(end) to  :%8.8s* %d\n&quot;</span>,glbCtx.<a class="code" href="class_global_context.html#a3f1200ddc2119935fac3b8b4ef5143d1">getLevelString</a>().c_str(),count);
<a name="l00648"></a>00648   glbCtx.<a class="code" href="class_global_context.html#a67e7eba1f3ea2ff2cc9d321a64f8d2b4">endContext</a>();
<a name="l00649"></a>00649   glbCtx.<a class="code" href="class_global_context.html#acede5d21ec0546c5a97ee5752960183a">getHeader</a>()-&gt;<a class="code" href="class_context_header.html#a06591e7f14d53be75366e52e991792f7">clear</a>();
<a name="l00650"></a>00650 }
<a name="l00651"></a>00651 <span class="comment">/*----------------------------------------------------------------------------*/</span>
<a name="l00652"></a><a class="code" href="context_8hpp.html#a2cb5214266e53cf936ec7ff5502fc1e4">00652</a> <span class="keywordtype">void</span> <a class="code" href="context_8hpp.html#a2cb5214266e53cf936ec7ff5502fc1e4">AddTask</a> ( <a class="code" href="class_i_context.html">IContext</a> *ctx,
<a name="l00653"></a>00653            <span class="keywordtype">char</span>*s,
<a name="l00654"></a>00654            <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> key,
<a name="l00655"></a>00655            <a class="code" href="class_i_data.html">IData</a> *d1,
<a name="l00656"></a>00656            <a class="code" href="class_i_data.html">IData</a> *d2,
<a name="l00657"></a>00657            <a class="code" href="class_i_data.html">IData</a> *d3){
<a name="l00658"></a>00658   <a class="code" href="class_context_header.html">ContextHeader</a> *c=NULL;
<a name="l00659"></a>00659   <span class="keywordflow">if</span> ( !glbCtx.<a class="code" href="class_global_context.html#ab7afe64dbb26b367d9d49f098de7f158">getTaskReadHostPolicy</a>()-&gt;<a class="code" href="class_i_host_policy.html#a5200e3143a640e492438361a3fd2626a">isAllowed</a>(ctx,c) ){
<a name="l00660"></a>00660     printf(<span class="stringliteral">&quot;ctx read task disallowed.\n&quot;</span>);
<a name="l00661"></a>00661     <a class="code" href="dt__log_8hpp.html#a2281e9cbd72942f0be829c845609e1c6">dt_log</a>.<a class="code" href="class_ductteip_log.html#a9a010d4387f7f74b848d5c36aaacd501">addEventEnd</a>(<span class="stringliteral">&quot;ReadTask&quot;</span>,<a class="code" href="class_ductteip_log.html#a2d4f772da028bd358802f7cbe58c981ba1e430e99b7fa829f9bc837157819d1d0">DuctteipLog::ReadTask</a>);
<a name="l00662"></a>00662     <span class="keywordflow">return</span>;
<a name="l00663"></a>00663   }
<a name="l00664"></a>00664 
<a name="l00665"></a>00665   glbCtx.<a class="code" href="class_global_context.html#a9348325efe41d1edae48c4313d07dc1a">incrementCounter</a>(<a class="code" href="class_global_context.html#a5b47a178f9158cfca3d760cbe1a0a115ac0b6cd9e034ec35458daaf8f4da48df5">GlobalContext::TaskRead</a>);
<a name="l00666"></a>00666 
<a name="l00667"></a>00667   <a class="code" href="struct_data_range.html">DataRange</a> * dr = <span class="keyword">new</span> <a class="code" href="struct_data_range.html">DataRange</a>;
<a name="l00668"></a>00668   dr-&gt;<a class="code" href="struct_data_range.html#a50c6aff4cba6396786730dbf71ea606e">d</a> = d3-&gt;<a class="code" href="class_i_data.html#a44b0310e7c4e7ddd9a9656f857b7d382">getParentData</a>();
<a name="l00669"></a>00669   <a class="code" href="class_coordinate.html">Coordinate</a> b = d3-&gt;<a class="code" href="class_i_data.html#afe763d3746eda6f5814b162455abd8e5">getBlockIdx</a>();
<a name="l00670"></a>00670   dr-&gt;<a class="code" href="struct_data_range.html#a5afb680f6208ef6f7268d824dfd1acdf">row_from</a> = dr-&gt;<a class="code" href="struct_data_range.html#ac696d8155ade63bcb137163efa4eaad6">row_to</a> = b.<a class="code" href="class_coordinate.html#a8e844a4d3fe7c4c960152801e9e08472">by</a>;
<a name="l00671"></a>00671   dr-&gt;<a class="code" href="struct_data_range.html#a0aa3fad400201762e729b5899e916de7">col_from</a> = dr-&gt;<a class="code" href="struct_data_range.html#a7972ade60d7e0b41e840b4f1719156eb">col_to</a> = b.<a class="code" href="class_coordinate.html#a0c9dfb8c2c3a73068bd02603ef7b3a33">bx</a>;
<a name="l00672"></a>00672   c = <span class="keyword">new</span> <a class="code" href="class_context_header.html">ContextHeader</a> ;
<a name="l00673"></a>00673   c-&gt;<a class="code" href="class_context_header.html#af5cb224ae44fa1719f62e24b92725b95">addDataRange</a>(<a class="code" href="class_i_data.html#a771c62d4a9d89ea755b61734fb41e372aed5606f3868a90a4b31155ebdf63ed82">IData::WRITE</a>,dr);
<a name="l00674"></a>00674   <a class="code" href="dt__log_8hpp.html#a2281e9cbd72942f0be829c845609e1c6">dt_log</a>.<a class="code" href="class_ductteip_log.html#a6d0afadbba975c706ef756a3ba23fe47">addEventStart</a>(<span class="stringliteral">&quot;ReadTask&quot;</span>,<a class="code" href="class_ductteip_log.html#a2d4f772da028bd358802f7cbe58c981ba1e430e99b7fa829f9bc837157819d1d0">DuctteipLog::ReadTask</a>);
<a name="l00675"></a>00675 
<a name="l00676"></a>00676   
<a name="l00677"></a>00677 
<a name="l00678"></a>00678   <span class="keywordflow">if</span> ( glbCtx.<a class="code" href="class_global_context.html#aac8e417def6e6fc45699a87bf412f745">getTaskAddHostPolicy</a>()-&gt;<a class="code" href="class_i_host_policy.html#a5200e3143a640e492438361a3fd2626a">isAllowed</a>(ctx,c) ) {
<a name="l00679"></a>00679     glbCtx.<a class="code" href="class_global_context.html#a9348325efe41d1edae48c4313d07dc1a">incrementCounter</a>(<a class="code" href="class_global_context.html#a5b47a178f9158cfca3d760cbe1a0a115ac294a94038a694976dcbb30935c60eb4">GlobalContext::TaskInsert</a>);
<a name="l00680"></a>00680     <span class="keywordflow">if</span> ( !d3-&gt;<a class="code" href="class_i_data.html#a11fc47fc59754a19a489c464be31330e">isOwnedBy</a>(<a class="code" href="context_8hpp.html#a94bbc6e3d7712df24be96e5e83d0aaf8">me</a>) ){
<a name="l00681"></a>00681       glbCtx.<a class="code" href="class_global_context.html#a9348325efe41d1edae48c4313d07dc1a">incrementCounter</a>(<a class="code" href="class_global_context.html#a5b47a178f9158cfca3d760cbe1a0a115af77be05d33c6713da530fb0f587bd01e">GlobalContext::CommCost</a>);
<a name="l00682"></a>00682     }
<a name="l00683"></a>00683     list&lt;DataAccess *&gt; *dlist = <span class="keyword">new</span> list &lt;DataAccess *&gt;;
<a name="l00684"></a>00684     <a class="code" href="struct_data_access.html">DataAccess</a> *daxs ;
<a name="l00685"></a>00685     <span class="keywordflow">if</span> ( d1 != NULL ) {
<a name="l00686"></a>00686       daxs = <span class="keyword">new</span> <a class="code" href="struct_data_access.html">DataAccess</a>;
<a name="l00687"></a>00687       daxs-&gt;<a class="code" href="struct_data_access.html#a870b7cae3b37240d32647683d1fee440">data</a> = d1;
<a name="l00688"></a>00688       daxs-&gt;<a class="code" href="struct_data_access.html#a96ee68f6c0475d76d09a15b437746d8b">required_version</a> = d1-&gt;<a class="code" href="class_i_data.html#a60fc8394c65d93631d9c321b505f37d7">getWriteVersion</a>();
<a name="l00689"></a>00689       daxs-&gt;<a class="code" href="struct_data_access.html#a96ee68f6c0475d76d09a15b437746d8b">required_version</a>.<a class="code" href="struct_data_version.html#a987f2c352ed0c65a7e9d83a1cabebb66">setContext</a>( glbCtx.<a class="code" href="class_global_context.html#a3f1200ddc2119935fac3b8b4ef5143d1">getLevelString</a>() );
<a name="l00690"></a>00690       d1-&gt;<a class="code" href="class_i_data.html#a60fc8394c65d93631d9c321b505f37d7">getWriteVersion</a>().<a class="code" href="struct_data_version.html#a987f2c352ed0c65a7e9d83a1cabebb66">setContext</a>( glbCtx.<a class="code" href="class_global_context.html#a3f1200ddc2119935fac3b8b4ef5143d1">getLevelString</a>() );
<a name="l00691"></a>00691       d1-&gt;<a class="code" href="class_i_data.html#a0c16a5178f9f66eb3df346b82fbd9608">getReadVersion</a>().<a class="code" href="struct_data_version.html#a987f2c352ed0c65a7e9d83a1cabebb66">setContext</a>( glbCtx.<a class="code" href="class_global_context.html#a3f1200ddc2119935fac3b8b4ef5143d1">getLevelString</a>() );
<a name="l00692"></a>00692       daxs-&gt;<a class="code" href="struct_data_access.html#a8ca53e9ad20a0f233f4c9f0f42f4c967">type</a> = <a class="code" href="class_i_data.html#a771c62d4a9d89ea755b61734fb41e372ab0001574263456e6fbf9b4355353484c">IData::READ</a>;
<a name="l00693"></a>00693       dlist-&gt;push_back(daxs);
<a name="l00694"></a>00694     }
<a name="l00695"></a>00695     <span class="keywordflow">if</span> ( d2 != NULL ) {
<a name="l00696"></a>00696       daxs = <span class="keyword">new</span> <a class="code" href="struct_data_access.html">DataAccess</a>;
<a name="l00697"></a>00697       daxs-&gt;<a class="code" href="struct_data_access.html#a870b7cae3b37240d32647683d1fee440">data</a> = d2;
<a name="l00698"></a>00698       daxs-&gt;<a class="code" href="struct_data_access.html#a96ee68f6c0475d76d09a15b437746d8b">required_version</a> = d2-&gt;<a class="code" href="class_i_data.html#a60fc8394c65d93631d9c321b505f37d7">getWriteVersion</a>();
<a name="l00699"></a>00699       daxs-&gt;<a class="code" href="struct_data_access.html#a96ee68f6c0475d76d09a15b437746d8b">required_version</a>.<a class="code" href="struct_data_version.html#a987f2c352ed0c65a7e9d83a1cabebb66">setContext</a>( glbCtx.<a class="code" href="class_global_context.html#a3f1200ddc2119935fac3b8b4ef5143d1">getLevelString</a>() );
<a name="l00700"></a>00700       d2-&gt;<a class="code" href="class_i_data.html#a60fc8394c65d93631d9c321b505f37d7">getWriteVersion</a>().<a class="code" href="struct_data_version.html#a987f2c352ed0c65a7e9d83a1cabebb66">setContext</a>( glbCtx.<a class="code" href="class_global_context.html#a3f1200ddc2119935fac3b8b4ef5143d1">getLevelString</a>() );
<a name="l00701"></a>00701       d2-&gt;<a class="code" href="class_i_data.html#a0c16a5178f9f66eb3df346b82fbd9608">getReadVersion</a>().<a class="code" href="struct_data_version.html#a987f2c352ed0c65a7e9d83a1cabebb66">setContext</a>( glbCtx.<a class="code" href="class_global_context.html#a3f1200ddc2119935fac3b8b4ef5143d1">getLevelString</a>() );
<a name="l00702"></a>00702       daxs-&gt;<a class="code" href="struct_data_access.html#a8ca53e9ad20a0f233f4c9f0f42f4c967">type</a> = <a class="code" href="class_i_data.html#a771c62d4a9d89ea755b61734fb41e372ab0001574263456e6fbf9b4355353484c">IData::READ</a>;
<a name="l00703"></a>00703       dlist-&gt;push_back(daxs);
<a name="l00704"></a>00704     }
<a name="l00705"></a>00705     daxs = <span class="keyword">new</span> <a class="code" href="struct_data_access.html">DataAccess</a>;
<a name="l00706"></a>00706     daxs-&gt;<a class="code" href="struct_data_access.html#a870b7cae3b37240d32647683d1fee440">data</a> = d3;
<a name="l00707"></a>00707     daxs-&gt;<a class="code" href="struct_data_access.html#a96ee68f6c0475d76d09a15b437746d8b">required_version</a> = d3-&gt;<a class="code" href="class_i_data.html#a0c16a5178f9f66eb3df346b82fbd9608">getReadVersion</a>();
<a name="l00708"></a>00708     daxs-&gt;<a class="code" href="struct_data_access.html#a96ee68f6c0475d76d09a15b437746d8b">required_version</a>.<a class="code" href="struct_data_version.html#a987f2c352ed0c65a7e9d83a1cabebb66">setContext</a>( glbCtx.<a class="code" href="class_global_context.html#a3f1200ddc2119935fac3b8b4ef5143d1">getLevelString</a>() );
<a name="l00709"></a>00709     d3-&gt;<a class="code" href="class_i_data.html#a60fc8394c65d93631d9c321b505f37d7">getWriteVersion</a>().<a class="code" href="struct_data_version.html#a987f2c352ed0c65a7e9d83a1cabebb66">setContext</a>( glbCtx.<a class="code" href="class_global_context.html#a3f1200ddc2119935fac3b8b4ef5143d1">getLevelString</a>() );
<a name="l00710"></a>00710     d3-&gt;<a class="code" href="class_i_data.html#a0c16a5178f9f66eb3df346b82fbd9608">getReadVersion</a>().<a class="code" href="struct_data_version.html#a987f2c352ed0c65a7e9d83a1cabebb66">setContext</a>( glbCtx.<a class="code" href="class_global_context.html#a3f1200ddc2119935fac3b8b4ef5143d1">getLevelString</a>() );
<a name="l00711"></a>00711     daxs-&gt;<a class="code" href="struct_data_access.html#a8ca53e9ad20a0f233f4c9f0f42f4c967">type</a> = <a class="code" href="class_i_data.html#a771c62d4a9d89ea755b61734fb41e372aed5606f3868a90a4b31155ebdf63ed82">IData::WRITE</a>;
<a name="l00712"></a>00712     dlist-&gt;push_back(daxs);
<a name="l00713"></a>00713 
<a name="l00714"></a>00714     <a class="code" href="task_8hpp.html#a189c327d368d47849e32f5dfcb3c5f45">TaskHandle</a> task_handle =dtEngine.<a class="code" href="classengine.html#aa22a2fc88b7283b840e6db1e45dbdd5b">addTask</a>(ctx,s,key,d3-&gt;<a class="code" href="class_i_data.html#ae7dd611bb647deae870c56208e58db08">getHost</a>(),dlist);
<a name="l00715"></a>00715     
<a name="l00716"></a>00716     <a class="code" href="basic_8hpp.html#a01d4c8834420566804f361060f144094">PRINT_IF</a>(<a class="code" href="basic_8hpp.html#ad82dc13bc2f2cdd35dc8602b6a40b01e">INSERT_TASK_FLAG</a>) (<span class="stringliteral">&quot; @Insert TASK:%s(%ld)  %s,host=%d\n&quot;</span>, s,task_handle,d3-&gt;<a class="code" href="class_i_data.html#a11fc47fc59754a19a489c464be31330e">isOwnedBy</a>(<a class="code" href="context_8hpp.html#a94bbc6e3d7712df24be96e5e83d0aaf8">me</a>)?<span class="stringliteral">&quot;*&quot;</span>:<span class="stringliteral">&quot;&quot;</span>,<a class="code" href="context_8hpp.html#a94bbc6e3d7712df24be96e5e83d0aaf8">me</a>);
<a name="l00717"></a>00717     <span class="keywordflow">if</span> (d1) d1-&gt;<a class="code" href="class_i_data.html#aae35cd74cf8b062a958959d606d73f29">dump</a>(<span class="charliteral">&apos; &apos;</span>);
<a name="l00718"></a>00718     <span class="keywordflow">if</span> (d2) d2-&gt;<a class="code" href="class_i_data.html#aae35cd74cf8b062a958959d606d73f29">dump</a>(<span class="charliteral">&apos; &apos;</span>);
<a name="l00719"></a>00719     d3-&gt;<a class="code" href="class_i_data.html#aae35cd74cf8b062a958959d606d73f29">dump</a>(<span class="charliteral">&apos; &apos;</span>);
<a name="l00720"></a>00720     
<a name="l00721"></a>00721   }
<a name="l00722"></a>00722   <span class="keywordflow">else</span>{
<a name="l00723"></a>00723     <a class="code" href="basic_8hpp.html#a01d4c8834420566804f361060f144094">PRINT_IF</a>(<a class="code" href="basic_8hpp.html#aad3edae54a52ba521da45c5877db0510">SKIP_TASK_FLAG</a>)(<span class="stringliteral">&quot; @Skip TASK:%s  %s,host=%d\n&quot;</span>, s,d3-&gt;<a class="code" href="class_i_data.html#a11fc47fc59754a19a489c464be31330e">isOwnedBy</a>(<a class="code" href="context_8hpp.html#a94bbc6e3d7712df24be96e5e83d0aaf8">me</a>)?<span class="stringliteral">&quot;*&quot;</span>:<span class="stringliteral">&quot;&quot;</span>,<a class="code" href="context_8hpp.html#a94bbc6e3d7712df24be96e5e83d0aaf8">me</a>);
<a name="l00724"></a>00724   }
<a name="l00725"></a>00725 
<a name="l00726"></a>00726   <span class="keywordflow">if</span> ( d1 != NULL ) d1-&gt;<a class="code" href="class_i_data.html#a8593d60d0456b7904241d3a722db3acc">incrementVersion</a>(<a class="code" href="class_i_data.html#a771c62d4a9d89ea755b61734fb41e372ab0001574263456e6fbf9b4355353484c">IData::READ</a>);
<a name="l00727"></a>00727   <span class="keywordflow">if</span> ( d2 != NULL ) d2-&gt;<a class="code" href="class_i_data.html#a8593d60d0456b7904241d3a722db3acc">incrementVersion</a>(<a class="code" href="class_i_data.html#a771c62d4a9d89ea755b61734fb41e372ab0001574263456e6fbf9b4355353484c">IData::READ</a>);
<a name="l00728"></a>00728   d3-&gt;<a class="code" href="class_i_data.html#a8593d60d0456b7904241d3a722db3acc">incrementVersion</a>(<a class="code" href="class_i_data.html#a771c62d4a9d89ea755b61734fb41e372aed5606f3868a90a4b31155ebdf63ed82">IData::WRITE</a>);
<a name="l00729"></a>00729 
<a name="l00730"></a>00730   <span class="keyword">delete</span> dr;
<a name="l00731"></a>00731   c-&gt;<a class="code" href="class_context_header.html#a06591e7f14d53be75366e52e991792f7">clear</a>();
<a name="l00732"></a>00732   <span class="keyword">delete</span> c;
<a name="l00733"></a>00733   <a class="code" href="dt__log_8hpp.html#a2281e9cbd72942f0be829c845609e1c6">dt_log</a>.<a class="code" href="class_ductteip_log.html#a9a010d4387f7f74b848d5c36aaacd501">addEventEnd</a>(<span class="stringliteral">&quot;ReadTask&quot;</span>,<a class="code" href="class_ductteip_log.html#a2d4f772da028bd358802f7cbe58c981ba1e430e99b7fa829f9bc837157819d1d0">DuctteipLog::ReadTask</a>);
<a name="l00734"></a>00734 }
<a name="l00735"></a><a class="code" href="context_8hpp.html#a60352480279ffaad102d08783942e4e9">00735</a> <span class="keywordtype">void</span> <a class="code" href="context_8hpp.html#a2cb5214266e53cf936ec7ff5502fc1e4">AddTask</a> ( <a class="code" href="class_i_context.html">IContext</a> *ctx,<span class="keywordtype">char</span>*s,<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> key,<a class="code" href="class_i_data.html">IData</a> *d1                    ) { <a class="code" href="context_8hpp.html#a2cb5214266e53cf936ec7ff5502fc1e4">AddTask</a> ( ctx,s,key,NULL,NULL , d1);}
<a name="l00736"></a><a class="code" href="context_8hpp.html#a766f3457e29c5a7757b5baed89f2f894">00736</a> <span class="keywordtype">void</span> <a class="code" href="context_8hpp.html#a2cb5214266e53cf936ec7ff5502fc1e4">AddTask</a> ( <a class="code" href="class_i_context.html">IContext</a> *ctx,<span class="keywordtype">char</span>*s,<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> key,<a class="code" href="class_i_data.html">IData</a> *d1,<a class="code" href="class_i_data.html">IData</a> *d2          ) { <a class="code" href="context_8hpp.html#a2cb5214266e53cf936ec7ff5502fc1e4">AddTask</a> ( ctx,s,key,d1  ,NULL , d2);}
<a name="l00737"></a>00737 
<a name="l00738"></a>00738 <span class="comment">/*===============================================================================*/</span>
<a name="l00739"></a><a class="code" href="class_i_ductteip_task.html#aa9fae61a11236066513118d19ebd22b0">00739</a> <span class="keywordtype">void</span> <a class="code" href="class_i_ductteip_task.html#aa9fae61a11236066513118d19ebd22b0">IDuctteipTask::dump</a>(<span class="keywordtype">char</span> c){
<a name="l00740"></a>00740   <span class="keywordflow">if</span> ( !<a class="code" href="basic_8hpp.html#a048d50b21a1bbec6cb19610c35c5b03e">DUMP_FLAG</a>)
<a name="l00741"></a>00741     <span class="keywordflow">return</span>;
<a name="l00742"></a>00742   <span class="comment">//if ( c!=&apos;i&apos;) return;</span>
<a name="l00743"></a>00743   printf(<span class="stringliteral">&quot;#task:%s key:%lx ,no.of data:%ld state:%d expo:%d impo:%d\n &quot;</span>,
<a name="l00744"></a>00744      name.c_str(),key,data_list-&gt;size(),state,exported,imported);
<a name="l00745"></a>00745   <span class="keywordflow">if</span> (type == <a class="code" href="class_i_ductteip_task.html#a7f8f5e47d9590cb18a31f1b2860154d0a92cdf4ae80eb4c524b00cbbb3a9a2e0f">PropagateTask</a>)
<a name="l00746"></a>00746     prop_info-&gt;<a class="code" href="struct_propagate_info.html#a87392639ebf09cbb6bb70edf7dc4c1aa">dump</a>();
<a name="l00747"></a>00747   <span class="keywordflow">else</span>
<a name="l00748"></a>00748     <a class="code" href="class_i_ductteip_task.html#ab3ea4b7cc3e270b83a4b75655b4efa57">dumpDataAccess</a>(data_list);
<a name="l00749"></a>00749 }
<a name="l00750"></a>00750 <span class="comment">/*--------------------------------------------------------------*/</span>
<a name="l00751"></a><a class="code" href="class_i_ductteip_task.html#a9829e9023aab8fa4bc8e54f0064fff9a">00751</a> <a class="code" href="class_i_ductteip_task.html#ac3e5ee9cc9a149d2d1fdcaf4f9bb6d4e">IDuctteipTask::IDuctteipTask</a>(<a class="code" href="struct_propagate_info.html">PropagateInfo</a> *p){
<a name="l00752"></a>00752   prop_info = p;
<a name="l00753"></a>00753   type = <a class="code" href="class_i_ductteip_task.html#a7f8f5e47d9590cb18a31f1b2860154d0a92cdf4ae80eb4c524b00cbbb3a9a2e0f">PropagateTask</a>;
<a name="l00754"></a>00754   data_list = <span class="keyword">new</span> list&lt;DataAccess*&gt;;
<a name="l00755"></a>00755   <a class="code" href="struct_data_access.html">DataAccess</a> *daxs = <span class="keyword">new</span> <a class="code" href="struct_data_access.html">DataAccess</a>;
<a name="l00756"></a>00756   daxs-&gt;<a class="code" href="struct_data_access.html#a870b7cae3b37240d32647683d1fee440">data</a> = glbCtx.<a class="code" href="class_global_context.html#a82ec626cc456bb864bf2376e2bda621f">getDataByHandle</a>(&amp;p-&gt;<a class="code" href="struct_propagate_info.html#abd2d16e1244a316b81e4ea55bf672078">data_handle</a>);  
<a name="l00757"></a>00757   daxs-&gt;<a class="code" href="struct_data_access.html#a96ee68f6c0475d76d09a15b437746d8b">required_version</a> = p-&gt;<a class="code" href="struct_propagate_info.html#a397493e2b12ee4f2922f4411dc2ee75a">fromVersion</a>;
<a name="l00758"></a>00758   daxs-&gt;<a class="code" href="struct_data_access.html#a96ee68f6c0475d76d09a15b437746d8b">required_version</a>.<a class="code" href="struct_data_version.html#a987f2c352ed0c65a7e9d83a1cabebb66">setContext</a>( p-&gt;<a class="code" href="struct_propagate_info.html#a8d941df737a95b7eae658478422ff1c4">fromCtx</a>);
<a name="l00759"></a>00759   daxs-&gt;<a class="code" href="struct_data_access.html#a8ca53e9ad20a0f233f4c9f0f42f4c967">type</a> = <a class="code" href="class_i_data.html#a771c62d4a9d89ea755b61734fb41e372ab0001574263456e6fbf9b4355353484c">IData::READ</a>;
<a name="l00760"></a>00760   data_list-&gt;push_back(daxs);  
<a name="l00761"></a>00761 }
<a name="l00762"></a>00762 <span class="comment">/*--------------------------------------------------------------*/</span>
<a name="l00763"></a><a class="code" href="class_i_ductteip_task.html#ab388f79a34057d17d41286f57db4a288">00763</a> <span class="keywordtype">void</span> <a class="code" href="class_i_ductteip_task.html#ab388f79a34057d17d41286f57db4a288">IDuctteipTask::runPropagateTask</a>(){
<a name="l00764"></a>00764   <a class="code" href="class_i_data.html">IData</a> *data = glbCtx.<a class="code" href="class_global_context.html#a82ec626cc456bb864bf2376e2bda621f">getDataByHandle</a>(&amp;prop_info-&gt;<a class="code" href="struct_propagate_info.html#abd2d16e1244a316b81e4ea55bf672078">data_handle</a>);
<a name="l00765"></a>00765   data-&gt;<a class="code" href="class_i_data.html#af915b3633d8d539f6aa16aa0657cfc18">setRunTimeVersion</a>(prop_info-&gt;<a class="code" href="struct_propagate_info.html#ae9d0d464b1bbd144e2ba1a1ebd4e0382">toCtx</a>,0);
<a name="l00766"></a>00766   <a class="code" href="class_i_ductteip_task.html#abef058563393dffda702745c2503998f">setFinished</a>(<span class="keyword">true</span>);
<a name="l00767"></a>00767 }
<a name="l00768"></a>00768 <span class="comment">/*--------------------------------------------------------------*/</span>
<a name="l00769"></a><a class="code" href="class_i_ductteip_task.html#ace530f277583106811b9955fa1977f9d">00769</a> <a class="code" href="struct_message_buffer.html">MessageBuffer</a> *<a class="code" href="class_i_ductteip_task.html#ace530f277583106811b9955fa1977f9d">IDuctteipTask::serialize</a>(){
<a name="l00770"></a>00770   <span class="keywordtype">int</span> offset =0 ;
<a name="l00771"></a>00771   <a class="code" href="class_i_ductteip_task.html#ace530f277583106811b9955fa1977f9d">serialize</a>(message_buffer-&gt;<a class="code" href="struct_message_buffer.html#a3904730ac874f087e0d523ec5583a786">address</a>,offset,message_buffer-&gt;<a class="code" href="struct_message_buffer.html#a312b0b881f953e7297e09babf07ad310">size</a>);
<a name="l00772"></a>00772   <span class="keywordflow">return</span> message_buffer;
<a name="l00773"></a>00773 }
<a name="l00774"></a>00774 <span class="comment">/*--------------------------------------------------------------*/</span>
<a name="l00775"></a><a class="code" href="class_i_ductteip_task.html#a6f946dcbf504460e1a0de2672bcff1c2">00775</a> <span class="keywordtype">int</span> <a class="code" href="class_i_ductteip_task.html#ace530f277583106811b9955fa1977f9d">IDuctteipTask::serialize</a>(<a class="code" href="basic_8hpp.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *buffer,<span class="keywordtype">int</span> &amp;offset,<span class="keywordtype">int</span> max_length){
<a name="l00776"></a>00776   <span class="keywordtype">int</span> count =data_list-&gt;size();
<a name="l00777"></a>00777   list&lt;DataAccess *&gt;::iterator it;
<a name="l00778"></a>00778   copy&lt;unsigned long&gt;(buffer,offset,key);
<a name="l00779"></a>00779   <a class="code" href="glb__context_8hpp.html#a5d74defbecaf11c4dbb0a4ce308e1c34">ContextHandle</a> handle=*parent_context-&gt;<a class="code" href="class_i_context.html#a63664480f4eede6b3a5ab572dd454160">getContextHandle</a>();
<a name="l00780"></a>00780   copy&lt;ContextHandle&gt;(buffer,offset,handle);
<a name="l00781"></a>00781   copy&lt;int&gt;(buffer,offset,count);
<a name="l00782"></a>00782   <span class="keywordflow">for</span> ( it = data_list-&gt;begin(); it != data_list-&gt;end(); ++it ) {
<a name="l00783"></a>00783     (*it)-&gt;data-&gt;getDataHandle()-&gt;serialize(buffer,offset,max_length);
<a name="l00784"></a>00784     (*it)-&gt;required_version.serialize(buffer,offset,max_length);
<a name="l00785"></a>00785     <a class="code" href="basic_8hpp.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> type = (*it)-&gt;type;
<a name="l00786"></a>00786     copy&lt;byte&gt;(buffer,offset,type);
<a name="l00787"></a>00787   }
<a name="l00788"></a>00788   <span class="keywordflow">return</span> 0;
<a name="l00789"></a>00789 }
<a name="l00790"></a>00790 <span class="comment">/*--------------------------------------------------------------*/</span>
<a name="l00791"></a><a class="code" href="class_i_ductteip_task.html#a035d61635b69e2682c7361e3a07f610e">00791</a> <span class="keywordtype">void</span> <a class="code" href="class_i_ductteip_task.html#a035d61635b69e2682c7361e3a07f610e">IDuctteipTask::deserialize</a>(<a class="code" href="basic_8hpp.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *buffer,<span class="keywordtype">int</span> &amp;offset,<span class="keywordtype">int</span> max_length){
<a name="l00792"></a>00792   paste&lt;unsigned long&gt;(buffer,offset,&amp;key);
<a name="l00793"></a>00793   <span class="keywordtype">size_t</span> len = <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> long);
<a name="l00794"></a>00794   <a class="code" href="glb__context_8hpp.html#a5d74defbecaf11c4dbb0a4ce308e1c34">ContextHandle</a> handle ;
<a name="l00795"></a>00795   paste&lt;ContextHandle&gt;(buffer,offset,&amp;handle);
<a name="l00796"></a>00796   parent_context = glbCtx.<a class="code" href="class_global_context.html#abed42c65852eb40358a222c34108c65a">getContextByHandle</a>(handle);
<a name="l00797"></a>00797   name=parent_context-&gt;getTaskName(key);
<a name="l00798"></a>00798   <span class="keywordtype">int</span> count ;
<a name="l00799"></a>00799   paste&lt;int&gt;(buffer,offset,&amp;count);
<a name="l00800"></a>00800   data_list = <span class="keyword">new</span> list&lt;DataAccess *&gt;;
<a name="l00801"></a>00801   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;count; i++){
<a name="l00802"></a>00802     <a class="code" href="struct_data_access.html">DataAccess</a> *data_access = <span class="keyword">new</span> <a class="code" href="struct_data_access.html">DataAccess</a>;
<a name="l00803"></a>00803     <a class="code" href="struct_data_handle.html">DataHandle</a> *data_handle = <span class="keyword">new</span> <a class="code" href="struct_data_handle.html">DataHandle</a>;
<a name="l00804"></a>00804     data_handle-&gt;<a class="code" href="struct_data_handle.html#a4abd5569c8a2cb0ff6fdca749765aa70">deserialize</a>(buffer,offset,max_length);
<a name="l00805"></a>00805     <a class="code" href="class_i_data.html">IData</a> *data = glbCtx.<a class="code" href="class_global_context.html#a82ec626cc456bb864bf2376e2bda621f">getDataByHandle</a>(data_handle);
<a name="l00806"></a>00806     data_access-&gt;<a class="code" href="struct_data_access.html#a96ee68f6c0475d76d09a15b437746d8b">required_version</a>.<a class="code" href="struct_data_version.html#ac5bce97d68ce11492781071558bb1191">deserialize</a>(buffer,offset,max_length);
<a name="l00807"></a>00807     paste&lt;byte&gt;(buffer,offset,&amp;data_access-&gt;<a class="code" href="struct_data_access.html#a8ca53e9ad20a0f233f4c9f0f42f4c967">type</a>);
<a name="l00808"></a>00808     data_access-&gt;<a class="code" href="struct_data_access.html#a870b7cae3b37240d32647683d1fee440">data</a> = data;
<a name="l00809"></a>00809     data_list-&gt;push_back(data_access);
<a name="l00810"></a>00810   }
<a name="l00811"></a>00811 }
<a name="l00812"></a>00812 <span class="comment">/*--------------------------------------------------------------*/</span>
<a name="l00813"></a><a class="code" href="class_i_ductteip_task.html#abe3d6c79a56e71982297a88ff9a0921c">00813</a> <span class="keywordtype">void</span> <a class="code" href="class_i_ductteip_task.html#abe3d6c79a56e71982297a88ff9a0921c">IDuctteipTask::run</a>(){
<a name="l00814"></a>00814   <span class="keywordflow">if</span> ( state == <a class="code" href="class_i_ductteip_task.html#aa73f68557d24801eba9ab1ca61a6d8b8a2e345507c799f0cae7c77b35496aef1a">Finished</a> ) 
<a name="l00815"></a>00815     <span class="keywordflow">return</span>;
<a name="l00816"></a>00816   <span class="keywordflow">if</span> ( state == <a class="code" href="class_i_ductteip_task.html#aa73f68557d24801eba9ab1ca61a6d8b8a7e8dca5fd69a1c6780acce2f551e04ee">Running</a> ) 
<a name="l00817"></a>00817     <span class="keywordflow">return</span>;
<a name="l00818"></a>00818   <span class="keywordflow">if</span> (type == <a class="code" href="class_i_ductteip_task.html#a7f8f5e47d9590cb18a31f1b2860154d0a92cdf4ae80eb4c524b00cbbb3a9a2e0f">PropagateTask</a>){
<a name="l00819"></a>00819     <a class="code" href="class_i_ductteip_task.html#ab388f79a34057d17d41286f57db4a288">runPropagateTask</a>();
<a name="l00820"></a>00820   }
<a name="l00821"></a>00821   <span class="keywordflow">else</span>{
<a name="l00822"></a>00822     state = <a class="code" href="class_i_ductteip_task.html#aa73f68557d24801eba9ab1ca61a6d8b8a7e8dca5fd69a1c6780acce2f551e04ee">Running</a>;
<a name="l00823"></a>00823     <span class="keywordflow">if</span>(1)printf(<span class="stringliteral">&quot;%s starts running:\n&quot;</span>,<a class="code" href="class_i_ductteip_task.html#aff428fcafc7ce7f6aa9f281febead30a">getName</a>().c_str());
<a name="l00824"></a>00824     parent_context-&gt;<a class="code" href="class_i_context.html#a7e432ff03dfc96f39e8343b28f17fb74">runKernels</a>(<span class="keyword">this</span>);
<a name="l00825"></a>00825   }
<a name="l00826"></a>00826 }
<a name="l00827"></a>00827 <span class="comment">/*--------------------------------------------------------------*/</span>
<a name="l00828"></a><a class="code" href="class_i_ductteip_task.html#abef058563393dffda702745c2503998f">00828</a> <span class="keywordtype">void</span> <a class="code" href="class_i_ductteip_task.html#abef058563393dffda702745c2503998f">IDuctteipTask::setFinished</a>(<span class="keywordtype">bool</span> flag){
<a name="l00829"></a>00829   <span class="keywordflow">if</span> ( !flag ) 
<a name="l00830"></a>00830     return ;
<a name="l00831"></a>00831   state = <a class="code" href="class_i_ductteip_task.html#aa73f68557d24801eba9ab1ca61a6d8b8a2e345507c799f0cae7c77b35496aef1a">IDuctteipTask::Finished</a>;
<a name="l00832"></a>00832   <a class="code" href="dt__log_8hpp.html#a2281e9cbd72942f0be829c845609e1c6">dt_log</a>.<a class="code" href="class_ductteip_log.html#a9a010d4387f7f74b848d5c36aaacd501">addEventEnd</a>(<span class="keyword">this</span>,<a class="code" href="class_ductteip_log.html#a2d4f772da028bd358802f7cbe58c981ba3aa8d6f8b5d35e4f4871958a72908a68">DuctteipLog::Executed</a>);
<a name="l00833"></a>00833   <a class="code" href="basic_8hpp.html#a01d4c8834420566804f361060f144094">PRINT_IF</a>(<a class="code" href="basic_8hpp.html#aa29abba7f38dd5b150e49b163fa80522">OVERSUBSCRIBED</a>)(<span class="stringliteral">&quot;-----task:%s finish mutex unlocked,time:%Ld,st:%d,fin=%d,&quot;</span>,
<a name="l00834"></a>00834                <a class="code" href="class_i_ductteip_task.html#aff428fcafc7ce7f6aa9f281febead30a">getName</a>().c_str(),getTime(),state,<a class="code" href="class_i_ductteip_task.html#aa73f68557d24801eba9ab1ca61a6d8b8a2e345507c799f0cae7c77b35496aef1a">IDuctteipTask::Finished</a>);
<a name="l00835"></a>00835   <a class="code" href="basic_8hpp.html#a01d4c8834420566804f361060f144094">PRINT_IF</a>(<a class="code" href="basic_8hpp.html#aa29abba7f38dd5b150e49b163fa80522">OVERSUBSCRIBED</a>)(<span class="stringliteral">&quot;remained:%ld\n&quot;</span>,dtEngine.<a class="code" href="classengine.html#abe97f2997638c312c34128fd581472dd">getUnfinishedTasks</a>());
<a name="l00836"></a>00836 }
<a name="l00837"></a>00837 <span class="comment">/*--------------------------------------------------------------*/</span>
<a name="l00838"></a><a class="code" href="class_i_ductteip_task.html#ae4ef33df082b9727f281fdaa1896bb89">00838</a> <span class="keywordtype">void</span> <a class="code" href="class_i_ductteip_task.html#ae4ef33df082b9727f281fdaa1896bb89">IDuctteipTask::upgradeData</a>(<span class="keywordtype">char</span> c){
<a name="l00839"></a>00839   list&lt;DataAccess *&gt;::iterator it;
<a name="l00840"></a>00840   <span class="keywordtype">string</span> s;
<a name="l00841"></a>00841   s=<a class="code" href="class_i_ductteip_task.html#aff428fcafc7ce7f6aa9f281febead30a">getName</a>();
<a name="l00842"></a>00842   <span class="keywordflow">if</span> ( type == <a class="code" href="class_i_ductteip_task.html#a7f8f5e47d9590cb18a31f1b2860154d0a92cdf4ae80eb4c524b00cbbb3a9a2e0f">PropagateTask</a> ) 
<a name="l00843"></a>00843     <span class="keywordflow">return</span>;
<a name="l00844"></a>00844   <span class="keywordflow">for</span> ( it = data_list-&gt;begin(); it != data_list-&gt;end(); ++it ) {
<a name="l00845"></a>00845     s+=<span class="stringliteral">&quot;\n         - &quot;</span>+(*it)-&gt;data-&gt;getName()+<span class="stringliteral">&quot; &quot;</span>+(*it)-&gt;data-&gt;dumpVersionString();
<a name="l00846"></a>00846     <a class="code" href="basic_8hpp.html#a01d4c8834420566804f361060f144094">PRINT_IF</a>(<a class="code" href="basic_8hpp.html#a7baa2df2dc59e23e2d8872cc759d2999">DATA_UPGRADE_FLAG</a>)(<span class="stringliteral">&quot;** data upgraded :%s,%Ld\n&quot;</span>,
<a name="l00847"></a>00847                 (*it)-&gt;data-&gt;getName().c_str(),
<a name="l00848"></a>00848                 dtEngine.<a class="code" href="classengine.html#a1b418ba0ce7d9614cd03a30ab119456a">elapsedTime</a>(<a class="code" href="basic_8hpp.html#a648194302b12659edb03111b84350269">TIME_SCALE_TO_MILI_SECONDS</a>));
<a name="l00849"></a>00849     (*it)-&gt;data-&gt;incrementRunTimeVersion((*it)-&gt;type);
<a name="l00850"></a>00850     s+=<span class="stringliteral">&quot;\n                   &quot;</span>+(*it)-&gt;data-&gt;dumpVersionString();
<a name="l00851"></a>00851     <a class="code" href="dt__log_8hpp.html#a2281e9cbd72942f0be829c845609e1c6">dt_log</a>.<a class="code" href="class_ductteip_log.html#a2038f71b600647a1899da3a0022f9fc1">addEvent</a>((*it)-&gt;data, <a class="code" href="class_ductteip_log.html#a2d4f772da028bd358802f7cbe58c981ba3e4f069d2a962a0bb1c6c2bbffb97ec5">DuctteipLog::RunTimeVersionUpgraded</a>);    
<a name="l00852"></a>00852 
<a name="l00853"></a>00853   }
<a name="l00854"></a>00854   printf(<span class="stringliteral">&quot;%c(*)%s %ld\n&quot;</span>,c,s.c_str(),getTime());
<a name="l00855"></a>00855   state = <a class="code" href="class_i_ductteip_task.html#aa73f68557d24801eba9ab1ca61a6d8b8a1dd648383ed6b8a4132bf17552ed97b1">CanBeCleared</a>;
<a name="l00856"></a>00856   dtEngine.<a class="code" href="classengine.html#a18d1d14ee93df029db2216460a8ac6f4">putWorkForDataReady</a>(data_list);
<a name="l00857"></a>00857 }
<a name="l00858"></a>00858 <span class="comment">/*===============================================================================*/</span>
<a name="l00859"></a><a class="code" href="class_i_listener.html#a893f2f48814ce66437c6f2add51c8b8d">00859</a> <span class="keywordtype">void</span> <a class="code" href="class_i_listener.html#a893f2f48814ce66437c6f2add51c8b8d">IListener::deserialize</a>(<a class="code" href="basic_8hpp.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *buffer, <span class="keywordtype">int</span> &amp;offset, <span class="keywordtype">int</span> max_length){
<a name="l00860"></a>00860   <a class="code" href="struct_data_access.html">DataAccess</a> *data_access = <span class="keyword">new</span> <a class="code" href="struct_data_access.html">DataAccess</a>;
<a name="l00861"></a>00861   <a class="code" href="struct_data_handle.html">DataHandle</a> *data_handle = <span class="keyword">new</span> <a class="code" href="struct_data_handle.html">DataHandle</a>;
<a name="l00862"></a>00862   paste&lt;int&gt;(buffer,offset,&amp;host);
<a name="l00863"></a>00863   data_handle-&gt;<a class="code" href="struct_data_handle.html#a4abd5569c8a2cb0ff6fdca749765aa70">deserialize</a>(buffer,offset,max_length);
<a name="l00864"></a>00864   <a class="code" href="class_i_data.html">IData</a> *data = glbCtx.<a class="code" href="class_global_context.html#a82ec626cc456bb864bf2376e2bda621f">getDataByHandle</a>(data_handle);
<a name="l00865"></a>00865   data_access-&gt;<a class="code" href="struct_data_access.html#a96ee68f6c0475d76d09a15b437746d8b">required_version</a>.<a class="code" href="struct_data_version.html#ac5bce97d68ce11492781071558bb1191">deserialize</a>(buffer,offset,max_length);
<a name="l00866"></a>00866   data_access-&gt;<a class="code" href="struct_data_access.html#a870b7cae3b37240d32647683d1fee440">data</a> = data;
<a name="l00867"></a>00867   data_access-&gt;<a class="code" href="struct_data_access.html#a96ee68f6c0475d76d09a15b437746d8b">required_version</a>.<a class="code" href="struct_data_version.html#a03b5b85b2c309989eb96c2248b0dedfa">dump</a>();
<a name="l00868"></a>00868   data_request = data_access;
<a name="l00869"></a>00869   <a class="code" href="class_i_listener.html#ae53c9b5bd1067445dd09804efd04ea5c">dump</a>();
<a name="l00870"></a>00870 }
<a name="l00871"></a>00871 <span class="comment">/*===============================================================================*/</span>
<a name="l00872"></a><a class="code" href="classengine.html#a21127e8807bf1984daa2806e056aef9c">00872</a> <span class="keywordtype">void</span> <a class="code" href="classengine.html#a21127e8807bf1984daa2806e056aef9c">engine::receivePropagateTask</a>(<a class="code" href="basic_8hpp.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *buffer, <span class="keywordtype">int</span> len){
<a name="l00873"></a>00873   <a class="code" href="struct_propagate_info.html">PropagateInfo</a> *p = <span class="keyword">new</span> <a class="code" href="struct_propagate_info.html">PropagateInfo</a>;
<a name="l00874"></a>00874   <span class="keywordtype">int</span> offset =0 ;
<a name="l00875"></a>00875   p-&gt;<a class="code" href="struct_propagate_info.html#a7dd786107e3f53d7b24d7482709a3347">deserialize</a>(buffer,offset,len);
<a name="l00876"></a>00876   <a class="code" href="classengine.html#a9d0024f21ae5fa522fefdd38eade0a2e">addPropagateTask</a>(p);
<a name="l00877"></a>00877 }
<a name="l00878"></a>00878 <span class="comment">/*--------------------------------------------------------------*/</span>
<a name="l00879"></a><a class="code" href="classengine.html#a9d0024f21ae5fa522fefdd38eade0a2e">00879</a> <span class="keywordtype">void</span> <a class="code" href="classengine.html#a9d0024f21ae5fa522fefdd38eade0a2e">engine::addPropagateTask</a>(<a class="code" href="struct_propagate_info.html">PropagateInfo</a> *P){
<a name="l00880"></a>00880   <a class="code" href="class_i_ductteip_task.html">IDuctteipTask</a> *task = <span class="keyword">new</span> <a class="code" href="class_i_ductteip_task.html">IDuctteipTask</a>(P);
<a name="l00881"></a>00881   <span class="keywordtype">string</span> s(<span class="stringliteral">&quot;PROPTASK&quot;</span>);
<a name="l00882"></a>00882   task-&gt;<a class="code" href="class_i_ductteip_task.html#a29e56abf2e5991acc91462c1bbdb1511">setName</a>(s);
<a name="l00883"></a>00883   criticalSection(Enter) ;
<a name="l00884"></a>00884   <a class="code" href="task_8hpp.html#a189c327d368d47849e32f5dfcb3c5f45">TaskHandle</a> task_handle = last_task_handle ++;
<a name="l00885"></a>00885   task-&gt;<a class="code" href="class_i_ductteip_task.html#a1f1f64d2c28f10f03516d242e3674a7f">setHandle</a>(task_handle);
<a name="l00886"></a>00886   task_list.push_back(task);
<a name="l00887"></a>00887   putWorkForPropagateTask(task);
<a name="l00888"></a>00888   criticalSection(Leave) ;
<a name="l00889"></a>00889 }
<a name="l00890"></a><a class="code" href="classengine.html#a6db82799db55ccddd3d79093eeb3a16b">00890</a> <span class="keywordtype">void</span> <a class="code" href="classengine.html#a6db82799db55ccddd3d79093eeb3a16b">engine:: sendTask</a>(<a class="code" href="class_i_ductteip_task.html">IDuctteipTask</a>* task,<span class="keywordtype">int</span> destination){
<a name="l00891"></a>00891   <a class="code" href="struct_message_buffer.html">MessageBuffer</a> *m = task-&gt;<a class="code" href="class_i_ductteip_task.html#a6f946dcbf504460e1a0de2672bcff1c2">serialize</a>();
<a name="l00892"></a>00892   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ch =  mailbox-&gt;<a class="code" href="class_mail_box.html#ae6b86c4b322220e0a416dadec6e50877">send</a>(m-&gt;<a class="code" href="struct_message_buffer.html#a3904730ac874f087e0d523ec5583a786">address</a>,m-&gt;<a class="code" href="struct_message_buffer.html#a312b0b881f953e7297e09babf07ad310">size</a>,<a class="code" href="class_mail_box.html#a3699f2a3318218702288ec9fb7f8e38faf012aed1646a6269dd130a7be7c697e1">MailBox::TaskTag</a>,destination);
<a name="l00893"></a>00893   task-&gt;<a class="code" href="class_i_ductteip_task.html#ad0ae24379f4794c3363d1e94a1299c03">setCommHandle</a> (ch);
<a name="l00894"></a>00894   <a class="code" href="dt__log_8hpp.html#a2281e9cbd72942f0be829c845609e1c6">dt_log</a>.<a class="code" href="class_ductteip_log.html#a2038f71b600647a1899da3a0022f9fc1">addEvent</a>(task,<a class="code" href="class_ductteip_log.html#a2d4f772da028bd358802f7cbe58c981ba1d97314c59fae98ef06738440fa285ec">DuctteipLog::TaskSent</a>,destination);  
<a name="l00895"></a>00895 }
<a name="l00896"></a>00896 <span class="comment">/*--------------------------------------------------------------*/</span>
<a name="l00897"></a><a class="code" href="classengine.html#ab64370db1774805a8fbe041bdde1a01c">00897</a> <span class="keywordtype">void</span> <a class="code" href="classengine.html#ab64370db1774805a8fbe041bdde1a01c">engine:: exportTask</a>(<a class="code" href="class_i_ductteip_task.html">IDuctteipTask</a>* task,<span class="keywordtype">int</span> destination){
<a name="l00898"></a>00898   <a class="code" href="struct_message_buffer.html">MessageBuffer</a> *m = task-&gt;<a class="code" href="class_i_ductteip_task.html#a6f946dcbf504460e1a0de2672bcff1c2">serialize</a>();
<a name="l00899"></a>00899   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ch =  mailbox-&gt;<a class="code" href="class_mail_box.html#ae6b86c4b322220e0a416dadec6e50877">send</a>(m-&gt;<a class="code" href="struct_message_buffer.html#a3904730ac874f087e0d523ec5583a786">address</a>,m-&gt;<a class="code" href="struct_message_buffer.html#a312b0b881f953e7297e09babf07ad310">size</a>,<a class="code" href="class_mail_box.html#a3699f2a3318218702288ec9fb7f8e38fa3b5cca06c2573ad16f90d7da519f4888">MailBox::MigrateTaskTag</a>,destination);
<a name="l00900"></a>00900   task-&gt;<a class="code" href="class_i_ductteip_task.html#ad0ae24379f4794c3363d1e94a1299c03">setCommHandle</a> (ch);
<a name="l00901"></a>00901   printf(<span class="stringliteral">&quot;Task is exported:%s\n&quot;</span>,task-&gt;<a class="code" href="class_i_ductteip_task.html#aff428fcafc7ce7f6aa9f281febead30a">getName</a>().c_str());
<a name="l00902"></a>00902   task-&gt;<a class="code" href="class_i_ductteip_task.html#aa9fae61a11236066513118d19ebd22b0">dump</a>();
<a name="l00903"></a>00903   <a class="code" href="dt__log_8hpp.html#a2281e9cbd72942f0be829c845609e1c6">dt_log</a>.<a class="code" href="class_ductteip_log.html#a2038f71b600647a1899da3a0022f9fc1">addEvent</a>(task,<a class="code" href="class_ductteip_log.html#a2d4f772da028bd358802f7cbe58c981bad33c3c02abff701f13aeb5eeb619e86c">DuctteipLog::TaskExported</a>,destination);  
<a name="l00904"></a>00904 }
<a name="l00905"></a>00905 <span class="comment">/*=====================================================================*/</span>
<a name="l00906"></a><a class="code" href="classengine.html#ab244f803ac3edc7ec1341e9b9a11ca33">00906</a> <span class="keywordtype">void</span> <a class="code" href="classengine.html#ab244f803ac3edc7ec1341e9b9a11ca33">engine::receivedData</a>(<a class="code" href="struct_mail_box_event.html">MailBoxEvent</a> *event,<a class="code" href="struct_memory_item.html">MemoryItem</a> *mi){
<a name="l00907"></a>00907   <span class="keywordtype">int</span> offset =0 ;
<a name="l00908"></a>00908   <span class="keyword">const</span> <span class="keywordtype">bool</span> header_only = <span class="keyword">true</span>;
<a name="l00909"></a>00909   <span class="keyword">const</span> <span class="keywordtype">bool</span> all_content = <span class="keyword">false</span>;
<a name="l00910"></a>00910   <a class="code" href="struct_data_handle.html">DataHandle</a> dh;
<a name="l00911"></a>00911   dh.<a class="code" href="struct_data_handle.html#a4abd5569c8a2cb0ff6fdca749765aa70">deserialize</a>(event-&gt;<a class="code" href="struct_mail_box_event.html#af985444da7a2549b64fe4bacc1a68ab1">buffer</a>,offset,event-&gt;<a class="code" href="struct_mail_box_event.html#a70601308260beb76601c24e5cf49c866">length</a>);
<a name="l00912"></a>00912   <a class="code" href="basic_8hpp.html#a18b7a861548515d01c332e31c026dfa2">flushBuffer</a>(event-&gt;<a class="code" href="struct_mail_box_event.html#af985444da7a2549b64fe4bacc1a68ab1">buffer</a>,event-&gt;<a class="code" href="struct_mail_box_event.html#a70601308260beb76601c24e5cf49c866">length</a>);
<a name="l00913"></a>00913   printf(<span class="stringliteral">&quot;dh:%ld\n&quot;</span>,dh.<a class="code" href="struct_data_handle.html#a8ef23cf8adc3b32ae4977de4537c673c">data_handle</a>);
<a name="l00914"></a>00914   <a class="code" href="class_i_data.html">IData</a> *data = glbCtx.<a class="code" href="class_global_context.html#a82ec626cc456bb864bf2376e2bda621f">getDataByHandle</a>(&amp;dh);
<a name="l00915"></a>00915   offset =0 ;
<a name="l00916"></a>00916   printf(<span class="stringliteral">&quot;data rcvd:%s,cnt:%p\n&quot;</span>,data-&gt;<a class="code" href="class_i_data.html#a87b7baa5c42fd4c2b36875141030880d">getName</a>().c_str(),data-&gt;<a class="code" href="class_i_data.html#a513a1ad05e427af81ca7c34291826efb">getContentAddress</a>());
<a name="l00917"></a>00917   data-&gt;<a class="code" href="class_i_data.html#a1ab1fff22b5ba4cd4fb93cd09007dda6">deserialize</a>(event-&gt;<a class="code" href="struct_mail_box_event.html#af985444da7a2549b64fe4bacc1a68ab1">buffer</a>,offset,event-&gt;<a class="code" href="struct_mail_box_event.html#a70601308260beb76601c24e5cf49c866">length</a>,mi,all_content);
<a name="l00918"></a>00918   printf(<span class="stringliteral">&quot;data rcvd:%s,cnt:%p\n&quot;</span>,data-&gt;<a class="code" href="class_i_data.html#a87b7baa5c42fd4c2b36875141030880d">getName</a>().c_str(),data-&gt;<a class="code" href="class_i_data.html#a513a1ad05e427af81ca7c34291826efb">getContentAddress</a>());
<a name="l00919"></a>00919   data-&gt;<a class="code" href="class_i_data.html#aae35cd74cf8b062a958959d606d73f29">dump</a>(<span class="charliteral">&apos;z&apos;</span>);
<a name="l00920"></a>00920   putWorkForSingleDataReady(data);
<a name="l00921"></a>00921   <a class="code" href="dt__log_8hpp.html#a2281e9cbd72942f0be829c845609e1c6">dt_log</a>.<a class="code" href="class_ductteip_log.html#a2038f71b600647a1899da3a0022f9fc1">addEvent</a>(data,<a class="code" href="class_ductteip_log.html#a2d4f772da028bd358802f7cbe58c981ba4272a2344431db84d4b69d7d1298ccbe">DuctteipLog::DataReceived</a>);
<a name="l00922"></a>00922 }
<a name="l00923"></a>00923 <span class="comment">/*--------------------------------------------------------------------------*/</span>
<a name="l00924"></a><a class="code" href="classengine.html#af65fff57c4729b10421eaa064a254d64">00924</a> <a class="code" href="class_i_data.html">IData</a> * <a class="code" href="classengine.html#af65fff57c4729b10421eaa064a254d64">engine::importedData</a>(<a class="code" href="struct_mail_box_event.html">MailBoxEvent</a> *event,<a class="code" href="struct_memory_item.html">MemoryItem</a> *mi){
<a name="l00925"></a>00925   <span class="keywordtype">int</span> offset =0 ;
<a name="l00926"></a>00926   <span class="keyword">const</span> <span class="keywordtype">bool</span> header_only = <span class="keyword">true</span>;
<a name="l00927"></a>00927   <span class="keyword">const</span> <span class="keywordtype">bool</span> all_content = <span class="keyword">false</span>;
<a name="l00928"></a>00928   <a class="code" href="struct_data_handle.html">DataHandle</a> dh;
<a name="l00929"></a>00929 
<a name="l00930"></a>00930   <span class="keywordflow">if</span> (1){
<a name="l00931"></a>00931     <span class="keywordtype">double</span> sum = 0.0,*contents=(<span class="keywordtype">double</span> *)(event-&gt;<a class="code" href="struct_mail_box_event.html#af985444da7a2549b64fe4bacc1a68ab1">buffer</a>+192);
<a name="l00932"></a>00932     <span class="keywordtype">long</span> size = (<span class="keyword">event</span>-&gt;length -192)/<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>);
<a name="l00933"></a>00933     <span class="keywordflow">for</span> ( <span class="keywordtype">long</span> i=0; i&lt; size; i++)
<a name="l00934"></a>00934       sum += contents[i];
<a name="l00935"></a>00935     printf(<span class="stringliteral">&quot;+++sum i , -----,%lf adr:%p,%p,%p\n&quot;</span>,
<a name="l00936"></a>00936        sum,contents,event-&gt;<a class="code" href="struct_mail_box_event.html#a7c43c5a6b7311a0d9a69964d28a07eb2">memory</a>-&gt;<a class="code" href="struct_memory_item.html#a8e5271126c1eb7d5d5b0d611149b67cf">getAddress</a>(),<span class="keyword">event</span>-&gt;buffer);
<a name="l00937"></a>00937   }
<a name="l00938"></a>00938 
<a name="l00939"></a>00939   dh.<a class="code" href="struct_data_handle.html#a4abd5569c8a2cb0ff6fdca749765aa70">deserialize</a>(event-&gt;<a class="code" href="struct_mail_box_event.html#af985444da7a2549b64fe4bacc1a68ab1">buffer</a>,offset,event-&gt;<a class="code" href="struct_mail_box_event.html#a70601308260beb76601c24e5cf49c866">length</a>);
<a name="l00940"></a>00940   <a class="code" href="class_i_data.html">IData</a> *data = glbCtx.<a class="code" href="class_global_context.html#a82ec626cc456bb864bf2376e2bda621f">getDataByHandle</a>(&amp;dh);
<a name="l00941"></a>00941   <span class="keywordtype">void</span> <a class="code" href="chol__fact_8hpp.html#a99e337898d117753a84ee5afdb796d50">dumpData</a>(<span class="keywordtype">double</span> *, <span class="keywordtype">int</span> ,<span class="keywordtype">int</span>, <span class="keywordtype">char</span>);
<a name="l00942"></a>00942   <span class="keywordflow">if</span> (1){
<a name="l00943"></a>00943     <span class="keywordtype">double</span> sum = 0.0,*contents=(<span class="keywordtype">double</span> *)(event-&gt;<a class="code" href="struct_mail_box_event.html#af985444da7a2549b64fe4bacc1a68ab1">buffer</a>+192);
<a name="l00944"></a>00944     <span class="keywordtype">long</span> size = (<span class="keyword">event</span>-&gt;length -192)/<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>);
<a name="l00945"></a>00945     <span class="keywordflow">for</span> ( <span class="keywordtype">long</span> i=0; i&lt; size; i++)
<a name="l00946"></a>00946       sum += contents[i];
<a name="l00947"></a>00947     printf(<span class="stringliteral">&quot;+++sum i , -----,%lf adr:%p,%p,%p\n&quot;</span>,
<a name="l00948"></a>00948        sum,contents,event-&gt;<a class="code" href="struct_mail_box_event.html#a7c43c5a6b7311a0d9a69964d28a07eb2">memory</a>-&gt;<a class="code" href="struct_memory_item.html#a8e5271126c1eb7d5d5b0d611149b67cf">getAddress</a>(),<span class="keyword">event</span>-&gt;buffer);
<a name="l00949"></a>00949   }
<a name="l00950"></a>00950 
<a name="l00951"></a>00951     <span class="keywordflow">if</span> ( 0 ) {
<a name="l00952"></a>00952       printf(<span class="stringliteral">&quot;Buffer:%p Header size:%d\n&quot;</span>,event-&gt;<a class="code" href="struct_mail_box_event.html#af985444da7a2549b64fe4bacc1a68ab1">buffer</a>,data-&gt;<a class="code" href="class_i_data.html#acf62b5fb26cf38c5a0b1480f8a548664">getHeaderSize</a>());
<a name="l00953"></a>00953       <span class="keywordtype">double</span> *<a class="code" href="chol__fact_8hpp.html#a42b2ebd385e21f96a9663ad9f6c5e481">A</a>=(<span class="keywordtype">double</span> *)(event-&gt;<a class="code" href="struct_mail_box_event.html#af985444da7a2549b64fe4bacc1a68ab1">buffer</a>+data-&gt;<a class="code" href="class_i_data.html#acf62b5fb26cf38c5a0b1480f8a548664">getHeaderSize</a>());
<a name="l00954"></a>00954       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0;i&lt;5;i++)
<a name="l00955"></a>00955     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;5;j++){
<a name="l00956"></a>00956       <a class="code" href="chol__fact_8hpp.html#a99e337898d117753a84ee5afdb796d50">dumpData</a>(A+i*12*12+j*5*12*12,12,12,<span class="charliteral">&apos;I&apos;</span>);
<a name="l00957"></a>00957     }
<a name="l00958"></a>00958     }
<a name="l00959"></a>00959     printf(<span class="stringliteral">&quot;ev.mem dump:\n   &quot;</span>);
<a name="l00960"></a>00960     <span class="keyword">event</span>-&gt;memory-&gt;dump();
<a name="l00961"></a>00961     printf(<span class="stringliteral">&quot;data-before.mem dump:\n   &quot;</span>);
<a name="l00962"></a>00962     mi = data-&gt;<a class="code" href="class_i_data.html#a1fa868533294d82de9491e5ee179dc2e">getDataMemory</a>();
<a name="l00963"></a>00963     <span class="keywordflow">if</span> ( mi != NULL ) {
<a name="l00964"></a>00964       mi-&gt;<a class="code" href="struct_memory_item.html#aa6bd06b9d84d23905f34c40759e0dcba">dump</a>();
<a name="l00965"></a>00965       memcpy(data-&gt;<a class="code" href="class_i_data.html#a513a1ad05e427af81ca7c34291826efb">getContentAddress</a>(),<span class="keyword">event</span>-&gt;buffer+data-&gt;<a class="code" href="class_i_data.html#acf62b5fb26cf38c5a0b1480f8a548664">getHeaderSize</a>(),data-&gt;<a class="code" href="class_i_data.html#a32479396ae443e9e80f6517fd1e20f35">getContentSize</a>());
<a name="l00966"></a>00966     }
<a name="l00967"></a>00967     <span class="keywordflow">else</span>{
<a name="l00968"></a>00968       printf(<span class="stringliteral">&quot;NULL\n&quot;</span>);
<a name="l00969"></a>00969       data-&gt;<a class="code" href="class_i_data.html#a6a6c0f1bebc3a8c52cdd858e29a965f6">setDataMemory</a>(event-&gt;<a class="code" href="struct_mail_box_event.html#a7c43c5a6b7311a0d9a69964d28a07eb2">memory</a>);
<a name="l00970"></a>00970       data-&gt;<a class="code" href="class_i_data.html#a640ef011d2cef11627d21ad5b6ab2cdb">setContentSize</a>(event-&gt;<a class="code" href="struct_mail_box_event.html#a70601308260beb76601c24e5cf49c866">length</a>-data-&gt;<a class="code" href="class_i_data.html#acf62b5fb26cf38c5a0b1480f8a548664">getHeaderSize</a>());
<a name="l00971"></a>00971       mi = data-&gt;<a class="code" href="class_i_data.html#a1fa868533294d82de9491e5ee179dc2e">getDataMemory</a>();
<a name="l00972"></a>00972       data-&gt;<a class="code" href="class_i_data.html#a6249481688df51d60d6e6dbf68fb69f2">prepareMemory</a>();
<a name="l00973"></a>00973     }
<a name="l00974"></a>00974     <span class="keywordflow">if</span> (1 ) {
<a name="l00975"></a>00975       <a class="code" href="struct_memory_item.html">MemoryItem</a> *mi2 = data-&gt;<a class="code" href="class_i_data.html#a1fa868533294d82de9491e5ee179dc2e">getDataMemory</a>();
<a name="l00976"></a>00976       printf(<span class="stringliteral">&quot;data-after.mem dump:\n   &quot;</span>);
<a name="l00977"></a>00977       mi2-&gt;<a class="code" href="struct_memory_item.html#aa6bd06b9d84d23905f34c40759e0dcba">dump</a>();
<a name="l00978"></a>00978     }
<a name="l00979"></a>00979   <span class="keywordflow">if</span> ( mi == NULL) {
<a name="l00980"></a>00980     printf(<span class="stringliteral">&quot;preparememory.///////////////////////////////////////////////// \n&quot;</span>);
<a name="l00981"></a>00981     data-&gt;<a class="code" href="class_i_data.html#a6249481688df51d60d6e6dbf68fb69f2">prepareMemory</a>();
<a name="l00982"></a>00982   }
<a name="l00983"></a>00983   <span class="keywordflow">if</span>(1)printf(<span class="stringliteral">&quot;imported data %s, mem:%p len:%d size:%d sz2:%d\n&quot;</span>,data-&gt;<a class="code" href="class_i_data.html#a87b7baa5c42fd4c2b36875141030880d">getName</a>().c_str(),
<a name="l00984"></a>00984      data-&gt;<a class="code" href="class_i_data.html#a513a1ad05e427af81ca7c34291826efb">getContentAddress</a>(),<span class="keyword">event</span>-&gt;length,
<a name="l00985"></a>00985      data-&gt;<a class="code" href="class_i_data.html#a32479396ae443e9e80f6517fd1e20f35">getContentSize</a>(),<span class="keyword">event</span>-&gt;length-data-&gt;<a class="code" href="class_i_data.html#acf62b5fb26cf38c5a0b1480f8a548664">getHeaderSize</a>());
<a name="l00986"></a>00986 
<a name="l00987"></a>00987   offset=0;
<a name="l00988"></a>00988   data-&gt;<a class="code" href="class_i_data.html#a1ab1fff22b5ba4cd4fb93cd09007dda6">deserialize</a>(event-&gt;<a class="code" href="struct_mail_box_event.html#af985444da7a2549b64fe4bacc1a68ab1">buffer</a>,offset,event-&gt;<a class="code" href="struct_mail_box_event.html#a70601308260beb76601c24e5cf49c866">length</a>,mi,header_only);
<a name="l00989"></a>00989   <span class="keywordflow">if</span>(0)printf(<span class="stringliteral">&quot;Data is imported:\n&quot;</span>);data-&gt;<a class="code" href="class_i_data.html#aae35cd74cf8b062a958959d606d73f29">dump</a>(<span class="charliteral">&apos;N&apos;</span>);
<a name="l00990"></a>00990   <a class="code" href="dt__log_8hpp.html#a2281e9cbd72942f0be829c845609e1c6">dt_log</a>.<a class="code" href="class_ductteip_log.html#a2038f71b600647a1899da3a0022f9fc1">addEvent</a>(data,<a class="code" href="class_ductteip_log.html#a2d4f772da028bd358802f7cbe58c981babe0cb11768268430fd6f1e82116ecc5f">DuctteipLog::DataImported</a>);
<a name="l00991"></a>00991   <span class="keywordflow">return</span> data;
<a name="l00992"></a>00992 }
<a name="l00993"></a>00993 <span class="comment">/*--------------------------------------------------------------------------*/</span>
<a name="l00994"></a><a class="code" href="class_i_listener.html#a092fa85ce870bd169930cffce12bc87b">00994</a> <span class="keywordtype">void</span> <a class="code" href="class_i_listener.html#a092fa85ce870bd169930cffce12bc87b">IListener::checkAndSendData</a>(<a class="code" href="class_mail_box.html">MailBox</a> * mailbox)
<a name="l00995"></a>00995 {
<a name="l00996"></a>00996   <span class="keywordflow">if</span> ( !<a class="code" href="class_i_listener.html#aef5dea3b4b1ca6d3b14b3f5340514c0a">isReceived</a>() ) {
<a name="l00997"></a>00997     <span class="keywordflow">return</span>;
<a name="l00998"></a>00998   }
<a name="l00999"></a>00999   <span class="keywordflow">if</span> ( <a class="code" href="class_i_listener.html#af0cb8b56c305486c399dc60427864ef4">isDataSent</a>() ) 
<a name="l01000"></a>01000     {
<a name="l01001"></a>01001       <span class="keywordflow">return</span>;
<a name="l01002"></a>01002     }
<a name="l01003"></a>01003   <span class="keywordflow">if</span> (! <a class="code" href="class_i_listener.html#a2a9973fb9b26f21ee034d4ba0349e541">isDataReady</a>() ) {
<a name="l01004"></a>01004     <span class="keywordflow">return</span>;
<a name="l01005"></a>01005   }
<a name="l01006"></a>01006   <a class="code" href="class_i_data.html">IData</a> *data = <a class="code" href="class_i_listener.html#a26d2796b0c0f2fb59203140ddb0ee468">getData</a>();
<a name="l01007"></a>01007   <span class="keywordflow">if</span> ( data-&gt;<a class="code" href="class_i_data.html#a37f03e8f2b04b4f54c6b5768f52c0845">isDataSent</a>(<a class="code" href="class_i_listener.html#a52a8aa5ce8929ad9eae2a7c9c7cce9ba">getSource</a>(), <a class="code" href="class_i_listener.html#aee2a0174f44139725e4e19fdc3c4d94e">getRequiredVersion</a>() ) ){
<a name="l01008"></a>01008     <a class="code" href="class_i_listener.html#a54c8d2e23951e95dbb6eae79b6c9d975">setDataSent</a>(<span class="keyword">true</span>);
<a name="l01009"></a>01009     <span class="keywordflow">return</span>;
<a name="l01010"></a>01010   }
<a name="l01011"></a>01011   data-&gt;<a class="code" href="class_i_data.html#ac463fd8cadcd1d6ecd5955c25dbe9176">serialize</a>();
<a name="l01012"></a>01012   printf(<span class="stringliteral">&quot;@data sent %s dh:%ld\n&quot;</span>,data-&gt;<a class="code" href="class_i_data.html#a87b7baa5c42fd4c2b36875141030880d">getName</a>().c_str(),data-&gt;<a class="code" href="class_i_data.html#af0448989fa9d551acfb8ead2523a32e5">getDataHandleID</a>());
<a name="l01013"></a>01013   <a class="code" href="basic_8hpp.html#a18b7a861548515d01c332e31c026dfa2">flushBuffer</a>(data-&gt;<a class="code" href="class_i_data.html#aa47c48488508421dfab3f8b2c226401e">getHeaderAddress</a>(),data-&gt;<a class="code" href="class_i_data.html#a98eb397df8b3cd27711801cb4c9e14ed">getPackSize</a>());
<a name="l01014"></a>01014   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> c_handle= mailbox-&gt;<a class="code" href="class_mail_box.html#ae6b86c4b322220e0a416dadec6e50877">send</a>(data-&gt;<a class="code" href="class_i_data.html#aa47c48488508421dfab3f8b2c226401e">getHeaderAddress</a>(),
<a name="l01015"></a>01015                     data-&gt;<a class="code" href="class_i_data.html#a98eb397df8b3cd27711801cb4c9e14ed">getPackSize</a>(),
<a name="l01016"></a>01016                     <a class="code" href="class_mail_box.html#a3699f2a3318218702288ec9fb7f8e38fa008868e6b3029ad80db19a0cc4ab48c9">MailBox::DataTag</a>+data-&gt;<a class="code" href="class_i_data.html#af0448989fa9d551acfb8ead2523a32e5">getDataHandleID</a>(),
<a name="l01017"></a>01017                     <a class="code" href="class_i_listener.html#a52a8aa5ce8929ad9eae2a7c9c7cce9ba">getSource</a>());
<a name="l01018"></a>01018 
<a name="l01019"></a>01019   <a class="code" href="dt__log_8hpp.html#a2281e9cbd72942f0be829c845609e1c6">dt_log</a>.<a class="code" href="class_ductteip_log.html#a2038f71b600647a1899da3a0022f9fc1">addEvent</a>(<span class="keyword">this</span>,<a class="code" href="class_ductteip_log.html#a2d4f772da028bd358802f7cbe58c981bae074c319c430a4780c2bac06b825dfc8">DuctteipLog::Woken</a>);
<a name="l01020"></a>01020   <a class="code" href="dt__log_8hpp.html#a2281e9cbd72942f0be829c845609e1c6">dt_log</a>.<a class="code" href="class_ductteip_log.html#a2038f71b600647a1899da3a0022f9fc1">addEvent</a>(data,<a class="code" href="class_ductteip_log.html#a2d4f772da028bd358802f7cbe58c981ba28e45255007b63e9d2ae72a2175f8241">DuctteipLog::DataSent</a>,<a class="code" href="class_i_listener.html#a52a8aa5ce8929ad9eae2a7c9c7cce9ba">getSource</a>());
<a name="l01021"></a>01021   <a class="code" href="class_i_listener.html#a808fd91db5dba945320316a8b6c99dca">setCommHandle</a>(c_handle);
<a name="l01022"></a>01022   <a class="code" href="class_i_listener.html#a54c8d2e23951e95dbb6eae79b6c9d975">setDataSent</a>(<span class="keyword">true</span>);
<a name="l01023"></a>01023   <span class="keywordflow">if</span>(1)printf(<span class="stringliteral">&quot;data sent:%s\n&quot;</span>,data-&gt;<a class="code" href="class_i_data.html#a87b7baa5c42fd4c2b36875141030880d">getName</a>().c_str());
<a name="l01024"></a>01024   <a class="code" href="class_i_listener.html#ae53c9b5bd1067445dd09804efd04ea5c">dump</a>();
<a name="l01025"></a>01025   data-&gt;<a class="code" href="class_i_data.html#aae35cd74cf8b062a958959d606d73f29">dump</a>(<span class="charliteral">&apos;z&apos;</span>);
<a name="l01026"></a>01026 
<a name="l01027"></a>01027 
<a name="l01028"></a>01028 }
<a name="l01029"></a>01029 <span class="comment">/*--------------------------------------------------------------------------*/</span>
<a name="l01030"></a>01030 <span class="keyword">template</span> &lt;<span class="keyword">class</span> ElementType&gt;
<a name="l01031"></a>01031 <a class="code" href="class_partition.html">Partition&lt;ElementType&gt;</a> *
<a name="l01032"></a><a class="code" href="class_partition.html#ac675bc154e0d7fb01bf9db46196165ba">01032</a> <a class="code" href="class_partition.html#ac675bc154e0d7fb01bf9db46196165ba">Partition&lt;ElementType&gt;::getBlock</a> ( <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> x ) {
<a name="l01033"></a>01033 
<a name="l01034"></a>01034   <a class="code" href="class_partition.html">Partition&lt;ElementType&gt;</a> *p = <span class="keyword">new</span> <a class="code" href="class_partition.html">Partition&lt;ElementType&gt;</a> (dim_count, element_alignment) ; 
<a name="l01035"></a>01035   p-&gt;block_alignment = block_alignment ;
<a name="l01036"></a>01036   p-&gt;mem_size = mem_size;
<a name="l01037"></a>01037   p-&gt;<a class="code" href="class_partition.html#a74faab4721aa4fa4c17a23c2c7589a1a">X_E</a>()  = <a class="code" href="class_partition.html#aae132939e5651020e0801bec2009d300">X_EB</a>();
<a name="l01038"></a>01038   p-&gt;<a class="code" href="class_partition.html#a3721344cfda08fbf4f0ee806082d0ac3">Y_E</a>()  = <a class="code" href="class_partition.html#a017cfca75cb8141fb3502d5a90a5e567">Y_EB</a>();
<a name="l01039"></a>01039 
<a name="l01040"></a>01040   p-&gt;<a class="code" href="class_partition.html#ae9748490144ee2cbf5ca2e2fdb355f64">X_B</a>()  = 1; 
<a name="l01041"></a>01041   p-&gt;<a class="code" href="class_partition.html#a99642b7ce0d0385ccbaa821918e816f0">Y_B</a>()  = 1; 
<a name="l01042"></a>01042 
<a name="l01043"></a>01043   p-&gt;<a class="code" href="class_partition.html#ad122861c613d170ffb610194b4bb3850">Y_BS</a>() = 0; 
<a name="l01044"></a>01044   p-&gt;<a class="code" href="class_partition.html#a439ac208be8dbee772f9fe167a95581b">X_BS</a>() = 0; 
<a name="l01045"></a>01045 
<a name="l01046"></a>01046   p-&gt;<a class="code" href="class_partition.html#aae132939e5651020e0801bec2009d300">X_EB</a>() = p-&gt;<a class="code" href="class_partition.html#a74faab4721aa4fa4c17a23c2c7589a1a">X_E</a>() / p-&gt;<a class="code" href="class_partition.html#ae9748490144ee2cbf5ca2e2fdb355f64">X_B</a>(); 
<a name="l01047"></a>01047   p-&gt;<a class="code" href="class_partition.html#a017cfca75cb8141fb3502d5a90a5e567">Y_EB</a>() = p-&gt;<a class="code" href="class_partition.html#a3721344cfda08fbf4f0ee806082d0ac3">Y_E</a>() / p-&gt;<a class="code" href="class_partition.html#a99642b7ce0d0385ccbaa821918e816f0">Y_B</a>(); 
<a name="l01048"></a>01048 
<a name="l01049"></a>01049   <span class="keywordflow">if</span> ( element_alignment == ROW_MAJOR ) {
<a name="l01050"></a>01050     p-&gt;<a class="code" href="class_partition.html#a8d2849bb3bbea837ceca021ce9d6257a">X_ES</a>() = 1;
<a name="l01051"></a>01051     p-&gt;<a class="code" href="class_partition.html#a618a4ee9a5432087b30e2e6ef4d951ce">Y_ES</a>() = <a class="code" href="class_partition.html#aae132939e5651020e0801bec2009d300">X_EB</a>();
<a name="l01052"></a>01052   }
<a name="l01053"></a>01053   <span class="keywordflow">else</span>{
<a name="l01054"></a>01054     p-&gt;<a class="code" href="class_partition.html#a8d2849bb3bbea837ceca021ce9d6257a">X_ES</a>() = <a class="code" href="class_partition.html#a017cfca75cb8141fb3502d5a90a5e567">Y_EB</a>();
<a name="l01055"></a>01055     p-&gt;<a class="code" href="class_partition.html#a618a4ee9a5432087b30e2e6ef4d951ce">Y_ES</a>() = 1     ;
<a name="l01056"></a>01056   }
<a name="l01057"></a>01057   <span class="keywordflow">if</span> ( block_alignment  == ROW_MAJOR ) {
<a name="l01058"></a>01058     p-&gt;memory = memory + (y * <a class="code" href="class_partition.html#ae9748490144ee2cbf5ca2e2fdb355f64">X_B</a>() + x )* <a class="code" href="class_partition.html#a017cfca75cb8141fb3502d5a90a5e567">Y_EB</a>() * <a class="code" href="class_partition.html#aae132939e5651020e0801bec2009d300">X_EB</a>() ;
<a name="l01059"></a>01059   }
<a name="l01060"></a>01060   <span class="keywordflow">else</span> { 
<a name="l01061"></a>01061     p-&gt;memory = memory + (x * <a class="code" href="class_partition.html#a99642b7ce0d0385ccbaa821918e816f0">Y_B</a>() + y )* <a class="code" href="class_partition.html#a017cfca75cb8141fb3502d5a90a5e567">Y_EB</a>() * <a class="code" href="class_partition.html#aae132939e5651020e0801bec2009d300">X_EB</a>() ;
<a name="l01062"></a>01062   }
<a name="l01063"></a>01063   <span class="keywordflow">if</span>(0)printf(<span class="stringliteral">&quot;yeb %d e %d b %d\n&quot;</span>,p-&gt;<a class="code" href="class_partition.html#a017cfca75cb8141fb3502d5a90a5e567">Y_EB</a>(),p-&gt;<a class="code" href="class_partition.html#a3721344cfda08fbf4f0ee806082d0ac3">Y_E</a>(),p-&gt;<a class="code" href="class_partition.html#a99642b7ce0d0385ccbaa821918e816f0">Y_B</a>());
<a name="l01064"></a>01064   <span class="keywordflow">return</span> p;
<a name="l01065"></a>01065 } 
<a name="l01066"></a>01066 <span class="comment">/*----------------------------------------------------------------------------------------*/</span>
<a name="l01067"></a><a class="code" href="class_i_data.html#aa3f5c7ae906943db0780856ba3d53a33">01067</a> <span class="keywordtype">void</span> <a class="code" href="class_i_data.html#aa3f5c7ae906943db0780856ba3d53a33">IData:: allocateMemory</a>(){
<a name="l01068"></a>01068   <span class="keywordflow">if</span> ( <a class="code" href="class_i_data.html#a170ac177a6048467713780cd3605e88e">Nb</a> == 0 &amp;&amp; <a class="code" href="class_i_data.html#a68696027e7617a3480fd0ae0a70df7fc">Mb</a> == 0 ) {      
<a name="l01069"></a>01069     
<a name="l01070"></a>01070     <a class="code" href="class_i_data.html#a15b74bcf67e36b559c1fdbf5192206b8">content_size</a> = (<a class="code" href="class_i_data.html#ae61dc22b2bb9c233eb93d891af16d220">N</a>/<a class="code" href="class_i_data.html#a4815f73848733b3ff225821b3d7431ea">parent_data</a>-&gt;<a class="code" href="class_i_data.html#a170ac177a6048467713780cd3605e88e">Nb</a>) * (<a class="code" href="class_i_data.html#aebf70e773a06212897c33d7512f9d344">M</a>/<a class="code" href="class_i_data.html#a4815f73848733b3ff225821b3d7431ea">parent_data</a>-&gt;<a class="code" href="class_i_data.html#a68696027e7617a3480fd0ae0a70df7fc">Mb</a>) * <span class="keyword">sizeof</span>(double);
<a name="l01071"></a>01071     <span class="keywordflow">if</span> (<a class="code" href="context_8hpp.html#a3fc7ce4e53beaaf18198c05f97845d4b">simulation</a>)
<a name="l01072"></a>01072       <a class="code" href="class_i_data.html#a15b74bcf67e36b559c1fdbf5192206b8">content_size</a>=1;
<a name="l01073"></a>01073     <a class="code" href="class_i_data.html#aabd7b42672ec3479c2e6a77fac395789">data_memory</a> = dtEngine.<a class="code" href="classengine.html#a99ae6156ee65044d03d61a3776ef2f99">newDataMemory</a>();
<a name="l01074"></a>01074 
<a name="l01075"></a>01075     <a class="code" href="basic_8hpp.html#a01d4c8834420566804f361060f144094">PRINT_IF</a>(1)(<span class="stringliteral">&quot;@DataMemory %s block size calc: N:%d,pNb:%d,M:%d,pMb:%d,memory:%p\n&quot;</span>,
<a name="l01076"></a>01076         <a class="code" href="class_i_data.html#a87b7baa5c42fd4c2b36875141030880d">getName</a>().c_str(),<a class="code" href="class_i_data.html#ae61dc22b2bb9c233eb93d891af16d220">N</a>,<a class="code" href="class_i_data.html#a4815f73848733b3ff225821b3d7431ea">parent_data</a>-&gt;<a class="code" href="class_i_data.html#a170ac177a6048467713780cd3605e88e">Nb</a>,<a class="code" href="class_i_data.html#aebf70e773a06212897c33d7512f9d344">M</a>,<a class="code" href="class_i_data.html#a4815f73848733b3ff225821b3d7431ea">parent_data</a>-&gt;<a class="code" href="class_i_data.html#a68696027e7617a3480fd0ae0a70df7fc">Mb</a>,<a class="code" href="class_i_data.html#a513a1ad05e427af81ca7c34291826efb">getContentAddress</a>() );
<a name="l01077"></a>01077   }
<a name="l01078"></a>01078 }
<a name="l01079"></a>01079 <span class="comment">/*----------------------------------------------------------------------------------------*/</span>
<a name="l01080"></a><a class="code" href="context_8hpp.html#a2a1d2ca63db326792cd81d98cb2f2522">01080</a> <span class="preprocessor">#define DATA_LISTENER 0</span>
<a name="l01081"></a><a class="code" href="class_i_data.html#a37f03e8f2b04b4f54c6b5768f52c0845">01081</a> <span class="preprocessor"></span><span class="keywordtype">bool</span> <a class="code" href="class_i_data.html#a37f03e8f2b04b4f54c6b5768f52c0845">IData::isDataSent</a>(<span class="keywordtype">int</span> _host , <a class="code" href="struct_data_version.html">DataVersion</a> <a class="code" href="context_8hpp.html#aad880fc4455c253781e8968f2239d56f">version</a>){
<a name="l01082"></a>01082   list&lt;DataListener *&gt;::iterator it;
<a name="l01083"></a>01083   <span class="keywordflow">for</span> (it = <a class="code" href="class_i_data.html#aa7d44f5d83938ee056221867600fd7db">listeners</a>.begin();it != <a class="code" href="class_i_data.html#aa7d44f5d83938ee056221867600fd7db">listeners</a>.end();it ++){
<a name="l01084"></a>01084     <a class="code" href="class_i_listener.html">DataListener</a> *lsnr = (*it);
<a name="l01085"></a>01085     <span class="keywordflow">if</span> (lsnr-&gt;<a class="code" href="class_i_listener.html#a92be46f2fb958f6b52564e837d5fca98">getHost</a>() == _host &amp;&amp; lsnr-&gt;<a class="code" href="class_i_listener.html#aee2a0174f44139725e4e19fdc3c4d94e">getRequiredVersion</a>() == version){
<a name="l01086"></a>01086       <a class="code" href="basic_8hpp.html#a01d4c8834420566804f361060f144094">PRINT_IF</a>(<a class="code" href="context_8hpp.html#a2a1d2ca63db326792cd81d98cb2f2522">DATA_LISTENER</a>)(<span class="stringliteral">&quot;DLsnr data:%s for host:%d is sent?:%d\n&quot;</span>,<a class="code" href="class_i_data.html#a66ed7cf77dc3382dfd6fcd81dc18e8df">name</a>.c_str(),_host , lsnr-&gt;<a class="code" href="class_i_listener.html#af0cb8b56c305486c399dc60427864ef4">isDataSent</a>());
<a name="l01087"></a>01087       version.<a class="code" href="struct_data_version.html#a03b5b85b2c309989eb96c2248b0dedfa">dump</a>();
<a name="l01088"></a>01088       <span class="keywordflow">return</span>  lsnr-&gt;<a class="code" href="class_i_listener.html#af0cb8b56c305486c399dc60427864ef4">isDataSent</a>();
<a name="l01089"></a>01089     }
<a name="l01090"></a>01090   }
<a name="l01091"></a>01091   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01092"></a>01092 }
<a name="l01093"></a>01093 <span class="comment">/*--------------------------------------------------------------------------*/</span>
<a name="l01094"></a><a class="code" href="class_i_data.html#ac1422d1f14938dc89f4fabd7fdc90e9a">01094</a> <span class="keywordtype">void</span> <a class="code" href="class_i_data.html#ac1422d1f14938dc89f4fabd7fdc90e9a">IData::dataIsSent</a>(<span class="keywordtype">int</span> _host) {
<a name="l01095"></a>01095   list&lt;DataListener *&gt;::iterator it;
<a name="l01096"></a>01096 
<a name="l01097"></a>01097   <a class="code" href="basic_8hpp.html#a01d4c8834420566804f361060f144094">PRINT_IF</a>(<a class="code" href="context_8hpp.html#a2a1d2ca63db326792cd81d98cb2f2522">DATA_LISTENER</a>)(<span class="stringliteral">&quot;Data:%s,DLsnr sent to host:%d,cur ver:\n&quot;</span>,<a class="code" href="class_i_data.html#a66ed7cf77dc3382dfd6fcd81dc18e8df">name</a>.c_str(),_host);
<a name="l01098"></a>01098   <a class="code" href="class_i_data.html#a633fad3f15a6898694a85dd74c94d89a">rt_write_version</a>.<a class="code" href="struct_data_version.html#a03b5b85b2c309989eb96c2248b0dedfa">dump</a>();
<a name="l01099"></a>01099   <span class="keywordflow">for</span> (it = <a class="code" href="class_i_data.html#aa7d44f5d83938ee056221867600fd7db">listeners</a>.begin();it != <a class="code" href="class_i_data.html#aa7d44f5d83938ee056221867600fd7db">listeners</a>.end();it ++){
<a name="l01100"></a>01100     <a class="code" href="class_i_listener.html">DataListener</a> *lsnr = (*it);
<a name="l01101"></a>01101     <span class="keywordflow">if</span> (lsnr-&gt;<a class="code" href="class_i_listener.html#a92be46f2fb958f6b52564e837d5fca98">getHost</a>() == _host &amp;&amp; lsnr-&gt;<a class="code" href="class_i_listener.html#aee2a0174f44139725e4e19fdc3c4d94e">getRequiredVersion</a>() == <a class="code" href="class_i_data.html#a633fad3f15a6898694a85dd74c94d89a">rt_write_version</a>){
<a name="l01102"></a>01102       <a class="code" href="basic_8hpp.html#a01d4c8834420566804f361060f144094">PRINT_IF</a>(<a class="code" href="context_8hpp.html#a2a1d2ca63db326792cd81d98cb2f2522">DATA_LISTENER</a>)(<span class="stringliteral">&quot;DLsnr rt_read_version before upgrade:\n&quot;</span>);
<a name="l01103"></a>01103       <a class="code" href="class_i_data.html#a62fa408732cc79c91cc5af22ff52f5bd">rt_read_version</a>.<a class="code" href="struct_data_version.html#a03b5b85b2c309989eb96c2248b0dedfa">dump</a>();
<a name="l01104"></a>01104       <a class="code" href="class_i_data.html#af2d4e7dff291b828c12a41728ed74d4e">incrementRunTimeVersion</a>(<a class="code" href="class_i_data.html#a771c62d4a9d89ea755b61734fb41e372ab0001574263456e6fbf9b4355353484c">READ</a>,lsnr-&gt;<a class="code" href="class_i_listener.html#a3ccdeeabec88b3f0532aa2ced78797e8">getCount</a>());
<a name="l01105"></a>01105       <a class="code" href="basic_8hpp.html#a01d4c8834420566804f361060f144094">PRINT_IF</a>(<a class="code" href="context_8hpp.html#a2a1d2ca63db326792cd81d98cb2f2522">DATA_LISTENER</a>)(<span class="stringliteral">&quot;DLsnr rt_read_version after upgrade:\n&quot;</span>);
<a name="l01106"></a>01106       <a class="code" href="class_i_data.html#a62fa408732cc79c91cc5af22ff52f5bd">rt_read_version</a>.<a class="code" href="struct_data_version.html#a03b5b85b2c309989eb96c2248b0dedfa">dump</a>();
<a name="l01107"></a>01107       lsnr-&gt;<a class="code" href="class_i_listener.html#a54c8d2e23951e95dbb6eae79b6c9d975">setDataSent</a>(<span class="keyword">true</span>);
<a name="l01108"></a>01108       <span class="comment">//it=listeners.erase(it);</span>
<a name="l01109"></a>01109       <span class="keywordflow">return</span>;
<a name="l01110"></a>01110     }      
<a name="l01111"></a>01111   }    
<a name="l01112"></a>01112 }
<a name="l01113"></a>01113 <span class="comment">/*--------------------------------------------------------------------------*/</span>
<a name="l01114"></a><a class="code" href="class_i_data.html#a305f24b50e8e46c4cc3722954e2be4c6">01114</a> <span class="keywordtype">void</span> <a class="code" href="class_i_data.html#a305f24b50e8e46c4cc3722954e2be4c6">IData::addTask</a>(<a class="code" href="class_i_ductteip_task.html">IDuctteipTask</a> *task){
<a name="l01115"></a>01115   <span class="comment">//  printf(&quot;@@task:%s: added to Data:%s\n&quot;,task-&gt;getName().c_str(),getName().c_str());</span>
<a name="l01116"></a>01116   <a class="code" href="class_i_data.html#a319a3f8f7280bab52ddea7843f5398f1">tasks_list</a>.push_back(task);
<a name="l01117"></a>01117 }
<a name="l01118"></a>01118 <span class="comment">/*--------------------------------------------------------------------------*/</span>
<a name="l01119"></a><a class="code" href="class_i_data.html#aee488e868fa96b016a0f546fc485f6d7">01119</a> <span class="keywordtype">void</span> <a class="code" href="class_i_data.html#aee488e868fa96b016a0f546fc485f6d7">IData::listenerAdded</a>(<a class="code" href="class_i_listener.html">DataListener</a> *exlsnr,<span class="keywordtype">int</span> host , <a class="code" href="struct_data_version.html">DataVersion</a> <a class="code" href="context_8hpp.html#aad880fc4455c253781e8968f2239d56f">version</a> ) {
<a name="l01120"></a>01120   list&lt;DataListener *&gt;::iterator it;
<a name="l01121"></a>01121   version.<a class="code" href="struct_data_version.html#a03b5b85b2c309989eb96c2248b0dedfa">dump</a>();
<a name="l01122"></a>01122   <span class="keywordflow">for</span> (it = <a class="code" href="class_i_data.html#aa7d44f5d83938ee056221867600fd7db">listeners</a>.begin();it != <a class="code" href="class_i_data.html#aa7d44f5d83938ee056221867600fd7db">listeners</a>.end();it ++){
<a name="l01123"></a>01123     <a class="code" href="class_i_listener.html">DataListener</a> *mylsnr = (*it);
<a name="l01124"></a>01124     <span class="keywordflow">if</span> (mylsnr-&gt;<a class="code" href="class_i_listener.html#a92be46f2fb958f6b52564e837d5fca98">getHost</a>() == host &amp;&amp; mylsnr-&gt;<a class="code" href="class_i_listener.html#aee2a0174f44139725e4e19fdc3c4d94e">getRequiredVersion</a>() == version){
<a name="l01125"></a>01125       mylsnr-&gt;<a class="code" href="class_i_listener.html#a9def0a8ed3ed91e1956b7b9ce1473b2e">setCount</a>(mylsnr-&gt;<a class="code" href="class_i_listener.html#a3ccdeeabec88b3f0532aa2ced78797e8">getCount</a>()+1);
<a name="l01126"></a>01126       <span class="keywordflow">return</span>;
<a name="l01127"></a>01127     }
<a name="l01128"></a>01128   }
<a name="l01129"></a>01129   <span class="comment">/*</span>
<a name="l01130"></a>01130 <span class="comment">    DataListener *lsnr = new DataListener;</span>
<a name="l01131"></a>01131 <span class="comment">    TRACE_LOCATION;</span>
<a name="l01132"></a>01132 <span class="comment">    DataAccess *dreq = new DataAccess;</span>
<a name="l01133"></a>01133 <span class="comment">    dreq-&gt;data = this;</span>
<a name="l01134"></a>01134 <span class="comment">    dreq-&gt;required_version = version;</span>
<a name="l01135"></a>01135 <span class="comment">    dreq-&gt;type = IData::READ;</span>
<a name="l01136"></a>01136 <span class="comment">    lsnr-&gt;setHost(host) ;</span>
<a name="l01137"></a>01137 <span class="comment">    lsnr-&gt;setDataRequest(dreq) ;</span>
<a name="l01138"></a>01138 <span class="comment">    TRACE_LOCATION;</span>
<a name="l01139"></a>01139 <span class="comment">    lsnr-&gt;setDataSent ( false);</span>
<a name="l01140"></a>01140 <span class="comment">    lsnr-&gt;setReceived(true);</span>
<a name="l01141"></a>01141 <span class="comment">  */</span>
<a name="l01142"></a>01142   exlsnr-&gt;<a class="code" href="class_i_listener.html#a9def0a8ed3ed91e1956b7b9ce1473b2e">setCount</a>(1);
<a name="l01143"></a>01143   <a class="code" href="class_i_data.html#aa7d44f5d83938ee056221867600fd7db">listeners</a>.push_back(exlsnr);
<a name="l01144"></a>01144 }
<a name="l01145"></a>01145 <span class="comment">/*--------------------------------------------------------------------------*/</span>
<a name="l01146"></a><a class="code" href="class_i_data.html#a1abf008f5376563bffe458d81033efde">01146</a> <span class="keywordtype">void</span> <a class="code" href="class_i_data.html#a1abf008f5376563bffe458d81033efde">IData::deleteListenersForOldVersions</a>(){
<a name="l01147"></a>01147   list&lt;DataListener *&gt;::iterator it;
<a name="l01148"></a>01148   it = <a class="code" href="class_i_data.html#aa7d44f5d83938ee056221867600fd7db">listeners</a>.begin();
<a name="l01149"></a>01149   <span class="keywordflow">for</span> (;it != <a class="code" href="class_i_data.html#aa7d44f5d83938ee056221867600fd7db">listeners</a>.end();){
<a name="l01150"></a>01150     <a class="code" href="class_i_listener.html">DataListener</a> *lsnr = (*it);
<a name="l01151"></a>01151     <span class="keywordflow">if</span> (lsnr-&gt;<a class="code" href="class_i_listener.html#aee2a0174f44139725e4e19fdc3c4d94e">getRequiredVersion</a>() &lt; <a class="code" href="class_i_data.html#a633fad3f15a6898694a85dd74c94d89a">rt_write_version</a> ){
<a name="l01152"></a>01152       <a class="code" href="basic_8hpp.html#a01d4c8834420566804f361060f144094">PRINT_IF</a>(<a class="code" href="context_8hpp.html#a2a1d2ca63db326792cd81d98cb2f2522">DATA_LISTENER</a>)(<span class="stringliteral">&quot;Data:%s,listeners deleted before:\n&quot;</span>,<a class="code" href="class_i_data.html#a66ed7cf77dc3382dfd6fcd81dc18e8df">name</a>.c_str());
<a name="l01153"></a>01153       <a class="code" href="class_i_data.html#a633fad3f15a6898694a85dd74c94d89a">rt_write_version</a>.<a class="code" href="struct_data_version.html#a03b5b85b2c309989eb96c2248b0dedfa">dump</a>();
<a name="l01154"></a>01154       <span class="comment">//it=listeners.erase(it);</span>
<a name="l01155"></a>01155     }
<a name="l01156"></a>01156     <span class="keywordflow">else</span> it ++;
<a name="l01157"></a>01157   }
<a name="l01158"></a>01158 }
<a name="l01159"></a>01159 <span class="comment">/*--------------------------------------------------------------------------*/</span>
<a name="l01160"></a><a class="code" href="class_i_data.html#a24f0723eb905accf62461f50a4487b33">01160</a> <span class="keywordtype">void</span> <a class="code" href="class_i_data.html#a24f0723eb905accf62461f50a4487b33">IData::checkAfterUpgrade</a>(list&lt;IDuctteipTask*&gt; &amp;running_tasks,<a class="code" href="class_mail_box.html">MailBox</a> *mailbox,<span class="keywordtype">char</span> debug){
<a name="l01161"></a>01161   list&lt;IListener *&gt;::iterator lsnr_it;
<a name="l01162"></a>01162   list&lt;IDuctteipTask *&gt;::iterator task_it;
<a name="l01163"></a>01163 
<a name="l01164"></a>01164   <span class="keywordflow">if</span>(0)printf(<span class="stringliteral">&quot;data:check after data upgrade lsnr:%ld tasks :%ld\n&quot;</span>,<a class="code" href="class_i_data.html#aa7d44f5d83938ee056221867600fd7db">listeners</a>.size(),<a class="code" href="class_i_data.html#a319a3f8f7280bab52ddea7843f5398f1">tasks_list</a>.size());
<a name="l01165"></a>01165   <span class="keywordflow">if</span> (<a class="code" href="class_i_data.html#aa7d44f5d83938ee056221867600fd7db">listeners</a>.size() &gt;0) {
<a name="l01166"></a>01166     <a class="code" href="dt__log_8hpp.html#a2281e9cbd72942f0be829c845609e1c6">dt_log</a>.<a class="code" href="class_ductteip_log.html#a6d0afadbba975c706ef756a3ba23fe47">addEventStart</a>(<span class="keyword">this</span>,<a class="code" href="class_ductteip_log.html#a2d4f772da028bd358802f7cbe58c981baffaf01d4b3a67747966e9e8315f2b5b4">DuctteipLog::CheckedForListener</a>);
<a name="l01167"></a>01167     <span class="keywordflow">for</span>(lsnr_it = <a class="code" href="class_i_data.html#aa7d44f5d83938ee056221867600fd7db">listeners</a>.begin() ; 
<a name="l01168"></a>01168     lsnr_it != <a class="code" href="class_i_data.html#aa7d44f5d83938ee056221867600fd7db">listeners</a>.end()  ; 
<a name="l01169"></a>01169     ++lsnr_it){
<a name="l01170"></a>01170       <a class="code" href="class_i_listener.html">IListener</a> *listener = (*lsnr_it);
<a name="l01171"></a>01171       listener-&gt;<a class="code" href="class_i_listener.html#a092fa85ce870bd169930cffce12bc87b">checkAndSendData</a>(mailbox);
<a name="l01172"></a>01172     }
<a name="l01173"></a>01173     <a class="code" href="dt__log_8hpp.html#a2281e9cbd72942f0be829c845609e1c6">dt_log</a>.<a class="code" href="class_ductteip_log.html#a9a010d4387f7f74b848d5c36aaacd501">addEventEnd</a>(<span class="keyword">this</span>,<a class="code" href="class_ductteip_log.html#a2d4f772da028bd358802f7cbe58c981baffaf01d4b3a67747966e9e8315f2b5b4">DuctteipLog::CheckedForListener</a>);
<a name="l01174"></a>01174   }
<a name="l01175"></a>01175   <span class="keywordflow">if</span> (<a class="code" href="class_i_data.html#a319a3f8f7280bab52ddea7843f5398f1">tasks_list</a>.size() &gt;0) {
<a name="l01176"></a>01176     <a class="code" href="dt__log_8hpp.html#a2281e9cbd72942f0be829c845609e1c6">dt_log</a>.<a class="code" href="class_ductteip_log.html#a6d0afadbba975c706ef756a3ba23fe47">addEventStart</a>(<span class="keyword">this</span>,<a class="code" href="class_ductteip_log.html#a2d4f772da028bd358802f7cbe58c981ba4abed904914b7d1b355c56cb6191ab65">DuctteipLog::CheckedForTask</a>);
<a name="l01177"></a>01177     <span class="keywordflow">for</span>(task_it = <a class="code" href="class_i_data.html#a319a3f8f7280bab52ddea7843f5398f1">tasks_list</a>.begin() ; 
<a name="l01178"></a>01178     task_it != <a class="code" href="class_i_data.html#a319a3f8f7280bab52ddea7843f5398f1">tasks_list</a>.end()  ;
<a name="l01179"></a>01179     ++task_it){
<a name="l01180"></a>01180       <a class="code" href="class_i_ductteip_task.html">IDuctteipTask</a> *task = (*task_it);
<a name="l01181"></a>01181       <a class="code" href="dt__log_8hpp.html#a2281e9cbd72942f0be829c845609e1c6">dt_log</a>.<a class="code" href="class_ductteip_log.html#a6d0afadbba975c706ef756a3ba23fe47">addEventStart</a>(task,<a class="code" href="class_ductteip_log.html#a2d4f772da028bd358802f7cbe58c981bafaac86b29a73ad0c4da64a310968a1ae">DuctteipLog::CheckedForRun</a>);
<a name="l01182"></a>01182       <span class="comment">/*      if ( task-&gt;isExported() ) {</span>
<a name="l01183"></a>01183 <span class="comment">    task-&gt;setState(IDuctteipTask::CanBeCleared);</span>
<a name="l01184"></a>01184 <span class="comment">    continue;</span>
<a name="l01185"></a>01185 <span class="comment">    }*/</span>
<a name="l01186"></a>01186       <span class="keywordflow">if</span> ( !task-&gt;<a class="code" href="class_i_ductteip_task.html#ab92791950ee2fe51cf1005421cb87695">isFinished</a>())
<a name="l01187"></a>01187     <span class="keywordflow">if</span>(1)printf(<span class="stringliteral">&quot;data %s -&gt; task:%s,stat=%d.\n&quot;</span>,<a class="code" href="class_i_data.html#a87b7baa5c42fd4c2b36875141030880d">getName</a>().c_str(),task-&gt;<a class="code" href="class_i_ductteip_task.html#aff428fcafc7ce7f6aa9f281febead30a">getName</a>().c_str(),task-&gt;<a class="code" href="class_i_ductteip_task.html#a7422e06ba861c73d6e00907a4f905aef">getState</a>());
<a name="l01188"></a>01188     <span class="keywordflow">if</span> (task-&gt;<a class="code" href="class_i_ductteip_task.html#ad30ebd78861e6d0e7647a79393ccbcab">canRun</a>(debug)) {
<a name="l01189"></a>01189       <a class="code" href="dt__log_8hpp.html#a2281e9cbd72942f0be829c845609e1c6">dt_log</a>.<a class="code" href="class_ductteip_log.html#a9a010d4387f7f74b848d5c36aaacd501">addEventEnd</a>(task,<a class="code" href="class_ductteip_log.html#a2d4f772da028bd358802f7cbe58c981bafaac86b29a73ad0c4da64a310968a1ae">DuctteipLog::CheckedForRun</a>);
<a name="l01190"></a>01190       <a class="code" href="dt__log_8hpp.html#a2281e9cbd72942f0be829c845609e1c6">dt_log</a>.<a class="code" href="class_ductteip_log.html#a6d0afadbba975c706ef756a3ba23fe47">addEventStart</a>(task,<a class="code" href="class_ductteip_log.html#a2d4f772da028bd358802f7cbe58c981ba3aa8d6f8b5d35e4f4871958a72908a68">DuctteipLog::Executed</a>);
<a name="l01191"></a>01191       running_tasks.push_back(task);
<a name="l01192"></a>01192       <span class="keywordflow">if</span>(1)printf(<span class="stringliteral">&quot;RUNNING Tasks#:%ld\n&quot;</span>,running_tasks.size());
<a name="l01193"></a>01193       <span class="keywordflow">if</span>(1)printf(<span class="stringliteral">&quot;task:%s inserted in running q.\n&quot;</span>,task-&gt;<a class="code" href="class_i_ductteip_task.html#aff428fcafc7ce7f6aa9f281febead30a">getName</a>().c_str());
<a name="l01194"></a>01194     }
<a name="l01195"></a>01195     <span class="keywordflow">else</span>
<a name="l01196"></a>01196       <a class="code" href="dt__log_8hpp.html#a2281e9cbd72942f0be829c845609e1c6">dt_log</a>.<a class="code" href="class_ductteip_log.html#a9a010d4387f7f74b848d5c36aaacd501">addEventEnd</a>(task,<a class="code" href="class_ductteip_log.html#a2d4f772da028bd358802f7cbe58c981bafaac86b29a73ad0c4da64a310968a1ae">DuctteipLog::CheckedForRun</a>);
<a name="l01197"></a>01197     }
<a name="l01198"></a>01198     <a class="code" href="dt__log_8hpp.html#a2281e9cbd72942f0be829c845609e1c6">dt_log</a>.<a class="code" href="class_ductteip_log.html#a9a010d4387f7f74b848d5c36aaacd501">addEventEnd</a>(<span class="keyword">this</span>,<a class="code" href="class_ductteip_log.html#a2d4f772da028bd358802f7cbe58c981ba4abed904914b7d1b355c56cb6191ab65">DuctteipLog::CheckedForTask</a>);
<a name="l01199"></a>01199   }
<a name="l01200"></a>01200   dtEngine.<a class="code" href="classengine.html#ad5b326de03b791ffb0846bbcc18d4252">runFirstActiveTask</a>();
<a name="l01201"></a>01201   
<a name="l01202"></a>01202 }
<a name="l01203"></a>01203 
<a name="l01204"></a>01204 
<a name="l01205"></a>01205 <span class="preprocessor">#endif //  __CONTEXT_HPP__</span>
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 11 Dec 2014 for DuctTeip by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
